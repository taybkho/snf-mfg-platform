[0m11:10:23.256885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013884828D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138841F1D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138841F38F0>]}


============================== 11:10:23.272758 | 90342241-af99-46da-ba58-9feffccb2039 ==============================
[0m11:10:23.272758 [info ] [MainThread]: Running with dbt=1.10.15
[0m11:10:23.272758 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\sanofi-accelerator-mfg-data-platform\\dbt_project\\logs'}
[0m11:10:23.472905 [info ] [MainThread]: dbt version: 1.10.15
[0m11:10:23.472905 [info ] [MainThread]: python version: 3.12.0
[0m11:10:23.472905 [info ] [MainThread]: python path: C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\.venv\Scripts\python.exe
[0m11:10:23.472905 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m11:10:24.229660 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:10:24.229660 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:10:24.229660 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:10:24.291759 [info ] [MainThread]: Using profiles dir at C:\Users\User\.dbt
[0m11:10:24.291759 [info ] [MainThread]: Using profiles.yml file at C:\Users\User\.dbt\profiles.yml
[0m11:10:24.291759 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\dbt_project.yml
[0m11:10:24.291759 [info ] [MainThread]: adapter type: snowflake
[0m11:10:24.291759 [info ] [MainThread]: adapter version: 1.10.4
[0m11:10:24.407834 [info ] [MainThread]: Configuration:
[0m11:10:24.407834 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:10:24.423650 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:10:24.423650 [info ] [MainThread]: Required dependencies:
[0m11:10:24.423650 [debug] [MainThread]: Executing "git --help"
[0m11:10:24.512357 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify tags\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:10:24.513360 [debug] [MainThread]: STDERR: "b''"
[0m11:10:24.513360 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:10:24.514339 [info ] [MainThread]: Connection:
[0m11:10:24.515382 [info ] [MainThread]:   account: DTWDUSN-WRB63753
[0m11:10:24.515382 [info ] [MainThread]:   user: TAIBKHO44
[0m11:10:24.516406 [info ] [MainThread]:   database: MFG_ACCELERATOR
[0m11:10:24.517390 [info ] [MainThread]:   warehouse: WH_MFG_ACCELERATOR
[0m11:10:24.517390 [info ] [MainThread]:   role: SYSADMIN
[0m11:10:24.518419 [info ] [MainThread]:   schema: ANALYTICS
[0m11:10:24.519391 [info ] [MainThread]:   authenticator: None
[0m11:10:24.520391 [info ] [MainThread]:   oauth_client_id: None
[0m11:10:24.520391 [info ] [MainThread]:   query_tag: None
[0m11:10:24.521436 [info ] [MainThread]:   client_session_keep_alive: False
[0m11:10:24.521436 [info ] [MainThread]:   host: None
[0m11:10:24.522419 [info ] [MainThread]:   port: None
[0m11:10:24.523394 [info ] [MainThread]:   proxy_host: None
[0m11:10:24.524433 [info ] [MainThread]:   proxy_port: None
[0m11:10:24.525409 [info ] [MainThread]:   protocol: None
[0m11:10:24.525409 [info ] [MainThread]:   connect_retries: 1
[0m11:10:24.526390 [info ] [MainThread]:   connect_timeout: None
[0m11:10:24.527387 [info ] [MainThread]:   retry_on_database_errors: False
[0m11:10:24.527387 [info ] [MainThread]:   retry_all: False
[0m11:10:24.528390 [info ] [MainThread]:   insecure_mode: False
[0m11:10:24.529390 [info ] [MainThread]:   reuse_connections: True
[0m11:10:24.530527 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m11:10:24.531561 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m11:10:24.533538 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m11:10:24.958647 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m11:10:25.088058 [debug] [MainThread]: Using snowflake connection "debug"
[0m11:10:25.088058 [debug] [MainThread]: On debug: select 1 as id
[0m11:10:25.088058 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:10:26.822254 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.730 seconds
[0m11:10:26.825762 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:10:26.825762 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:10:26.825762 [debug] [MainThread]: Command `dbt debug` succeeded at 11:10:26.825762 after 3.78 seconds
[0m11:10:26.825762 [debug] [MainThread]: Connection 'debug' was left open.
[0m11:10:26.825762 [debug] [MainThread]: On debug: Close
[0m11:10:27.339008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138841F1D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138995DB620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013899B721B0>]}
[0m11:10:27.345531 [debug] [MainThread]: Flushing usage events
[0m11:10:28.246208 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:29:51.277440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A7152EA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6F38A420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6EA8ECC0>]}


============================== 11:29:51.293150 | bb91e45e-0de5-4ac4-b1ce-2c55fc041aa8 ==============================
[0m11:29:51.293150 [info ] [MainThread]: Running with dbt=1.10.15
[0m11:29:51.293150 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select staging', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\sanofi-accelerator-mfg-data-platform\\dbt_project\\logs'}
[0m11:29:52.063295 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:29:52.063295 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:29:52.063295 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:29:52.294735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb91e45e-0de5-4ac4-b1ce-2c55fc041aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6F48B590>]}
[0m11:29:52.490782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb91e45e-0de5-4ac4-b1ce-2c55fc041aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6F6631A0>]}
[0m11:29:52.490782 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m11:29:53.003869 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m11:29:53.003869 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:29:53.003869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bb91e45e-0de5-4ac4-b1ce-2c55fc041aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A06CB9D90>]}
[0m11:29:54.432900 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m11:29:54.432900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bb91e45e-0de5-4ac4-b1ce-2c55fc041aa8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A07401FD0>]}
[0m11:29:54.584651 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mfg_accelerator.marts
- models.mfg_accelerator.core
[0m11:29:54.603173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb91e45e-0de5-4ac4-b1ce-2c55fc041aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A072BC710>]}
[0m11:29:54.688481 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m11:29:54.688481 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m11:29:54.759248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb91e45e-0de5-4ac4-b1ce-2c55fc041aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A07216630>]}
[0m11:29:54.759248 [info ] [MainThread]: Found 3 models, 10 data tests, 3 sources, 504 macros
[0m11:29:54.759248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb91e45e-0de5-4ac4-b1ce-2c55fc041aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A0717BC20>]}
[0m11:29:54.759248 [info ] [MainThread]: 
[0m11:29:54.759248 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:29:54.759248 [info ] [MainThread]: 
[0m11:29:54.759248 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:29:54.769620 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m11:29:54.866709 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m11:29:54.866709 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m11:29:54.867705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:29:56.511592 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.645 seconds
[0m11:29:56.512598 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR, now create_MFG_ACCELERATOR_ANALYTICS_analytics)
[0m11:29:56.512598 [debug] [ThreadPool]: Creating schema "database: "MFG_ACCELERATOR"
schema: "ANALYTICS_analytics"
"
[0m11:29:56.512598 [debug] [ThreadPool]: Using snowflake connection "create_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m11:29:56.512598 [debug] [ThreadPool]: On create_MFG_ACCELERATOR_ANALYTICS_analytics: create schema if not exists MFG_ACCELERATOR.ANALYTICS_analytics
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "create_MFG_ACCELERATOR_ANALYTICS_analytics"} */
[0m11:29:56.849692 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.332 seconds
[0m11:29:56.849692 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m11:29:56.865370 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m11:29:56.865370 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m11:29:56.865370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:29:57.920774 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.056 seconds
[0m11:29:57.920774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb91e45e-0de5-4ac4-b1ce-2c55fc041aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A074FECC0>]}
[0m11:29:57.950181 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.stg_batches
[0m11:29:57.950181 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.stg_materials
[0m11:29:57.950181 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.stg_production_orders
[0m11:29:57.950181 [info ] [Thread-1 (]: 1 of 3 START sql view model ANALYTICS_analytics.stg_batches .................... [RUN]
[0m11:29:57.950181 [info ] [Thread-2 (]: 2 of 3 START sql view model ANALYTICS_analytics.stg_materials .................. [RUN]
[0m11:29:57.950181 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_batches'
[0m11:29:57.950181 [info ] [Thread-3 (]: 3 of 3 START sql view model ANALYTICS_analytics.stg_production_orders .......... [RUN]
[0m11:29:57.950181 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_materials'
[0m11:29:57.950181 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.stg_batches
[0m11:29:57.950181 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_production_orders'
[0m11:29:57.950181 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.stg_materials
[0m11:29:57.966029 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.stg_batches"
[0m11:29:57.967386 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.stg_production_orders
[0m11:29:57.972276 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.stg_materials"
[0m11:29:57.978871 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.stg_production_orders"
[0m11:29:57.978871 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.stg_batches
[0m11:29:58.007148 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.stg_materials
[0m11:29:58.020118 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.stg_batches"
[0m11:29:58.021111 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.stg_production_orders
[0m11:29:58.024696 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.stg_materials"
[0m11:29:58.027658 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.stg_production_orders"
[0m11:29:58.035843 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.stg_production_orders"
[0m11:29:58.036845 [debug] [Thread-3 (]: On model.mfg_accelerator.stg_production_orders: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
  
  
  
  
  as (
    -- stg_production_orders.sql
-- Purpose:
--  - Clean and standardize production order data
--  - Ensure date fields and statuses are typed and named consistently

with source as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.RAW.production_orders

),

renamed as (

    select
        order_id                               as order_id,
        batch_id                               as batch_id,
        order_type                             as order_type,
        cast(planned_start_date as date)       as planned_start_date,
        cast(planned_end_date as date)         as planned_end_date,
        cast(actual_start_date as date)        as actual_start_date,
        cast(actual_end_date as date)          as actual_end_date,
        order_status                           as order_status,
        line_id                                as line_id
    from source

)

select * from renamed
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_production_orders"} */;
[0m11:29:58.037844 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:29:58.039037 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.stg_materials"
[0m11:29:58.042090 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.stg_batches"
[0m11:29:58.045086 [debug] [Thread-2 (]: On model.mfg_accelerator.stg_materials: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
  
  
  
  
  as (
    -- stg_materials.sql
-- Purpose:
--  - Create a clean, standardized view of materials
--  - Apply basic typing and naming conventions
--  - This is the first "T" step after RAW

with source as (

    -- Pull data from the RAW.MATERIALS table registered as a source
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        status,
        created_at
    from MFG_ACCELERATOR.RAW.materials

),

renamed as (

    -- Apply any renaming / typing here
    select
        material_id                as material_id,        -- keep same, but explicitly select
        material_name              as material_name,
        material_type              as material_type,
        unit_of_measure            as unit_of_measure,
        status                     as material_status,    -- rename to avoid generic 'status'
        cast(created_at as date)   as created_at
    from source

)

select * from renamed
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_materials"} */;
[0m11:29:58.046124 [debug] [Thread-1 (]: On model.mfg_accelerator.stg_batches: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
  
  
  
  
  as (
    -- stg_batches.sql
-- Purpose:
--  - Clean and standardize batch data
--  - Ensure dates and numeric types are correct

with source as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.RAW.batches

),

renamed as (

    select
        batch_id                         as batch_id,
        material_id                      as material_id,
        manufacturing_site               as manufacturing_site,
        cast(manufacture_date as date)   as manufacture_date,
        cast(expiry_date as date)        as expiry_date,
        cast(quantity as number)         as quantity,
        batch_status                     as batch_status
    from source

)

select * from renamed
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_batches"} */;
[0m11:29:58.052085 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:29:58.056088 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:29:59.227084 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c0f475-0107-3c83-0013-40ff001071ae
[0m11:29:59.227084 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 41 at position 151 unexpected ';'.
[0m11:29:59.231172 [debug] [Thread-1 (]: Database Error in model stg_batches (models\staging\stg_batches.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 151 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_batches.sql
[0m11:29:59.247162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb91e45e-0de5-4ac4-b1ce-2c55fc041aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A0752ECF0>]}
[0m11:29:59.247162 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model ANALYTICS_analytics.stg_batches ........... [[31mERROR[0m in 1.28s]
[0m11:29:59.247162 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.stg_batches
[0m11:29:59.247162 [debug] [Thread-7 (]: Marking all children of 'model.mfg_accelerator.stg_batches' to be skipped because of status 'error'.  Reason: Database Error in model stg_batches (models\staging\stg_batches.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 151 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_batches.sql.
[0m11:29:59.340254 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c0f475-0107-3fac-0013-40ff0010a19a
[0m11:29:59.340254 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 45 at position 161 unexpected ';'.
[0m11:29:59.356179 [debug] [Thread-3 (]: Database Error in model stg_production_orders (models\staging\stg_production_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 45 at position 161 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_production_orders.sql
[0m11:29:59.356179 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb91e45e-0de5-4ac4-b1ce-2c55fc041aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A07B0E3C0>]}
[0m11:29:59.356179 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model ANALYTICS_analytics.stg_production_orders . [[31mERROR[0m in 1.41s]
[0m11:29:59.356179 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.stg_production_orders
[0m11:29:59.356179 [debug] [Thread-7 (]: Marking all children of 'model.mfg_accelerator.stg_production_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_production_orders (models\staging\stg_production_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 45 at position 161 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_production_orders.sql.
[0m11:29:59.474747 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c0f475-0107-3fac-0013-40ff0010a19e
[0m11:29:59.474747 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 42 at position 153 unexpected ';'.
[0m11:29:59.474747 [debug] [Thread-2 (]: Database Error in model stg_materials (models\staging\stg_materials.sql)
  001003 (42000): SQL compilation error:
  syntax error line 42 at position 153 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_materials.sql
[0m11:29:59.474747 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb91e45e-0de5-4ac4-b1ce-2c55fc041aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A07B0E480>]}
[0m11:29:59.474747 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model ANALYTICS_analytics.stg_materials ......... [[31mERROR[0m in 1.52s]
[0m11:29:59.474747 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.stg_materials
[0m11:29:59.474747 [debug] [Thread-7 (]: Marking all children of 'model.mfg_accelerator.stg_materials' to be skipped because of status 'error'.  Reason: Database Error in model stg_materials (models\staging\stg_materials.sql)
  001003 (42000): SQL compilation error:
  syntax error line 42 at position 153 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_materials.sql.
[0m11:29:59.474747 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:29:59.474747 [debug] [MainThread]: Connection 'create_MFG_ACCELERATOR_ANALYTICS_analytics' was left open.
[0m11:29:59.474747 [debug] [MainThread]: On create_MFG_ACCELERATOR_ANALYTICS_analytics: Close
[0m11:29:59.920735 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics' was left open.
[0m11:29:59.920735 [debug] [MainThread]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: Close
[0m11:30:00.354747 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_batches' was left open.
[0m11:30:00.354747 [debug] [MainThread]: On model.mfg_accelerator.stg_batches: Close
[0m11:30:00.810189 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_materials' was left open.
[0m11:30:00.810189 [debug] [MainThread]: On model.mfg_accelerator.stg_materials: Close
[0m11:30:01.331487 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_production_orders' was left open.
[0m11:30:01.331487 [debug] [MainThread]: On model.mfg_accelerator.stg_production_orders: Close
[0m11:30:01.786487 [info ] [MainThread]: 
[0m11:30:01.786487 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 7.03 seconds (7.03s).
[0m11:30:01.786487 [debug] [MainThread]: Command end result
[0m11:30:01.823020 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m11:30:01.826578 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m11:30:01.830720 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\run_results.json
[0m11:30:01.830720 [info ] [MainThread]: 
[0m11:30:01.830720 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m11:30:01.830720 [info ] [MainThread]: 
[0m11:30:01.839530 [error] [MainThread]: [31mFailure in model stg_batches (models\staging\stg_batches.sql)[0m
[0m11:30:01.840153 [error] [MainThread]:   Database Error in model stg_batches (models\staging\stg_batches.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 151 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_batches.sql
[0m11:30:01.840153 [info ] [MainThread]: 
[0m11:30:01.840153 [info ] [MainThread]:   compiled code at target\compiled\mfg_accelerator\models\staging\stg_batches.sql
[0m11:30:01.843270 [info ] [MainThread]: 
[0m11:30:01.843270 [error] [MainThread]: [31mFailure in model stg_production_orders (models\staging\stg_production_orders.sql)[0m
[0m11:30:01.844317 [error] [MainThread]:   Database Error in model stg_production_orders (models\staging\stg_production_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 45 at position 161 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_production_orders.sql
[0m11:30:01.845420 [info ] [MainThread]: 
[0m11:30:01.845420 [info ] [MainThread]:   compiled code at target\compiled\mfg_accelerator\models\staging\stg_production_orders.sql
[0m11:30:01.846464 [info ] [MainThread]: 
[0m11:30:01.847437 [error] [MainThread]: [31mFailure in model stg_materials (models\staging\stg_materials.sql)[0m
[0m11:30:01.848013 [error] [MainThread]:   Database Error in model stg_materials (models\staging\stg_materials.sql)
  001003 (42000): SQL compilation error:
  syntax error line 42 at position 153 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_materials.sql
[0m11:30:01.848013 [info ] [MainThread]: 
[0m11:30:01.848013 [info ] [MainThread]:   compiled code at target\compiled\mfg_accelerator\models\staging\stg_materials.sql
[0m11:30:01.848013 [info ] [MainThread]: 
[0m11:30:01.848013 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=3
[0m11:30:01.848013 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:30:01.853011 [debug] [MainThread]: Command `dbt run` failed at 11:30:01.853011 after 10.79 seconds
[0m11:30:01.854044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A7279E660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A71B69EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A71B687A0>]}
[0m11:30:01.854044 [debug] [MainThread]: Flushing usage events
[0m11:30:02.897350 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:32:40.839027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1137B4E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B110E5A390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B113656B70>]}


============================== 11:32:40.849111 | 87632583-3944-4c46-b3ad-dddd93b2faf8 ==============================
[0m11:32:40.849111 [info ] [MainThread]: Running with dbt=1.10.15
[0m11:32:40.849111 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select staging', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\sanofi-accelerator-mfg-data-platform\\dbt_project\\logs'}
[0m11:32:41.579040 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:32:41.579040 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:32:41.579040 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:32:41.789392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87632583-3944-4c46-b3ad-dddd93b2faf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B110F5B3B0>]}
[0m11:32:41.859302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87632583-3944-4c46-b3ad-dddd93b2faf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1287A9760>]}
[0m11:32:41.859302 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m11:32:42.299115 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m11:32:42.403969 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:32:42.408984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '87632583-3944-4c46-b3ad-dddd93b2faf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B113A884A0>]}
[0m11:32:43.879450 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m11:32:43.879450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '87632583-3944-4c46-b3ad-dddd93b2faf8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B128CC48C0>]}
[0m11:32:44.054383 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mfg_accelerator.marts
- models.mfg_accelerator.core
[0m11:32:44.067056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87632583-3944-4c46-b3ad-dddd93b2faf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B128C6DE50>]}
[0m11:32:44.158886 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m11:32:44.158886 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m11:32:44.179214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87632583-3944-4c46-b3ad-dddd93b2faf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B128F66690>]}
[0m11:32:44.179214 [info ] [MainThread]: Found 3 models, 10 data tests, 3 sources, 504 macros
[0m11:32:44.179214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87632583-3944-4c46-b3ad-dddd93b2faf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B128CEA7E0>]}
[0m11:32:44.184888 [info ] [MainThread]: 
[0m11:32:44.184888 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:32:44.184888 [info ] [MainThread]: 
[0m11:32:44.184888 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:32:44.188909 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m11:32:44.295348 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m11:32:44.296349 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m11:32:44.296349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:32:45.749443 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.455 seconds
[0m11:32:45.749443 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m11:32:45.765150 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m11:32:45.765150 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m11:32:45.765150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:32:46.929883 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.169 seconds
[0m11:32:46.929883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87632583-3944-4c46-b3ad-dddd93b2faf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1110325A0>]}
[0m11:32:46.941814 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.stg_batches
[0m11:32:46.944507 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.stg_materials
[0m11:32:46.944507 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.stg_production_orders
[0m11:32:46.944507 [info ] [Thread-1 (]: 1 of 3 START sql view model ANALYTICS_analytics.stg_batches .................... [RUN]
[0m11:32:46.944507 [info ] [Thread-2 (]: 2 of 3 START sql view model ANALYTICS_analytics.stg_materials .................. [RUN]
[0m11:32:46.944507 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_batches'
[0m11:32:46.944507 [info ] [Thread-3 (]: 3 of 3 START sql view model ANALYTICS_analytics.stg_production_orders .......... [RUN]
[0m11:32:46.949108 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_materials'
[0m11:32:46.949108 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.stg_batches
[0m11:32:46.949108 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_production_orders'
[0m11:32:46.949108 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.stg_materials
[0m11:32:46.949108 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.stg_batches"
[0m11:32:46.959461 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.stg_production_orders
[0m11:32:46.964356 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.stg_materials"
[0m11:32:46.969411 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.stg_production_orders"
[0m11:32:46.969411 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.stg_batches
[0m11:32:46.976130 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.stg_materials
[0m11:32:47.007046 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.stg_production_orders
[0m11:32:47.015418 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.stg_batches"
[0m11:32:47.019388 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.stg_materials"
[0m11:32:47.024340 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.stg_production_orders"
[0m11:32:47.027428 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.stg_batches"
[0m11:32:47.028400 [debug] [Thread-1 (]: On model.mfg_accelerator.stg_batches: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
  
  
  
  
  as (
    -- stg_batches.sql
-- Purpose:
--  - Clean and standardize batch data
--  - Ensure dates and numeric types are correct

with source as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.RAW.batches

),

renamed as (

    select
        batch_id                         as batch_id,
        material_id                      as material_id,
        manufacturing_site               as manufacturing_site,
        cast(manufacture_date as date)   as manufacture_date,
        cast(expiry_date as date)        as expiry_date,
        cast(quantity as number)         as quantity,
        batch_status                     as batch_status
    from source

)

select * from renamed
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_batches"} */;
[0m11:32:47.029914 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:32:47.030949 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.stg_materials"
[0m11:32:47.032945 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.stg_production_orders"
[0m11:32:47.034954 [debug] [Thread-2 (]: On model.mfg_accelerator.stg_materials: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
  
  
  
  
  as (
    -- stg_materials.sql
-- Purpose:
--  - Create a clean, standardized view of materials
--  - Apply basic typing and naming conventions
--  - This is the first "T" step after RAW

with source as (

    -- Pull data from the RAW.MATERIALS table registered as a source
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        status,
        created_at
    from MFG_ACCELERATOR.RAW.materials

),

renamed as (

    -- Apply any renaming / typing here
    select
        material_id                as material_id,        -- keep same, but explicitly select
        material_name              as material_name,
        material_type              as material_type,
        unit_of_measure            as unit_of_measure,
        status                     as material_status,    -- rename to avoid generic 'status'
        cast(created_at as date)   as created_at
    from source

)

select * from renamed
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_materials"} */;
[0m11:32:47.037949 [debug] [Thread-3 (]: On model.mfg_accelerator.stg_production_orders: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
  
  
  
  
  as (
    -- stg_production_orders.sql
-- Purpose:
--  - Clean and standardize production order data
--  - Ensure date fields and statuses are typed and named consistently

with source as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.RAW.production_orders

),

renamed as (

    select
        order_id                               as order_id,
        batch_id                               as batch_id,
        order_type                             as order_type,
        cast(planned_start_date as date)       as planned_start_date,
        cast(planned_end_date as date)         as planned_end_date,
        cast(actual_start_date as date)        as actual_start_date,
        cast(actual_end_date as date)          as actual_end_date,
        order_status                           as order_status,
        line_id                                as line_id
    from source

)

select * from renamed
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_production_orders"} */;
[0m11:32:47.037949 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:32:47.039456 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:32:48.271544 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c0f478-0107-38de-0013-40ff00109106
[0m11:32:48.271544 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 45 at position 161 unexpected ';'.
[0m11:32:48.273550 [debug] [Thread-3 (]: Database Error in model stg_production_orders (models\staging\stg_production_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 45 at position 161 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_production_orders.sql
[0m11:32:48.275556 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87632583-3944-4c46-b3ad-dddd93b2faf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B129606930>]}
[0m11:32:48.277562 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model ANALYTICS_analytics.stg_production_orders . [[31mERROR[0m in 1.33s]
[0m11:32:48.277562 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.stg_production_orders
[0m11:32:48.279105 [debug] [Thread-7 (]: Marking all children of 'model.mfg_accelerator.stg_production_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_production_orders (models\staging\stg_production_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 45 at position 161 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_production_orders.sql.
[0m11:32:48.721218 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c0f478-0107-3c83-0013-40ff0010720e
[0m11:32:48.721218 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 41 at position 151 unexpected ';'.
[0m11:32:48.729101 [debug] [Thread-1 (]: Database Error in model stg_batches (models\staging\stg_batches.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 151 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_batches.sql
[0m11:32:48.729101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87632583-3944-4c46-b3ad-dddd93b2faf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B12953CCE0>]}
[0m11:32:48.729101 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model ANALYTICS_analytics.stg_batches ........... [[31mERROR[0m in 1.78s]
[0m11:32:48.729101 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.stg_batches
[0m11:32:48.729101 [debug] [Thread-7 (]: Marking all children of 'model.mfg_accelerator.stg_batches' to be skipped because of status 'error'.  Reason: Database Error in model stg_batches (models\staging\stg_batches.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 151 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_batches.sql.
[0m11:32:48.759642 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c0f478-0107-3c83-0013-40ff00107212
[0m11:32:48.759642 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 42 at position 153 unexpected ';'.
[0m11:32:48.769100 [debug] [Thread-2 (]: Database Error in model stg_materials (models\staging\stg_materials.sql)
  001003 (42000): SQL compilation error:
  syntax error line 42 at position 153 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_materials.sql
[0m11:32:48.769100 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87632583-3944-4c46-b3ad-dddd93b2faf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B12953F890>]}
[0m11:32:48.769100 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model ANALYTICS_analytics.stg_materials ......... [[31mERROR[0m in 1.82s]
[0m11:32:48.774286 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.stg_materials
[0m11:32:48.775293 [debug] [Thread-7 (]: Marking all children of 'model.mfg_accelerator.stg_materials' to be skipped because of status 'error'.  Reason: Database Error in model stg_materials (models\staging\stg_materials.sql)
  001003 (42000): SQL compilation error:
  syntax error line 42 at position 153 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_materials.sql.
[0m11:32:48.777146 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:32:48.777146 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR' was left open.
[0m11:32:48.778187 [debug] [MainThread]: On list_MFG_ACCELERATOR: Close
[0m11:32:49.229055 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics' was left open.
[0m11:32:49.229055 [debug] [MainThread]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: Close
[0m11:32:49.672888 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_batches' was left open.
[0m11:32:49.672888 [debug] [MainThread]: On model.mfg_accelerator.stg_batches: Close
[0m11:32:50.145570 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_materials' was left open.
[0m11:32:50.145570 [debug] [MainThread]: On model.mfg_accelerator.stg_materials: Close
[0m11:32:50.613200 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_production_orders' was left open.
[0m11:32:50.613200 [debug] [MainThread]: On model.mfg_accelerator.stg_production_orders: Close
[0m11:32:51.091082 [info ] [MainThread]: 
[0m11:32:51.091082 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 6.91 seconds (6.91s).
[0m11:32:51.091082 [debug] [MainThread]: Command end result
[0m11:32:51.119173 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m11:32:51.119173 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m11:32:51.132035 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\run_results.json
[0m11:32:51.132035 [info ] [MainThread]: 
[0m11:32:51.132035 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m11:32:51.132035 [info ] [MainThread]: 
[0m11:32:51.132035 [error] [MainThread]: [31mFailure in model stg_production_orders (models\staging\stg_production_orders.sql)[0m
[0m11:32:51.132035 [error] [MainThread]:   Database Error in model stg_production_orders (models\staging\stg_production_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 45 at position 161 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_production_orders.sql
[0m11:32:51.132035 [info ] [MainThread]: 
[0m11:32:51.132035 [info ] [MainThread]:   compiled code at target\compiled\mfg_accelerator\models\staging\stg_production_orders.sql
[0m11:32:51.132035 [info ] [MainThread]: 
[0m11:32:51.139797 [error] [MainThread]: [31mFailure in model stg_batches (models\staging\stg_batches.sql)[0m
[0m11:32:51.140823 [error] [MainThread]:   Database Error in model stg_batches (models\staging\stg_batches.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 151 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_batches.sql
[0m11:32:51.141806 [info ] [MainThread]: 
[0m11:32:51.142822 [info ] [MainThread]:   compiled code at target\compiled\mfg_accelerator\models\staging\stg_batches.sql
[0m11:32:51.143805 [info ] [MainThread]: 
[0m11:32:51.143805 [error] [MainThread]: [31mFailure in model stg_materials (models\staging\stg_materials.sql)[0m
[0m11:32:51.144805 [error] [MainThread]:   Database Error in model stg_materials (models\staging\stg_materials.sql)
  001003 (42000): SQL compilation error:
  syntax error line 42 at position 153 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_materials.sql
[0m11:32:51.146295 [info ] [MainThread]: 
[0m11:32:51.146943 [info ] [MainThread]:   compiled code at target\compiled\mfg_accelerator\models\staging\stg_materials.sql
[0m11:32:51.147964 [info ] [MainThread]: 
[0m11:32:51.149142 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=3
[0m11:32:51.150495 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:32:51.151507 [debug] [MainThread]: Command `dbt run` failed at 11:32:51.151507 after 10.53 seconds
[0m11:32:51.151507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1141B1DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B113656B70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B11338C110>]}
[0m11:32:51.151507 [debug] [MainThread]: Flushing usage events
[0m11:32:52.189823 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:36:55.360816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EECD5C7860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EECA1B7320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EECD7858E0>]}


============================== 11:36:55.368148 | 256225e2-2d7b-4f40-85e4-ae497233b24e ==============================
[0m11:36:55.368148 [info ] [MainThread]: Running with dbt=1.10.15
[0m11:36:55.368148 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select staging', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\sanofi-accelerator-mfg-data-platform\\dbt_project\\logs'}
[0m11:36:56.093327 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:36:56.093327 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:36:56.093327 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:36:56.308134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '256225e2-2d7b-4f40-85e4-ae497233b24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE22EB680>]}
[0m11:36:56.378211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '256225e2-2d7b-4f40-85e4-ae497233b24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE22C70B0>]}
[0m11:36:56.378211 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m11:36:56.808291 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m11:36:56.958431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:36:56.958431 [debug] [MainThread]: Partial parsing: updated file: mfg_accelerator://models\staging\stg_production_orders.sql
[0m11:36:56.958431 [debug] [MainThread]: Partial parsing: updated file: mfg_accelerator://models\staging\stg_batches.sql
[0m11:36:56.963512 [debug] [MainThread]: Partial parsing: updated file: mfg_accelerator://models\staging\stg_materials.sql
[0m11:36:57.404645 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m11:36:57.404645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '256225e2-2d7b-4f40-85e4-ae497233b24e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE295F020>]}
[0m11:36:57.518410 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mfg_accelerator.core
- models.mfg_accelerator.marts
[0m11:36:57.538364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '256225e2-2d7b-4f40-85e4-ae497233b24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE291AA80>]}
[0m11:36:57.633313 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m11:36:57.633313 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m11:36:57.653623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '256225e2-2d7b-4f40-85e4-ae497233b24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE2AD5D30>]}
[0m11:36:57.658133 [info ] [MainThread]: Found 3 models, 10 data tests, 3 sources, 504 macros
[0m11:36:57.658133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '256225e2-2d7b-4f40-85e4-ae497233b24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE2395100>]}
[0m11:36:57.659749 [info ] [MainThread]: 
[0m11:36:57.659749 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:36:57.659749 [info ] [MainThread]: 
[0m11:36:57.659749 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:36:57.659749 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m11:36:57.771453 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m11:36:57.772453 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m11:36:57.772453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:59.418875 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.648 seconds
[0m11:36:59.418875 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m11:36:59.434071 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m11:36:59.434071 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m11:36:59.434071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:00.639307 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.205 seconds
[0m11:37:00.643291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '256225e2-2d7b-4f40-85e4-ae497233b24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE254B3B0>]}
[0m11:37:00.648464 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.stg_batches
[0m11:37:00.648464 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.stg_materials
[0m11:37:00.648464 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.stg_production_orders
[0m11:37:00.648464 [info ] [Thread-1 (]: 1 of 3 START sql view model ANALYTICS_analytics.stg_batches .................... [RUN]
[0m11:37:00.648464 [info ] [Thread-2 (]: 2 of 3 START sql view model ANALYTICS_analytics.stg_materials .................. [RUN]
[0m11:37:00.648464 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_batches'
[0m11:37:00.648464 [info ] [Thread-3 (]: 3 of 3 START sql view model ANALYTICS_analytics.stg_production_orders .......... [RUN]
[0m11:37:00.648464 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_materials'
[0m11:37:00.648464 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.stg_batches
[0m11:37:00.658359 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_production_orders'
[0m11:37:00.658359 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.stg_materials
[0m11:37:00.665670 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.stg_batches"
[0m11:37:00.668519 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.stg_production_orders
[0m11:37:00.668519 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.stg_materials"
[0m11:37:00.674248 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.stg_production_orders"
[0m11:37:00.674248 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.stg_batches
[0m11:37:00.711972 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.stg_batches"
[0m11:37:00.718518 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.stg_materials
[0m11:37:00.718518 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.stg_production_orders
[0m11:37:00.718518 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.stg_materials"
[0m11:37:00.725707 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.stg_production_orders"
[0m11:37:00.727166 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.stg_batches"
[0m11:37:00.728672 [debug] [Thread-1 (]: On model.mfg_accelerator.stg_batches: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
  
  
  
  
  as (
    -- stg_batches.sql
-- Purpose:
--  - Clean and standardize batch data
--  - Ensure dates and numeric types are correct

with source as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.RAW.batches

),

renamed as (

    select
        batch_id                         as batch_id,
        material_id                      as material_id,
        manufacturing_site               as manufacturing_site,
        cast(manufacture_date as date)   as manufacture_date,
        cast(expiry_date as date)        as expiry_date,
        cast(quantity as number)         as quantity,
        batch_status                     as batch_status
    from source

)

select * from renamed
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_batches"} */;
[0m11:37:00.729678 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:37:00.731721 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.stg_materials"
[0m11:37:00.733684 [debug] [Thread-2 (]: On model.mfg_accelerator.stg_materials: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
  
  
  
  
  as (
    -- stg_materials.sql
-- Purpose:
--  - Create a clean, standardized view of materials
--  - Apply basic typing and naming conventions
--  - This is the first "T" step after RAW

with source as (

    -- Pull data from the RAW.MATERIALS table registered as a source
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        status,
        created_at
    from MFG_ACCELERATOR.RAW.materials

),

renamed as (

    -- Apply any renaming / typing here
    select
        material_id                as material_id,        -- keep same, but explicitly select
        material_name              as material_name,
        material_type              as material_type,
        unit_of_measure            as unit_of_measure,
        status                     as material_status,    -- rename to avoid generic 'status'
        cast(created_at as date)   as created_at
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_materials"} */;
[0m11:37:00.734685 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.stg_production_orders"
[0m11:37:00.735849 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:37:00.736322 [debug] [Thread-3 (]: On model.mfg_accelerator.stg_production_orders: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
  
  
  
  
  as (
    -- stg_production_orders.sql
-- Purpose:
--  - Clean and standardize production order data
--  - Ensure date fields and statuses are typed and named consistently

with source as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.RAW.production_orders

),

renamed as (

    select
        order_id                               as order_id,
        batch_id                               as batch_id,
        order_type                             as order_type,
        cast(planned_start_date as date)       as planned_start_date,
        cast(planned_end_date as date)         as planned_end_date,
        cast(actual_start_date as date)        as actual_start_date,
        cast(actual_end_date as date)          as actual_end_date,
        order_status                           as order_status,
        line_id                                as line_id
    from source

)

select * from renamed
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_production_orders"} */;
[0m11:37:00.741479 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:37:01.905571 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c0f47d-0107-3fac-0013-40ff0010a236
[0m11:37:01.905571 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 41 at position 151 unexpected ';'.
[0m11:37:01.908584 [debug] [Thread-1 (]: Database Error in model stg_batches (models\staging\stg_batches.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 151 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_batches.sql
[0m11:37:01.910648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '256225e2-2d7b-4f40-85e4-ae497233b24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE2FCE720>]}
[0m11:37:01.910648 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model ANALYTICS_analytics.stg_batches ........... [[31mERROR[0m in 1.26s]
[0m11:37:01.910648 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.stg_batches
[0m11:37:01.910648 [debug] [Thread-7 (]: Marking all children of 'model.mfg_accelerator.stg_batches' to be skipped because of status 'error'.  Reason: Database Error in model stg_batches (models\staging\stg_batches.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 151 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_batches.sql.
[0m11:37:02.098665 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c0f47d-0107-3c83-0013-40ff00107236
[0m11:37:02.098665 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 45 at position 161 unexpected ';'.
[0m11:37:02.103694 [debug] [Thread-3 (]: Database Error in model stg_production_orders (models\staging\stg_production_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 45 at position 161 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_production_orders.sql
[0m11:37:02.103694 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '256225e2-2d7b-4f40-85e4-ae497233b24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE314FB90>]}
[0m11:37:02.103694 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model ANALYTICS_analytics.stg_production_orders . [[31mERROR[0m in 1.46s]
[0m11:37:02.105706 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.stg_production_orders
[0m11:37:02.105706 [debug] [Thread-7 (]: Marking all children of 'model.mfg_accelerator.stg_production_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_production_orders (models\staging\stg_production_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 45 at position 161 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_production_orders.sql.
[0m11:37:02.199005 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.467 seconds
[0m11:37:02.218372 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '256225e2-2d7b-4f40-85e4-ae497233b24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EECAC5A4B0>]}
[0m11:37:02.218372 [info ] [Thread-2 (]: 2 of 3 OK created sql view model ANALYTICS_analytics.stg_materials ............. [[32mSUCCESS 1[0m in 1.57s]
[0m11:37:02.224523 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.stg_materials
[0m11:37:02.224523 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:37:02.224523 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR' was left open.
[0m11:37:02.224523 [debug] [MainThread]: On list_MFG_ACCELERATOR: Close
[0m11:37:02.719215 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics' was left open.
[0m11:37:02.719215 [debug] [MainThread]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: Close
[0m11:37:03.150482 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_batches' was left open.
[0m11:37:03.150482 [debug] [MainThread]: On model.mfg_accelerator.stg_batches: Close
[0m11:37:03.578477 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_materials' was left open.
[0m11:37:03.578477 [debug] [MainThread]: On model.mfg_accelerator.stg_materials: Close
[0m11:37:04.028873 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_production_orders' was left open.
[0m11:37:04.028873 [debug] [MainThread]: On model.mfg_accelerator.stg_production_orders: Close
[0m11:37:04.521477 [info ] [MainThread]: 
[0m11:37:04.521477 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 6.86 seconds (6.86s).
[0m11:37:04.521477 [debug] [MainThread]: Command end result
[0m11:37:04.553599 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m11:37:04.553599 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m11:37:04.565266 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\run_results.json
[0m11:37:04.568531 [info ] [MainThread]: 
[0m11:37:04.568531 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m11:37:04.568531 [info ] [MainThread]: 
[0m11:37:04.568531 [error] [MainThread]: [31mFailure in model stg_batches (models\staging\stg_batches.sql)[0m
[0m11:37:04.568531 [error] [MainThread]:   Database Error in model stg_batches (models\staging\stg_batches.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 151 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_batches.sql
[0m11:37:04.568531 [info ] [MainThread]: 
[0m11:37:04.568531 [info ] [MainThread]:   compiled code at target\compiled\mfg_accelerator\models\staging\stg_batches.sql
[0m11:37:04.568531 [info ] [MainThread]: 
[0m11:37:04.574433 [error] [MainThread]: [31mFailure in model stg_production_orders (models\staging\stg_production_orders.sql)[0m
[0m11:37:04.574996 [error] [MainThread]:   Database Error in model stg_production_orders (models\staging\stg_production_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 45 at position 161 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_production_orders.sql
[0m11:37:04.576005 [info ] [MainThread]: 
[0m11:37:04.576005 [info ] [MainThread]:   compiled code at target\compiled\mfg_accelerator\models\staging\stg_production_orders.sql
[0m11:37:04.577040 [info ] [MainThread]: 
[0m11:37:04.577040 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=3
[0m11:37:04.578548 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:37:04.580590 [debug] [MainThread]: Command `dbt run` failed at 11:37:04.580590 after 9.45 seconds
[0m11:37:04.580590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EECDF6D160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EECDF6E660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE293F440>]}
[0m11:37:04.581588 [debug] [MainThread]: Flushing usage events
[0m11:37:05.638503 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:58.637662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A6B1F47D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A6B1F75C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A6B1F67E0>]}


============================== 11:38:58.649664 | 3b0268e3-fae7-4a29-80df-d1d9528cd084 ==============================
[0m11:38:58.649664 [info ] [MainThread]: Running with dbt=1.10.15
[0m11:38:58.649664 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select staging', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\sanofi-accelerator-mfg-data-platform\\dbt_project\\logs'}
[0m11:38:59.368038 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:38:59.368038 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:38:59.368038 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:38:59.584123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b0268e3-fae7-4a29-80df-d1d9528cd084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A7DB0C7D0>]}
[0m11:38:59.648061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b0268e3-fae7-4a29-80df-d1d9528cd084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A7E455B80>]}
[0m11:38:59.648061 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m11:39:00.083169 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m11:39:00.235946 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:39:00.237952 [debug] [MainThread]: Partial parsing: updated file: mfg_accelerator://models\staging\stg_production_orders.sql
[0m11:39:00.237952 [debug] [MainThread]: Partial parsing: updated file: mfg_accelerator://models\staging\stg_batches.sql
[0m11:39:00.671496 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m11:39:00.671496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3b0268e3-fae7-4a29-80df-d1d9528cd084', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A004697F0>]}
[0m11:39:00.773050 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mfg_accelerator.marts
- models.mfg_accelerator.core
[0m11:39:00.787923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b0268e3-fae7-4a29-80df-d1d9528cd084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A7FFB60F0>]}
[0m11:39:00.882983 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m11:39:00.882983 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m11:39:00.903309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b0268e3-fae7-4a29-80df-d1d9528cd084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A002D84A0>]}
[0m11:39:00.903309 [info ] [MainThread]: Found 3 models, 10 data tests, 3 sources, 504 macros
[0m11:39:00.907858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b0268e3-fae7-4a29-80df-d1d9528cd084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A00549EB0>]}
[0m11:39:00.907858 [info ] [MainThread]: 
[0m11:39:00.910873 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:39:00.910873 [info ] [MainThread]: 
[0m11:39:00.910873 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:39:00.918863 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m11:39:01.017991 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m11:39:01.017991 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m11:39:01.017991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:02.694566 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.675 seconds
[0m11:39:02.698080 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m11:39:02.710430 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m11:39:02.710430 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m11:39:02.710430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:04.091315 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.386 seconds
[0m11:39:04.098138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b0268e3-fae7-4a29-80df-d1d9528cd084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A00244350>]}
[0m11:39:04.103605 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.stg_batches
[0m11:39:04.103605 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.stg_materials
[0m11:39:04.103605 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.stg_production_orders
[0m11:39:04.103605 [info ] [Thread-1 (]: 1 of 3 START sql view model ANALYTICS_analytics.stg_batches .................... [RUN]
[0m11:39:04.107975 [info ] [Thread-2 (]: 2 of 3 START sql view model ANALYTICS_analytics.stg_materials .................. [RUN]
[0m11:39:04.107975 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_batches'
[0m11:39:04.107975 [info ] [Thread-3 (]: 3 of 3 START sql view model ANALYTICS_analytics.stg_production_orders .......... [RUN]
[0m11:39:04.107975 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_materials'
[0m11:39:04.107975 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.stg_batches
[0m11:39:04.107975 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_production_orders'
[0m11:39:04.107975 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.stg_materials
[0m11:39:04.120933 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.stg_batches"
[0m11:39:04.120933 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.stg_production_orders
[0m11:39:04.125961 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.stg_materials"
[0m11:39:04.131707 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.stg_production_orders"
[0m11:39:04.133671 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.stg_batches
[0m11:39:04.145486 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.stg_materials
[0m11:39:04.168208 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.stg_batches"
[0m11:39:04.168208 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.stg_materials"
[0m11:39:04.168208 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.stg_production_orders
[0m11:39:04.179520 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.stg_production_orders"
[0m11:39:04.181661 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.stg_batches"
[0m11:39:04.181661 [debug] [Thread-1 (]: On model.mfg_accelerator.stg_batches: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
  
  
  
  
  as (
    -- stg_batches.sql
-- Purpose:
--  - Clean and standardize batch data
--  - Ensure dates and numeric types are correct

with source as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.RAW.batches

),

renamed as (

    select
        batch_id                         as batch_id,
        material_id                      as material_id,
        manufacturing_site               as manufacturing_site,
        cast(manufacture_date as date)   as manufacture_date,
        cast(expiry_date as date)        as expiry_date,
        cast(quantity as number)         as quantity,
        batch_status                     as batch_status
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_batches"} */;
[0m11:39:04.183659 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.stg_materials"
[0m11:39:04.183659 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:39:04.184657 [debug] [Thread-2 (]: On model.mfg_accelerator.stg_materials: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
  
  
  
  
  as (
    -- stg_materials.sql
-- Purpose:
--  - Create a clean, standardized view of materials
--  - Apply basic typing and naming conventions
--  - This is the first "T" step after RAW

with source as (

    -- Pull data from the RAW.MATERIALS table registered as a source
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        status,
        created_at
    from MFG_ACCELERATOR.RAW.materials

),

renamed as (

    -- Apply any renaming / typing here
    select
        material_id                as material_id,        -- keep same, but explicitly select
        material_name              as material_name,
        material_type              as material_type,
        unit_of_measure            as unit_of_measure,
        status                     as material_status,    -- rename to avoid generic 'status'
        cast(created_at as date)   as created_at
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_materials"} */;
[0m11:39:04.186617 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.stg_production_orders"
[0m11:39:04.189067 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:39:04.192070 [debug] [Thread-3 (]: On model.mfg_accelerator.stg_production_orders: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
  
  
  
  
  as (
    -- stg_production_orders.sql
-- Purpose:
--  - Clean and standardize production order data
--  - Ensure date fields and statuses are typed and named consistently

with source as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.RAW.production_orders

),

renamed as (

    select
        order_id                               as order_id,
        batch_id                               as batch_id,
        order_type                             as order_type,
        cast(planned_start_date as date)       as planned_start_date,
        cast(planned_end_date as date)         as planned_end_date,
        cast(actual_start_date as date)        as actual_start_date,
        cast(actual_end_date as date)          as actual_end_date,
        order_status                           as order_status,
        line_id                                as line_id
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_production_orders"} */;
[0m11:39:04.205206 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:39:05.670921 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.466 seconds
[0m11:39:05.692107 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.509 seconds
[0m11:39:05.692107 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b0268e3-fae7-4a29-80df-d1d9528cd084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A686CA540>]}
[0m11:39:05.692107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b0268e3-fae7-4a29-80df-d1d9528cd084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A00BC6C90>]}
[0m11:39:05.692107 [info ] [Thread-3 (]: 3 of 3 OK created sql view model ANALYTICS_analytics.stg_production_orders ..... [[32mSUCCESS 1[0m in 1.58s]
[0m11:39:05.698237 [info ] [Thread-1 (]: 1 of 3 OK created sql view model ANALYTICS_analytics.stg_batches ............... [[32mSUCCESS 1[0m in 1.58s]
[0m11:39:05.698237 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.stg_production_orders
[0m11:39:05.698237 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.stg_batches
[0m11:39:05.698237 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.513 seconds
[0m11:39:05.708326 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b0268e3-fae7-4a29-80df-d1d9528cd084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A00AEA420>]}
[0m11:39:05.708326 [info ] [Thread-2 (]: 2 of 3 OK created sql view model ANALYTICS_analytics.stg_materials ............. [[32mSUCCESS 1[0m in 1.60s]
[0m11:39:05.708326 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.stg_materials
[0m11:39:05.712261 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:39:05.713296 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR' was left open.
[0m11:39:05.713296 [debug] [MainThread]: On list_MFG_ACCELERATOR: Close
[0m11:39:06.178763 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics' was left open.
[0m11:39:06.178763 [debug] [MainThread]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: Close
[0m11:39:06.608813 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_batches' was left open.
[0m11:39:06.608813 [debug] [MainThread]: On model.mfg_accelerator.stg_batches: Close
[0m11:39:07.321156 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_materials' was left open.
[0m11:39:07.321156 [debug] [MainThread]: On model.mfg_accelerator.stg_materials: Close
[0m11:39:07.788450 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_production_orders' was left open.
[0m11:39:07.788450 [debug] [MainThread]: On model.mfg_accelerator.stg_production_orders: Close
[0m11:39:08.254819 [info ] [MainThread]: 
[0m11:39:08.257991 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 7.34 seconds (7.34s).
[0m11:39:08.257991 [debug] [MainThread]: Command end result
[0m11:39:08.287947 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m11:39:08.293090 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m11:39:08.297977 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\run_results.json
[0m11:39:08.303123 [info ] [MainThread]: 
[0m11:39:08.303123 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:39:08.303123 [info ] [MainThread]: 
[0m11:39:08.303123 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m11:39:08.303123 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:39:08.303123 [debug] [MainThread]: Command `dbt run` succeeded at 11:39:08.303123 after 9.90 seconds
[0m11:39:08.308075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A6B34B470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A6B34B170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A002D9D30>]}
[0m11:39:08.308075 [debug] [MainThread]: Flushing usage events
[0m11:39:09.358668 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:40:20.447602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192B1ECBB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192B25E5700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192B25E7020>]}


============================== 11:40:20.447602 | 6bbf7663-57a9-4bb3-8909-50988303cad1 ==============================
[0m11:40:20.447602 [info ] [MainThread]: Running with dbt=1.10.15
[0m11:40:20.447602 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt test --select staging', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\sanofi-accelerator-mfg-data-platform\\dbt_project\\logs'}
[0m11:40:21.179797 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:40:21.179797 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:40:21.179797 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:40:21.407826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bbf7663-57a9-4bb3-8909-50988303cad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192C7059730>]}
[0m11:40:21.467559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bbf7663-57a9-4bb3-8909-50988303cad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192C72C87D0>]}
[0m11:40:21.467559 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m11:40:21.902855 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m11:40:22.053740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:40:22.053740 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:40:22.059815 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mfg_accelerator.marts
- models.mfg_accelerator.core
[0m11:40:22.109409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bbf7663-57a9-4bb3-8909-50988303cad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192C5405AF0>]}
[0m11:40:22.209401 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m11:40:22.209401 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m11:40:22.319446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bbf7663-57a9-4bb3-8909-50988303cad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192C7A8F4D0>]}
[0m11:40:22.319446 [info ] [MainThread]: Found 3 models, 10 data tests, 3 sources, 504 macros
[0m11:40:22.319446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bbf7663-57a9-4bb3-8909-50988303cad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192C7C479B0>]}
[0m11:40:22.319446 [info ] [MainThread]: 
[0m11:40:22.327538 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:40:22.327538 [info ] [MainThread]: 
[0m11:40:22.327538 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:40:22.337608 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m11:40:22.447723 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m11:40:22.447723 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m11:40:22.447723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:40:24.018245 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.571 seconds
[0m11:40:24.023721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bbf7663-57a9-4bb3-8909-50988303cad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192C7C30500>]}
[0m11:40:24.028159 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m11:40:24.028159 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m11:40:24.028159 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m11:40:24.028159 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m11:40:24.028159 [info ] [Thread-1 (]: 1 of 10 START test not_null_stg_batches_batch_id ............................... [RUN]
[0m11:40:24.028159 [info ] [Thread-2 (]: 2 of 10 START test not_null_stg_batches_material_id ............................ [RUN]
[0m11:40:24.028159 [info ] [Thread-3 (]: 3 of 10 START test not_null_stg_materials_material_id .......................... [RUN]
[0m11:40:24.028159 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0'
[0m11:40:24.028159 [info ] [Thread-4 (]: 4 of 10 START test not_null_stg_production_orders_batch_id ..................... [RUN]
[0m11:40:24.028159 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c'
[0m11:40:24.028159 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89'
[0m11:40:24.038086 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m11:40:24.038086 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5'
[0m11:40:24.038086 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m11:40:24.039837 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m11:40:24.060250 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m11:40:24.061214 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m11:40:24.067939 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m11:40:24.067939 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m11:40:24.073020 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m11:40:24.077916 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m11:40:24.108437 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m11:40:24.109501 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m11:40:24.110161 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m11:40:24.114462 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m11:40:24.114462 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m11:40:24.117839 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m11:40:24.122476 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m11:40:24.123476 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m11:40:24.124439 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"} */
[0m11:40:24.124439 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:40:24.125437 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m11:40:24.128989 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"} */
[0m11:40:24.131003 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m11:40:24.131003 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:40:24.131003 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m11:40:24.131003 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"} */
[0m11:40:24.137925 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"} */
[0m11:40:24.137925 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:40:24.137925 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:40:26.118208 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.977 seconds
[0m11:40:26.127894 [info ] [Thread-2 (]: 2 of 10 PASS not_null_stg_batches_material_id .................................. [[32mPASS[0m in 2.10s]
[0m11:40:26.127894 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m11:40:26.127894 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m11:40:26.127894 [info ] [Thread-2 (]: 5 of 10 START test not_null_stg_production_orders_order_id ..................... [RUN]
[0m11:40:26.127894 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c, now test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284)
[0m11:40:26.127894 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m11:40:26.127894 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m11:40:26.137886 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m11:40:26.143313 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m11:40:26.146275 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m11:40:26.147786 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"} */
[0m11:40:26.162128 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.031 seconds
[0m11:40:26.166124 [info ] [Thread-3 (]: 3 of 10 PASS not_null_stg_materials_material_id ................................ [[32mPASS[0m in 2.14s]
[0m11:40:26.168191 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m11:40:26.168191 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m11:40:26.168191 [info ] [Thread-3 (]: 6 of 10 START test relationships_stg_batches_material_id__material_id__ref_stg_materials_  [RUN]
[0m11:40:26.168191 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89, now test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2)
[0m11:40:26.168191 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m11:40:26.179663 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m11:40:26.182167 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m11:40:26.185178 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m11:40:26.187690 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m11:40:26.187690 [debug] [Thread-3 (]: On test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"} */
[0m11:40:26.187690 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.053 seconds
[0m11:40:26.200037 [info ] [Thread-4 (]: 4 of 10 PASS not_null_stg_production_orders_batch_id ........................... [[32mPASS[0m in 2.16s]
[0m11:40:26.201077 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m11:40:26.202059 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m11:40:26.202499 [info ] [Thread-4 (]: 7 of 10 START test relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [RUN]
[0m11:40:26.202965 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5, now test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519)
[0m11:40:26.202965 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m11:40:26.208173 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m11:40:26.208173 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m11:40:26.215969 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m11:40:26.217890 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.093 seconds
[0m11:40:26.220931 [info ] [Thread-1 (]: 1 of 10 PASS not_null_stg_batches_batch_id ..................................... [[32mPASS[0m in 2.19s]
[0m11:40:26.221903 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m11:40:26.223904 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m11:40:26.223904 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m11:40:26.224899 [debug] [Thread-4 (]: On test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"} */
[0m11:40:26.225901 [info ] [Thread-1 (]: 8 of 10 START test unique_stg_batches_batch_id ................................. [RUN]
[0m11:40:26.226870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0, now test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4)
[0m11:40:26.227869 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m11:40:26.239552 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m11:40:26.239552 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m11:40:26.239552 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m11:40:26.247802 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m11:40:26.248819 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"} */
[0m11:40:26.575143 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.428 seconds
[0m11:40:26.577865 [info ] [Thread-2 (]: 5 of 10 PASS not_null_stg_production_orders_order_id ........................... [[32mPASS[0m in 0.45s]
[0m11:40:26.577865 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m11:40:26.577865 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m11:40:26.577865 [info ] [Thread-2 (]: 9 of 10 START test unique_stg_materials_material_id ............................ [RUN]
[0m11:40:26.577865 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284, now test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21)
[0m11:40:26.577865 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m11:40:26.577865 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m11:40:26.587738 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m11:40:26.592907 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m11:40:26.596115 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m11:40:26.597113 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"} */
[0m11:40:26.747765 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.502 seconds
[0m11:40:26.747765 [info ] [Thread-1 (]: 8 of 10 PASS unique_stg_batches_batch_id ....................................... [[32mPASS[0m in 0.52s]
[0m11:40:26.747765 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m11:40:26.747765 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m11:40:26.747765 [info ] [Thread-1 (]: 10 of 10 START test unique_stg_production_orders_order_id ...................... [RUN]
[0m11:40:26.757809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4, now test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3)
[0m11:40:26.757809 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m11:40:26.765370 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m11:40:26.767914 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m11:40:26.767914 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m11:40:26.777863 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m11:40:26.777863 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"} */
[0m11:40:26.841329 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.652 seconds
[0m11:40:26.843309 [info ] [Thread-3 (]: 6 of 10 PASS relationships_stg_batches_material_id__material_id__ref_stg_materials_  [[32mPASS[0m in 0.68s]
[0m11:40:26.844311 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m11:40:26.909075 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.683 seconds
[0m11:40:26.912070 [info ] [Thread-4 (]: 7 of 10 PASS relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [[32mPASS[0m in 0.71s]
[0m11:40:26.914042 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m11:40:26.947509 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.351 seconds
[0m11:40:26.947509 [info ] [Thread-2 (]: 9 of 10 PASS unique_stg_materials_material_id .................................. [[32mPASS[0m in 0.37s]
[0m11:40:26.947509 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m11:40:27.247653 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.474 seconds
[0m11:40:27.247653 [info ] [Thread-1 (]: 10 of 10 PASS unique_stg_production_orders_order_id ............................ [[32mPASS[0m in 0.50s]
[0m11:40:27.247653 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m11:40:27.257908 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:40:27.257908 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics' was left open.
[0m11:40:27.257908 [debug] [MainThread]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: Close
[0m11:40:27.722124 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3' was left open.
[0m11:40:27.722124 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: Close
[0m11:40:28.178130 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21' was left open.
[0m11:40:28.178130 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: Close
[0m11:40:28.607695 [debug] [MainThread]: Connection 'test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2' was left open.
[0m11:40:28.609874 [debug] [MainThread]: On test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2: Close
[0m11:40:29.048422 [debug] [MainThread]: Connection 'test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519' was left open.
[0m11:40:29.048422 [debug] [MainThread]: On test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519: Close
[0m11:40:29.498119 [info ] [MainThread]: 
[0m11:40:29.498119 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 7.17 seconds (7.17s).
[0m11:40:29.502567 [debug] [MainThread]: Command end result
[0m11:40:29.534668 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m11:40:29.538185 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m11:40:29.538185 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\run_results.json
[0m11:40:29.546380 [info ] [MainThread]: 
[0m11:40:29.546380 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:40:29.547889 [info ] [MainThread]: 
[0m11:40:29.548567 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m11:40:29.548567 [debug] [MainThread]: Command `dbt test` succeeded at 11:40:29.548567 after 9.27 seconds
[0m11:40:29.548567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192C7B87EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192C7B87C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192B22F0B00>]}
[0m11:40:29.548567 [debug] [MainThread]: Flushing usage events
[0m11:40:30.520488 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:55:47.958286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3C04A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3B74EBA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3EC77530>]}


============================== 12:55:47.958286 | 05473aa6-fed4-4292-91d4-a4b8f6f34813 ==============================
[0m12:55:47.958286 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:55:47.968380 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run --select core', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\sanofi-accelerator-mfg-data-platform\\dbt_project\\logs'}
[0m12:55:48.808223 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:55:48.813372 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:55:48.813372 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:55:49.025207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05473aa6-fed4-4292-91d4-a4b8f6f34813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C51E6ED80>]}
[0m12:55:49.089615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05473aa6-fed4-4292-91d4-a4b8f6f34813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3EC76480>]}
[0m12:55:49.089615 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m12:55:49.563552 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:55:49.723241 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m12:55:49.724287 [debug] [MainThread]: Partial parsing: added file: mfg_accelerator://models\core\core_materials.sql
[0m12:55:49.724287 [debug] [MainThread]: Partial parsing: added file: mfg_accelerator://models\core\core_batches.sql
[0m12:55:49.724287 [debug] [MainThread]: Partial parsing: added file: mfg_accelerator://models\core\core_schema.yml
[0m12:55:49.724287 [debug] [MainThread]: Partial parsing: added file: mfg_accelerator://models\core\fct_production_orders.sql
[0m12:55:50.158387 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m12:55:50.158387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '05473aa6-fed4-4292-91d4-a4b8f6f34813', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C53EF7020>]}
[0m12:55:50.253426 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mfg_accelerator.marts
[0m12:55:50.268376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05473aa6-fed4-4292-91d4-a4b8f6f34813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C53F3A6C0>]}
[0m12:55:50.363529 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m12:55:50.363529 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m12:55:50.390564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05473aa6-fed4-4292-91d4-a4b8f6f34813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C54083230>]}
[0m12:55:50.390564 [info ] [MainThread]: Found 6 models, 20 data tests, 3 sources, 504 macros
[0m12:55:50.390564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05473aa6-fed4-4292-91d4-a4b8f6f34813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3F497020>]}
[0m12:55:50.394624 [info ] [MainThread]: 
[0m12:55:50.394624 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:55:50.394624 [info ] [MainThread]: 
[0m12:55:50.394624 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:55:50.400331 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m12:55:50.528420 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m12:55:50.528420 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m12:55:50.528420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:52.575776 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.048 seconds
[0m12:55:52.578457 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m12:55:52.591512 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m12:55:52.591512 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m12:55:52.591512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:53.974874 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.381 seconds
[0m12:55:53.978581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05473aa6-fed4-4292-91d4-a4b8f6f34813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C53FFBBC0>]}
[0m12:55:53.978581 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.core_materials
[0m12:55:53.978581 [info ] [Thread-1 (]: 1 of 3 START sql table model ANALYTICS_analytics.core_materials ................ [RUN]
[0m12:55:53.978581 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mfg_accelerator.core_materials'
[0m12:55:53.978581 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.core_materials
[0m12:55:53.994475 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.core_materials"
[0m12:55:53.996481 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.core_materials
[0m12:55:54.038313 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.core_materials"
[0m12:55:54.042494 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.core_materials"
[0m12:55:54.044830 [debug] [Thread-1 (]: On model.mfg_accelerator.core_materials: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
    
    
    
    as (-- core_materials.sql
-- Purpose:
--  - Create a cleaned, enriched material dimension
--  - Add simple derived attributes (e.g. is_active flag, age)

with base as (

    -- Use the staging view as the single source of truth for materials
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,
        created_at
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials

),

enriched as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,

        created_at,

        -- Age of the material definition in days
        datediff('day', created_at, current_date()) as material_age_days,

        -- Simple flag to say if the material is considered active
        case
            when upper(material_status) = 'ACTIVE' then 1
            else 0
        end as is_active_material
    from base

)

select * from enriched
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_materials"} */;
[0m12:55:54.044830 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:55:57.179045 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.138 seconds
[0m12:55:57.206435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05473aa6-fed4-4292-91d4-a4b8f6f34813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3C14A630>]}
[0m12:55:57.206435 [info ] [Thread-1 (]: 1 of 3 OK created sql table model ANALYTICS_analytics.core_materials ........... [[32mSUCCESS 1[0m in 3.23s]
[0m12:55:57.208443 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.core_materials
[0m12:55:57.208443 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.core_batches
[0m12:55:57.208443 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.fct_production_orders
[0m12:55:57.208443 [info ] [Thread-3 (]: 2 of 3 START sql table model ANALYTICS_analytics.core_batches .................. [RUN]
[0m12:55:57.208443 [info ] [Thread-4 (]: 3 of 3 START sql table model ANALYTICS_analytics.fct_production_orders ......... [RUN]
[0m12:55:57.208443 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.core_batches'
[0m12:55:57.214248 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.mfg_accelerator.fct_production_orders'
[0m12:55:57.215149 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.core_batches
[0m12:55:57.215792 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.fct_production_orders
[0m12:55:57.218428 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.core_batches"
[0m12:55:57.225360 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.fct_production_orders"
[0m12:55:57.226299 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.core_batches
[0m12:55:57.228312 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.fct_production_orders
[0m12:55:57.228312 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.core_batches"
[0m12:55:57.228312 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.fct_production_orders"
[0m12:55:57.238361 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.core_batches"
[0m12:55:57.238361 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.fct_production_orders"
[0m12:55:57.244058 [debug] [Thread-3 (]: On model.mfg_accelerator.core_batches: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    
    
    
    as (-- core_batches.sql
-- Purpose:
--  - Combine batch info with material attributes
--  - Add shelf-life and expiry-related metrics

with batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        b.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        -- Shelf life in days = expiry - manufacture
        datediff('day', manufacture_date, expiry_date) as shelf_life_days,

        -- Batch age in days from manufacture date until today
        datediff('day', manufacture_date, current_date()) as batch_age_days,

        -- Days until expiry (can be negative if already expired)
        datediff('day', current_date(), expiry_date) as days_to_expiry,

        case
            when current_date() > expiry_date then 1
            else 0
        end as is_expired
    from batches b
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_batches"} */;
[0m12:55:57.244058 [debug] [Thread-4 (]: On model.mfg_accelerator.fct_production_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    
    
    
    as (-- fct_production_orders.sql
-- Purpose:
--  - Fact-like table combining production orders with batch and material context
--  - Compute planned vs actual durations and simple on-time indicators

with orders as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders

),

batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        o.order_id,
        o.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        o.order_type,
        o.line_id,
        o.order_status,

        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        -- Planned duration in days
        datediff('day', planned_start_date, planned_end_date) as planned_duration_days,

        -- Actual duration in days (null if no end date)
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', actual_start_date, actual_end_date)
            else null
        end as actual_duration_days,

        -- Delay vs plan: how many days longer the actual duration was
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', planned_end_date, actual_end_date)
            else null
        end as delay_vs_plan_days,

        -- Simple late flag: 1 if order completed after planned_end_date
        case
            when actual_end_date is not null
             and actual_end_date > planned_end_date
            then 1
            else 0
        end as is_late,

        -- Is the order completed?
        case
            when upper(order_status) = 'COMPLETED' then 1
            else 0
        end as is_completed
    from orders o
    left join batches b
        on o.batch_id = b.batch_id
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.fct_production_orders"} */;
[0m12:55:57.244058 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:55:57.246931 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:56:00.018663 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.772 seconds
[0m12:56:00.021319 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05473aa6-fed4-4292-91d4-a4b8f6f34813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C547519D0>]}
[0m12:56:00.021319 [info ] [Thread-4 (]: 3 of 3 OK created sql table model ANALYTICS_analytics.fct_production_orders .... [[32mSUCCESS 1[0m in 2.81s]
[0m12:56:00.021319 [debug] [Thread-4 (]: Finished running node model.mfg_accelerator.fct_production_orders
[0m12:56:00.060562 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.815 seconds
[0m12:56:00.060562 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05473aa6-fed4-4292-91d4-a4b8f6f34813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C54760500>]}
[0m12:56:00.060562 [info ] [Thread-3 (]: 2 of 3 OK created sql table model ANALYTICS_analytics.core_batches ............. [[32mSUCCESS 1[0m in 2.85s]
[0m12:56:00.060562 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.core_batches
[0m12:56:00.060562 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:00.068363 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR' was left open.
[0m12:56:00.068363 [debug] [MainThread]: On list_MFG_ACCELERATOR: Close
[0m12:56:00.548386 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics' was left open.
[0m12:56:00.548386 [debug] [MainThread]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: Close
[0m12:56:01.009295 [debug] [MainThread]: Connection 'model.mfg_accelerator.core_materials' was left open.
[0m12:56:01.009295 [debug] [MainThread]: On model.mfg_accelerator.core_materials: Close
[0m12:56:01.459253 [debug] [MainThread]: Connection 'model.mfg_accelerator.core_batches' was left open.
[0m12:56:01.459253 [debug] [MainThread]: On model.mfg_accelerator.core_batches: Close
[0m12:56:01.925345 [debug] [MainThread]: Connection 'model.mfg_accelerator.fct_production_orders' was left open.
[0m12:56:01.928661 [debug] [MainThread]: On model.mfg_accelerator.fct_production_orders: Close
[0m12:56:02.348322 [info ] [MainThread]: 
[0m12:56:02.348322 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 11.95 seconds (11.95s).
[0m12:56:02.348322 [debug] [MainThread]: Command end result
[0m12:56:02.386304 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m12:56:02.388344 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m12:56:02.398604 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\run_results.json
[0m12:56:02.398604 [info ] [MainThread]: 
[0m12:56:02.398604 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:56:02.398604 [info ] [MainThread]: 
[0m12:56:02.398604 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m12:56:02.398604 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:56:02.398604 [debug] [MainThread]: Command `dbt run` succeeded at 12:56:02.398604 after 14.67 seconds
[0m12:56:02.398604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3F338C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C5400F410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C54401490>]}
[0m12:56:02.398604 [debug] [MainThread]: Flushing usage events
[0m12:56:03.408454 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:56:47.727997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246EAE41A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246ECDFEC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246ECDFDEB0>]}


============================== 12:56:47.739410 | f54b7a05-4124-499a-8edc-1254388cda55 ==============================
[0m12:56:47.739410 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:56:47.739410 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt test --select core', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\sanofi-accelerator-mfg-data-platform\\dbt_project\\logs'}
[0m12:56:48.489493 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:56:48.489493 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:56:48.489493 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:56:48.698406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f54b7a05-4124-499a-8edc-1254388cda55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002468221AF60>]}
[0m12:56:48.768241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f54b7a05-4124-499a-8edc-1254388cda55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002468092DB80>]}
[0m12:56:48.768241 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m12:56:49.218086 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:56:49.378064 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:56:49.378064 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:56:49.378064 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mfg_accelerator.marts
[0m12:56:49.435702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f54b7a05-4124-499a-8edc-1254388cda55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246822D7E30>]}
[0m12:56:49.532397 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m12:56:49.532397 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m12:56:49.618244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f54b7a05-4124-499a-8edc-1254388cda55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246824857F0>]}
[0m12:56:49.618244 [info ] [MainThread]: Found 6 models, 20 data tests, 3 sources, 504 macros
[0m12:56:49.618244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f54b7a05-4124-499a-8edc-1254388cda55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246824E4C50>]}
[0m12:56:49.627954 [info ] [MainThread]: 
[0m12:56:49.627954 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:56:49.627954 [info ] [MainThread]: 
[0m12:56:49.627954 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:56:49.637976 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m12:56:49.772990 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m12:56:49.772990 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m12:56:49.772990 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:51.228403 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.455 seconds
[0m12:56:51.228403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f54b7a05-4124-499a-8edc-1254388cda55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024681C51FA0>]}
[0m12:56:51.238129 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m12:56:51.238129 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m12:56:51.238129 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m12:56:51.238129 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m12:56:51.238129 [info ] [Thread-1 (]: 1 of 10 START test not_null_core_batches_batch_id .............................. [RUN]
[0m12:56:51.238129 [info ] [Thread-2 (]: 2 of 10 START test not_null_core_batches_material_id ........................... [RUN]
[0m12:56:51.238129 [info ] [Thread-3 (]: 3 of 10 START test not_null_core_materials_material_id ......................... [RUN]
[0m12:56:51.238129 [info ] [Thread-4 (]: 4 of 10 START test not_null_fct_production_orders_batch_id ..................... [RUN]
[0m12:56:51.238129 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c'
[0m12:56:51.244401 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e'
[0m12:56:51.244401 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8'
[0m12:56:51.244401 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1'
[0m12:56:51.244401 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m12:56:51.244401 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m12:56:51.244401 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m12:56:51.248440 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m12:56:51.268456 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m12:56:51.273668 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m12:56:51.278483 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m12:56:51.278483 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m12:56:51.287590 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m12:56:51.288680 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m12:56:51.288680 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m12:56:51.318599 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m12:56:51.318599 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m12:56:51.318599 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m12:56:51.325964 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m12:56:51.330512 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m12:56:51.331285 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m12:56:51.331285 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m12:56:51.333811 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m12:56:51.333811 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"} */
[0m12:56:51.333811 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m12:56:51.333811 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"} */
[0m12:56:51.333811 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"} */
[0m12:56:51.338390 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:56:51.338390 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"} */
[0m12:56:51.338390 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:56:51.338390 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:56:51.341867 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:56:52.538270 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.200 seconds
[0m12:56:52.551963 [info ] [Thread-3 (]: 3 of 10 PASS not_null_core_materials_material_id ............................... [[32mPASS[0m in 1.30s]
[0m12:56:52.551963 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m12:56:52.554114 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m12:56:52.554114 [info ] [Thread-3 (]: 5 of 10 START test not_null_fct_production_orders_order_id ..................... [RUN]
[0m12:56:52.554114 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8, now test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f)
[0m12:56:52.554114 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m12:56:52.563111 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m12:56:52.565120 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m12:56:52.569661 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m12:56:52.573283 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m12:56:52.573283 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"} */
[0m12:56:52.648601 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.309 seconds
[0m12:56:52.648601 [info ] [Thread-4 (]: 4 of 10 PASS not_null_fct_production_orders_batch_id ........................... [[32mPASS[0m in 1.40s]
[0m12:56:52.648601 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m12:56:52.654572 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m12:56:52.654572 [info ] [Thread-4 (]: 6 of 10 START test relationships_core_batches_material_id__material_id__ref_core_materials_  [RUN]
[0m12:56:52.654572 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1, now test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6)
[0m12:56:52.654572 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m12:56:52.663012 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m12:56:52.663012 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m12:56:52.668213 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m12:56:52.668213 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m12:56:52.668213 [debug] [Thread-4 (]: On test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"} */
[0m12:56:52.876054 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.538 seconds
[0m12:56:52.880121 [info ] [Thread-2 (]: 2 of 10 PASS not_null_core_batches_material_id ................................. [[32mPASS[0m in 1.64s]
[0m12:56:52.882305 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m12:56:52.886404 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.546 seconds
[0m12:56:52.886404 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m12:56:52.893843 [info ] [Thread-1 (]: 1 of 10 PASS not_null_core_batches_batch_id .................................... [[32mPASS[0m in 1.65s]
[0m12:56:52.895870 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m12:56:52.898382 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m12:56:52.893843 [info ] [Thread-2 (]: 7 of 10 START test relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [RUN]
[0m12:56:52.900469 [info ] [Thread-1 (]: 8 of 10 START test unique_core_batches_batch_id ................................ [RUN]
[0m12:56:52.900469 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e, now test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d)
[0m12:56:52.903351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c, now test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf)
[0m12:56:52.905364 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m12:56:52.906876 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m12:56:52.926474 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m12:56:52.943265 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m12:56:52.947323 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m12:56:52.954525 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m12:56:52.956538 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m12:56:52.964002 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m12:56:52.966014 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m12:56:52.968025 [debug] [Thread-2 (]: On test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"} */
[0m12:56:52.969072 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m12:56:52.969072 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"} */
[0m12:56:53.048385 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.475 seconds
[0m12:56:53.052488 [info ] [Thread-3 (]: 5 of 10 PASS not_null_fct_production_orders_order_id ........................... [[32mPASS[0m in 0.50s]
[0m12:56:53.052488 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m12:56:53.052488 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m12:56:53.055915 [info ] [Thread-3 (]: 9 of 10 START test unique_core_materials_material_id ........................... [RUN]
[0m12:56:53.055915 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f, now test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2)
[0m12:56:53.055915 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m12:56:53.058428 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m12:56:53.058428 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m12:56:53.069099 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m12:56:53.072166 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m12:56:53.072166 [debug] [Thread-3 (]: On test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"} */
[0m12:56:53.081241 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.410 seconds
[0m12:56:53.084507 [info ] [Thread-4 (]: 6 of 10 PASS relationships_core_batches_material_id__material_id__ref_core_materials_  [[32mPASS[0m in 0.43s]
[0m12:56:53.088075 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m12:56:53.088075 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m12:56:53.088075 [info ] [Thread-4 (]: 10 of 10 START test unique_fct_production_orders_order_id ...................... [RUN]
[0m12:56:53.088075 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6, now test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442)
[0m12:56:53.088075 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m12:56:53.101769 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m12:56:53.101769 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m12:56:53.111350 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m12:56:53.116221 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m12:56:53.118216 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"} */
[0m12:56:53.324831 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.352 seconds
[0m12:56:53.324831 [info ] [Thread-1 (]: 8 of 10 PASS unique_core_batches_batch_id ...................................... [[32mPASS[0m in 0.42s]
[0m12:56:53.328038 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m12:56:53.438581 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.472 seconds
[0m12:56:53.443390 [info ] [Thread-2 (]: 7 of 10 PASS relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [[32mPASS[0m in 0.54s]
[0m12:56:53.443390 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m12:56:53.476071 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.402 seconds
[0m12:56:53.478409 [info ] [Thread-3 (]: 9 of 10 PASS unique_core_materials_material_id ................................. [[32mPASS[0m in 0.42s]
[0m12:56:53.478409 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m12:56:53.511552 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.397 seconds
[0m12:56:53.518253 [info ] [Thread-4 (]: 10 of 10 PASS unique_fct_production_orders_order_id ............................ [[32mPASS[0m in 0.43s]
[0m12:56:53.518253 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m12:56:53.518253 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:53.518253 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics' was left open.
[0m12:56:53.518253 [debug] [MainThread]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: Close
[0m12:56:53.988495 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf' was left open.
[0m12:56:53.988495 [debug] [MainThread]: On test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf: Close
[0m12:56:54.478645 [debug] [MainThread]: Connection 'test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d' was left open.
[0m12:56:54.478645 [debug] [MainThread]: On test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d: Close
[0m12:56:54.908914 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2' was left open.
[0m12:56:54.908914 [debug] [MainThread]: On test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2: Close
[0m12:56:55.343105 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442' was left open.
[0m12:56:55.345120 [debug] [MainThread]: On test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442: Close
[0m12:56:55.808850 [info ] [MainThread]: 
[0m12:56:55.808850 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 6.18 seconds (6.18s).
[0m12:56:55.808850 [debug] [MainThread]: Command end result
[0m12:56:55.848386 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m12:56:55.848386 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m12:56:55.860364 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\run_results.json
[0m12:56:55.860364 [info ] [MainThread]: 
[0m12:56:55.860364 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:56:55.860364 [info ] [MainThread]: 
[0m12:56:55.860364 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m12:56:55.860364 [debug] [MainThread]: Command `dbt test` succeeded at 12:56:55.860364 after 8.27 seconds
[0m12:56:55.860364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024682693FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024682693DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246825DDB20>]}
[0m12:56:55.860364 [debug] [MainThread]: Flushing usage events
[0m12:56:56.782438 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:57:14.436011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E313BBB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2E9F14F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2E60F830>]}


============================== 14:57:14.460564 | 589c1eca-2303-40ab-8cb6-d7d965444772 ==============================
[0m14:57:14.460564 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:57:14.461586 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run --select marts', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\sanofi-accelerator-mfg-data-platform\\dbt_project\\logs'}
[0m14:57:20.835709 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:57:20.835709 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:57:20.835709 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:57:21.135719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '589c1eca-2303-40ab-8cb6-d7d965444772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2F38B350>]}
[0m14:57:21.201008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '589c1eca-2303-40ab-8cb6-d7d965444772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E4436F380>]}
[0m14:57:21.211398 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m14:57:21.735657 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:57:21.895603 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m14:57:21.897256 [debug] [MainThread]: Partial parsing: added file: mfg_accelerator://models\marts\mfg_plant_daily_kpis.sql
[0m14:57:21.897256 [debug] [MainThread]: Partial parsing: added file: mfg_accelerator://models\marts\mfg_ml_features_orders.sql
[0m14:57:21.897256 [debug] [MainThread]: Partial parsing: added file: mfg_accelerator://models\marts\marts_schema.yml
[0m14:57:22.412851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '589c1eca-2303-40ab-8cb6-d7d965444772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E470A61B0>]}
[0m14:57:22.515823 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m14:57:22.519027 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m14:57:22.725942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '589c1eca-2303-40ab-8cb6-d7d965444772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E4708CA10>]}
[0m14:57:22.731014 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m14:57:22.731014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '589c1eca-2303-40ab-8cb6-d7d965444772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E4723E1E0>]}
[0m14:57:22.731014 [info ] [MainThread]: 
[0m14:57:22.731014 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:57:22.731014 [info ] [MainThread]: 
[0m14:57:22.735679 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:57:22.735679 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m14:57:22.951620 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m14:57:22.951620 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m14:57:22.951620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:24.651150 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.699 seconds
[0m14:57:24.659000 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m14:57:24.671263 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m14:57:24.671263 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m14:57:24.674777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:25.886351 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.219 seconds
[0m14:57:25.895907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '589c1eca-2303-40ab-8cb6-d7d965444772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E472F5100>]}
[0m14:57:25.905838 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.mfg_ml_features_orders
[0m14:57:25.914260 [info ] [Thread-1 (]: 1 of 1 START sql table model ANALYTICS_analytics.mfg_ml_features_orders ........ [RUN]
[0m14:57:25.914260 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mfg_accelerator.mfg_ml_features_orders'
[0m14:57:25.915766 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.mfg_ml_features_orders
[0m14:57:25.915766 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:57:25.926116 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.mfg_ml_features_orders
[0m14:57:25.958967 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:57:25.966169 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:57:25.966169 [debug] [Thread-1 (]: On model.mfg_accelerator.mfg_ml_features_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
    
    
    
    as (-- mfg_ml_features_orders.sql
-- Purpose:
--  - Provide ML-ready features at order grain
--  - Target use case: predict late orders or delay vs plan
-- Grain:
--  - One row per production order (order_id)

with orders as (

    select
        order_id,
        batch_id,
        material_id,

        manufacturing_site,
        line_id,

        order_type,
        order_status,

        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,

        planned_duration_days,
        actual_duration_days,
        delay_vs_plan_days,
        is_late,
        is_completed
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders

),

materials as (

    select
        material_id,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

batches as (

    select
        batch_id,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches

),

joined as (

    select
        o.order_id,

        -- Keys and IDs
        o.batch_id,
        o.material_id,

        -- Plant / line / type
        o.manufacturing_site,
        o.line_id,
        o.order_type,
        o.order_status,

        -- Material features
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        -- Batch features
        b.quantity,
        b.batch_status,
        b.shelf_life_days,
        b.batch_age_days,
        b.days_to_expiry,
        b.is_expired,

        -- Temporal features
        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        o.planned_duration_days,
        o.actual_duration_days,
        o.delay_vs_plan_days,

        -- Labels / targets
        o.is_late,
        o.is_completed
    from orders o
    left join materials m
        on o.material_id = m.material_id
    left join batches b
        on o.batch_id = b.batch_id

),

final as (

    select
        -- Primary key
        order_id,

        -- Categorical features
        manufacturing_site,
        line_id,
        order_type,
        order_status,
        material_type,
        unit_of_measure,
        batch_status,

        -- Material state
        is_active_material,

        -- Quantitative batch features
        quantity,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired,

        -- Temporal planning features
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        planned_duration_days,
        actual_duration_days,

        -- Label / target variables
        delay_vs_plan_days,
        is_late,
        is_completed
    from joined
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_ml_features_orders"} */;
[0m14:57:25.966169 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:57:29.235715 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.267 seconds
[0m14:57:29.265950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '589c1eca-2303-40ab-8cb6-d7d965444772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2F38A510>]}
[0m14:57:29.265950 [info ] [Thread-1 (]: 1 of 1 OK created sql table model ANALYTICS_analytics.mfg_ml_features_orders ... [[32mSUCCESS 1[0m in 3.34s]
[0m14:57:29.265950 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.mfg_ml_features_orders
[0m14:57:29.265950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:57:29.265950 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR' was left open.
[0m14:57:29.265950 [debug] [MainThread]: On list_MFG_ACCELERATOR: Close
[0m14:57:29.800944 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics' was left open.
[0m14:57:29.800944 [debug] [MainThread]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: Close
[0m14:57:30.246118 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_ml_features_orders' was left open.
[0m14:57:30.246118 [debug] [MainThread]: On model.mfg_accelerator.mfg_ml_features_orders: Close
[0m14:57:30.716308 [info ] [MainThread]: 
[0m14:57:30.718665 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.98 seconds (7.98s).
[0m14:57:30.720404 [debug] [MainThread]: Command end result
[0m14:57:30.752600 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m14:57:30.755887 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m14:57:30.766628 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\run_results.json
[0m14:57:30.766628 [info ] [MainThread]: 
[0m14:57:30.766628 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:57:30.766628 [info ] [MainThread]: 
[0m14:57:30.766628 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:57:30.766628 [debug] [MainThread]: Command `dbt run` succeeded at 14:57:30.766628 after 16.56 seconds
[0m14:57:30.766628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E322485C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E31BE6900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E3216B170>]}
[0m14:57:30.773202 [debug] [MainThread]: Flushing usage events
[0m14:57:31.815989 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:58:27.145420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206BE9DBBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206BE81D970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206BC8AA1B0>]}


============================== 14:58:27.145420 | 5b6e5ba4-2c85-4291-92f8-dec9592ab906 ==============================
[0m14:58:27.145420 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:58:27.151748 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt test --select marts', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\sanofi-accelerator-mfg-data-platform\\dbt_project\\logs'}
[0m14:58:27.895457 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:58:27.895457 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:58:27.895457 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:58:28.105562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b6e5ba4-2c85-4291-92f8-dec9592ab906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206D3F5ED80>]}
[0m14:58:28.175826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b6e5ba4-2c85-4291-92f8-dec9592ab906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206D2ACC5F0>]}
[0m14:58:28.175826 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m14:58:28.625851 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:58:28.775533 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:58:28.775533 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:58:28.825894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b6e5ba4-2c85-4291-92f8-dec9592ab906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206D42C7A70>]}
[0m14:58:28.920963 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m14:58:28.922711 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m14:58:29.035624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b6e5ba4-2c85-4291-92f8-dec9592ab906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206D41B7950>]}
[0m14:58:29.035624 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m14:58:29.035624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b6e5ba4-2c85-4291-92f8-dec9592ab906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206D42355E0>]}
[0m14:58:29.039955 [info ] [MainThread]: 
[0m14:58:29.039955 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:58:29.039955 [info ] [MainThread]: 
[0m14:58:29.039955 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:58:29.045816 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m14:58:29.165702 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m14:58:29.165702 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m14:58:29.165702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:30.745819 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.580 seconds
[0m14:58:30.745819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b6e5ba4-2c85-4291-92f8-dec9592ab906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206D40C3C20>]}
[0m14:58:30.755753 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:58:30.755753 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:58:30.755753 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:58:30.755753 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:58:30.755753 [info ] [Thread-1 (]: 1 of 4 START test not_null_mfg_ml_features_orders_order_id ..................... [RUN]
[0m14:58:30.755753 [info ] [Thread-2 (]: 2 of 4 START test not_null_mfg_plant_daily_kpis_calendar_date .................. [RUN]
[0m14:58:30.755753 [info ] [Thread-3 (]: 3 of 4 START test not_null_mfg_plant_daily_kpis_manufacturing_site ............. [RUN]
[0m14:58:30.761656 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213'
[0m14:58:30.755753 [info ] [Thread-4 (]: 4 of 4 START test unique_mfg_ml_features_orders_order_id ....................... [RUN]
[0m14:58:30.761656 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8'
[0m14:58:30.761656 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68'
[0m14:58:30.761656 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:58:30.761656 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd'
[0m14:58:30.766072 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:58:30.766072 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:58:30.785755 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m14:58:30.785755 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:58:30.794473 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m14:58:30.796057 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m14:58:30.808107 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m14:58:30.809659 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:58:30.842006 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:58:30.843042 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m14:58:30.845698 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m14:58:30.845698 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:58:30.845698 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:58:30.850200 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m14:58:30.855828 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m14:58:30.855828 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m14:58:30.855828 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m14:58:30.858436 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"} */
[0m14:58:30.859968 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m14:58:30.859968 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select calendar_date
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where calendar_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"} */
[0m14:58:30.859968 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m14:58:30.862811 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:58:30.863442 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturing_site
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where manufacturing_site is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"} */
[0m14:58:30.863442 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:58:30.863442 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"} */
[0m14:58:30.865951 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:58:30.865951 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:58:32.565875 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c0f546-0107-4035-0013-40ff0010d142
[0m14:58:32.571144 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'MFG_ACCELERATOR.ANALYTICS_ANALYTICS.MFG_PLANT_DAILY_KPIS' does not exist or not authorized.
[0m14:58:32.571144 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c0f546-0107-4035-0013-40ff0010d13e
[0m14:58:32.575552 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'MFG_ACCELERATOR.ANALYTICS_ANALYTICS.MFG_PLANT_DAILY_KPIS' does not exist or not authorized.
[0m14:58:32.595508 [debug] [Thread-3 (]: Database Error in test not_null_mfg_plant_daily_kpis_manufacturing_site (models\marts\marts_schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'MFG_ACCELERATOR.ANALYTICS_ANALYTICS.MFG_PLANT_DAILY_KPIS' does not exist or not authorized.
  compiled code at target\run\mfg_accelerator\models\marts\marts_schema.yml\not_null_mfg_plant_daily_kpis_manufacturing_site.sql
[0m14:58:32.595508 [debug] [Thread-2 (]: Database Error in test not_null_mfg_plant_daily_kpis_calendar_date (models\marts\marts_schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'MFG_ACCELERATOR.ANALYTICS_ANALYTICS.MFG_PLANT_DAILY_KPIS' does not exist or not authorized.
  compiled code at target\run\mfg_accelerator\models\marts\marts_schema.yml\not_null_mfg_plant_daily_kpis_calendar_date.sql
[0m14:58:32.595508 [error] [Thread-3 (]: 3 of 4 ERROR not_null_mfg_plant_daily_kpis_manufacturing_site .................. [[31mERROR[0m in 1.83s]
[0m14:58:32.595508 [error] [Thread-2 (]: 2 of 4 ERROR not_null_mfg_plant_daily_kpis_calendar_date ....................... [[31mERROR[0m in 1.83s]
[0m14:58:32.595508 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:58:32.595508 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:58:32.605399 [debug] [Thread-7 (]: Marking all children of 'test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68' to be skipped because of status 'error'.  Reason: Database Error in test not_null_mfg_plant_daily_kpis_manufacturing_site (models\marts\marts_schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'MFG_ACCELERATOR.ANALYTICS_ANALYTICS.MFG_PLANT_DAILY_KPIS' does not exist or not authorized.
  compiled code at target\run\mfg_accelerator\models\marts\marts_schema.yml\not_null_mfg_plant_daily_kpis_manufacturing_site.sql.
[0m14:58:32.605399 [debug] [Thread-7 (]: Marking all children of 'test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8' to be skipped because of status 'error'.  Reason: Database Error in test not_null_mfg_plant_daily_kpis_calendar_date (models\marts\marts_schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'MFG_ACCELERATOR.ANALYTICS_ANALYTICS.MFG_PLANT_DAILY_KPIS' does not exist or not authorized.
  compiled code at target\run\mfg_accelerator\models\marts\marts_schema.yml\not_null_mfg_plant_daily_kpis_calendar_date.sql.
[0m14:58:33.093510 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.221 seconds
[0m14:58:33.102236 [info ] [Thread-4 (]: 4 of 4 PASS unique_mfg_ml_features_orders_order_id ............................. [[32mPASS[0m in 2.34s]
[0m14:58:33.102236 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.242 seconds
[0m14:58:33.105967 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:58:33.108081 [info ] [Thread-1 (]: 1 of 4 PASS not_null_mfg_ml_features_orders_order_id ........................... [[32mPASS[0m in 2.35s]
[0m14:58:33.108081 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:58:33.110736 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:58:33.110736 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics' was left open.
[0m14:58:33.110736 [debug] [MainThread]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: Close
[0m14:58:33.592702 [debug] [MainThread]: Connection 'test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213' was left open.
[0m14:58:33.592702 [debug] [MainThread]: On test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213: Close
[0m14:58:34.065928 [debug] [MainThread]: Connection 'test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8' was left open.
[0m14:58:34.065928 [debug] [MainThread]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8: Close
[0m14:58:34.516007 [debug] [MainThread]: Connection 'test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68' was left open.
[0m14:58:34.516007 [debug] [MainThread]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68: Close
[0m14:58:34.969990 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd' was left open.
[0m14:58:34.969990 [debug] [MainThread]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: Close
[0m14:58:35.415638 [info ] [MainThread]: 
[0m14:58:35.415638 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 6.38 seconds (6.38s).
[0m14:58:35.415638 [debug] [MainThread]: Command end result
[0m14:58:35.447645 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m14:58:35.447645 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m14:58:35.465867 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\run_results.json
[0m14:58:35.465867 [info ] [MainThread]: 
[0m14:58:35.465867 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m14:58:35.465867 [info ] [MainThread]: 
[0m14:58:35.465867 [error] [MainThread]: [31mFailure in test not_null_mfg_plant_daily_kpis_manufacturing_site (models\marts\marts_schema.yml)[0m
[0m14:58:35.465867 [error] [MainThread]:   Database Error in test not_null_mfg_plant_daily_kpis_manufacturing_site (models\marts\marts_schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'MFG_ACCELERATOR.ANALYTICS_ANALYTICS.MFG_PLANT_DAILY_KPIS' does not exist or not authorized.
  compiled code at target\run\mfg_accelerator\models\marts\marts_schema.yml\not_null_mfg_plant_daily_kpis_manufacturing_site.sql
[0m14:58:35.465867 [info ] [MainThread]: 
[0m14:58:35.471901 [info ] [MainThread]:   compiled code at target\compiled\mfg_accelerator\models\marts\marts_schema.yml\not_null_mfg_plant_daily_kpis_manufacturing_site.sql
[0m14:58:35.473419 [info ] [MainThread]: 
[0m14:58:35.473419 [error] [MainThread]: [31mFailure in test not_null_mfg_plant_daily_kpis_calendar_date (models\marts\marts_schema.yml)[0m
[0m14:58:35.473419 [error] [MainThread]:   Database Error in test not_null_mfg_plant_daily_kpis_calendar_date (models\marts\marts_schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'MFG_ACCELERATOR.ANALYTICS_ANALYTICS.MFG_PLANT_DAILY_KPIS' does not exist or not authorized.
  compiled code at target\run\mfg_accelerator\models\marts\marts_schema.yml\not_null_mfg_plant_daily_kpis_calendar_date.sql
[0m14:58:35.475928 [info ] [MainThread]: 
[0m14:58:35.475928 [info ] [MainThread]:   compiled code at target\compiled\mfg_accelerator\models\marts\marts_schema.yml\not_null_mfg_plant_daily_kpis_calendar_date.sql
[0m14:58:35.475928 [info ] [MainThread]: 
[0m14:58:35.480144 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=4
[0m14:58:35.480144 [debug] [MainThread]: Command `dbt test` failed at 14:58:35.480144 after 8.49 seconds
[0m14:58:35.483399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206BE5C59A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206BF8D1DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206BEDB1F70>]}
[0m14:58:35.483399 [debug] [MainThread]: Flushing usage events
[0m14:58:36.406457 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:59:39.935281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5D7F2BBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5D83DBFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5D83DA570>]}


============================== 14:59:39.942477 | a069c169-33a1-4247-9b12-20c1dbe41459 ==============================
[0m14:59:39.942477 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:59:39.942477 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'invocation_command': 'dbt run --select marts', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\sanofi-accelerator-mfg-data-platform\\dbt_project\\logs'}
[0m14:59:40.705581 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:59:40.705581 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:59:40.705581 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:59:40.925336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a069c169-33a1-4247-9b12-20c1dbe41459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5D6094080>]}
[0m14:59:40.995498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a069c169-33a1-4247-9b12-20c1dbe41459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5D8A25D60>]}
[0m14:59:40.995498 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m14:59:41.475438 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:59:41.635494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:59:41.635494 [debug] [MainThread]: Partial parsing: updated file: mfg_accelerator://models\marts\mfg_plant_daily_kpis.sql
[0m14:59:42.143080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a069c169-33a1-4247-9b12-20c1dbe41459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5ED744CE0>]}
[0m14:59:42.235610 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m14:59:42.237673 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m14:59:42.259595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a069c169-33a1-4247-9b12-20c1dbe41459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5ED7C7260>]}
[0m14:59:42.261603 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m14:59:42.261603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a069c169-33a1-4247-9b12-20c1dbe41459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5EDA8DBE0>]}
[0m14:59:42.261603 [info ] [MainThread]: 
[0m14:59:42.265374 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:59:42.265374 [info ] [MainThread]: 
[0m14:59:42.265374 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:59:42.273079 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m14:59:42.385212 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m14:59:42.385212 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m14:59:42.385212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:44.181329 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.797 seconds
[0m14:59:44.185930 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m14:59:44.200668 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m14:59:44.200668 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m14:59:44.200668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:45.585610 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.383 seconds
[0m14:59:45.585610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a069c169-33a1-4247-9b12-20c1dbe41459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5ED746CC0>]}
[0m14:59:45.591994 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.mfg_ml_features_orders
[0m14:59:45.591994 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:59:45.591994 [info ] [Thread-1 (]: 1 of 2 START sql table model ANALYTICS_analytics.mfg_ml_features_orders ........ [RUN]
[0m14:59:45.596246 [info ] [Thread-2 (]: 2 of 2 START sql table model ANALYTICS_analytics.mfg_plant_daily_kpis .......... [RUN]
[0m14:59:45.596246 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mfg_accelerator.mfg_ml_features_orders'
[0m14:59:45.596246 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.mfg_plant_daily_kpis'
[0m14:59:45.596246 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.mfg_ml_features_orders
[0m14:59:45.596246 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:59:45.607750 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:59:45.612108 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:59:45.615515 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.mfg_ml_features_orders
[0m14:59:45.625889 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:59:45.655738 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:59:45.655738 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:59:45.661057 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:59:45.661057 [debug] [Thread-1 (]: On model.mfg_accelerator.mfg_ml_features_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
    
    
    
    as (-- mfg_ml_features_orders.sql
-- Purpose:
--  - Provide ML-ready features at order grain
--  - Target use case: predict late orders or delay vs plan
-- Grain:
--  - One row per production order (order_id)

with orders as (

    select
        order_id,
        batch_id,
        material_id,

        manufacturing_site,
        line_id,

        order_type,
        order_status,

        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,

        planned_duration_days,
        actual_duration_days,
        delay_vs_plan_days,
        is_late,
        is_completed
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders

),

materials as (

    select
        material_id,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

batches as (

    select
        batch_id,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches

),

joined as (

    select
        o.order_id,

        -- Keys and IDs
        o.batch_id,
        o.material_id,

        -- Plant / line / type
        o.manufacturing_site,
        o.line_id,
        o.order_type,
        o.order_status,

        -- Material features
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        -- Batch features
        b.quantity,
        b.batch_status,
        b.shelf_life_days,
        b.batch_age_days,
        b.days_to_expiry,
        b.is_expired,

        -- Temporal features
        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        o.planned_duration_days,
        o.actual_duration_days,
        o.delay_vs_plan_days,

        -- Labels / targets
        o.is_late,
        o.is_completed
    from orders o
    left join materials m
        on o.material_id = m.material_id
    left join batches b
        on o.batch_id = b.batch_id

),

final as (

    select
        -- Primary key
        order_id,

        -- Categorical features
        manufacturing_site,
        line_id,
        order_type,
        order_status,
        material_type,
        unit_of_measure,
        batch_status,

        -- Material state
        is_active_material,

        -- Quantitative batch features
        quantity,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired,

        -- Temporal planning features
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        planned_duration_days,
        actual_duration_days,

        -- Label / target variables
        delay_vs_plan_days,
        is_late,
        is_completed
    from joined
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_ml_features_orders"} */;
[0m14:59:45.665670 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:59:45.665670 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:59:45.665670 [debug] [Thread-2 (]: On model.mfg_accelerator.mfg_plant_daily_kpis: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
    
    
    
    as (-- mfg_plant_daily_kpis.sql
-- Purpose:
--  - Provide daily plant-level KPIs for manufacturing performance monitoring
--  - Aggregates metrics from core_batches and fct_production_orders
-- Grain:
--  - One row per (manufacturing_site, calendar_date)

with calendar_days as (

    -- Build a simple date spine based on manufacture_date and planned/actual dates
    -- This ensures we have a consistent daily grain for metrics.

    select
        -- Use the earliest relevant date from batches and orders
        least(
            min(b.manufacture_date),
            min(o.planned_start_date)
        ) as min_date,
        greatest(
            max(b.manufacture_date),
            max(o.planned_end_date)
        ) as max_date
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    cross join MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o

),

date_spine as (

    -- Generate a list of dates between min_date and max_date
    -- Snowflake-specific generator using TABLE(GENERATOR)
    select
        dateadd(
            day,
            seq4(),
            min_date
        ) as calendar_date
    from calendar_days,
         table(generator(rowcount => datediff('day', min_date, max_date) + 1))

),

batches_by_day as (

    -- Aggregate batch metrics at (manufacturing_site, calendar_date)
    select
        b.manufacturing_site,
        b.manufacture_date as calendar_date,

        count(*) as total_batches,
        sum(b.quantity) as total_quantity,

        sum(case when b.is_expired = 1 then 1 else 0 end) as expired_batches
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    group by
        b.manufacturing_site,
        b.manufacture_date

),

orders_by_day as (

    -- Aggregate order metrics at (manufacturing_site, calendar_date)
    -- We'll use planned_start_date as the main "date" for the order
    select
        b.manufacturing_site,
        o.planned_start_date as calendar_date,

        count(*) as total_orders,
        sum(case when o.is_completed = 1 then 1 else 0 end) as completed_orders,
        sum(case when o.is_late = 1 then 1 else 0 end) as late_orders,

        avg(o.delay_vs_plan_days) as avg_delay_vs_plan_days
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o
    left join MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
        on o.batch_id = b.batch_id
    group by
        b.manufacturing_site,
        o.planned_start_date

),

combined as (

    -- Combine batch and order metrics on (site, date)
    select
        coalesce(b.manufacturing_site, o.manufacturing_site) as manufacturing_site,
        coalesce(b.calendar_date, o.calendar_date) as calendar_date,

        -- Batch metrics
        coalesce(b.total_batches, 0) as total_batches,
        coalesce(b.total_quantity, 0) as total_quantity,
        coalesce(b.expired_batches, 0) as expired_batches,

        -- Order metrics
        coalesce(o.total_orders, 0) as total_orders,
        coalesce(o.completed_orders, 0) as completed_orders,
        coalesce(o.late_orders, 0) as late_orders,
        o.avg_delay_vs_plan_days as avg_delay_vs_plan_days
    from batches_by_day b
    full outer join orders_by_day o
        on  b.manufacturing_site = o.manufacturing_site
        and b.calendar_date = o.calendar_date

),

final as (

    select
        manufacturing_site,
        calendar_date,

        total_batches,
        total_quantity,
        expired_batches,

        total_orders,
        completed_orders,
        late_orders,
        avg_delay_vs_plan_days,

        -- On-time rate: percentage of completed orders that were not late
        case
            when completed_orders > 0 then
                1.0 - (late_orders::float / completed_orders::float)
            else null
        end as on_time_rate
    from combined
    where manufacturing_site is not null
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_plant_daily_kpis"} */;
[0m14:59:45.665670 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:59:48.786122 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.121 seconds
[0m14:59:48.813327 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a069c169-33a1-4247-9b12-20c1dbe41459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5D5EFA570>]}
[0m14:59:48.813327 [info ] [Thread-2 (]: 2 of 2 OK created sql table model ANALYTICS_analytics.mfg_plant_daily_kpis ..... [[32mSUCCESS 1[0m in 3.22s]
[0m14:59:48.815836 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:59:48.894252 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.225 seconds
[0m14:59:48.900463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a069c169-33a1-4247-9b12-20c1dbe41459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5EE3902C0>]}
[0m14:59:48.900463 [info ] [Thread-1 (]: 1 of 2 OK created sql table model ANALYTICS_analytics.mfg_ml_features_orders ... [[32mSUCCESS 1[0m in 3.30s]
[0m14:59:48.900463 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.mfg_ml_features_orders
[0m14:59:48.900463 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:59:48.900463 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR' was left open.
[0m14:59:48.900463 [debug] [MainThread]: On list_MFG_ACCELERATOR: Close
[0m14:59:49.345880 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics' was left open.
[0m14:59:49.345880 [debug] [MainThread]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: Close
[0m14:59:49.772747 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_ml_features_orders' was left open.
[0m14:59:49.772747 [debug] [MainThread]: On model.mfg_accelerator.mfg_ml_features_orders: Close
[0m14:59:50.216045 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_plant_daily_kpis' was left open.
[0m14:59:50.216045 [debug] [MainThread]: On model.mfg_accelerator.mfg_plant_daily_kpis: Close
[0m14:59:50.700011 [info ] [MainThread]: 
[0m14:59:50.700011 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 8.43 seconds (8.43s).
[0m14:59:50.700011 [debug] [MainThread]: Command end result
[0m14:59:50.736678 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m14:59:50.736678 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m14:59:50.745980 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\run_results.json
[0m14:59:50.745980 [info ] [MainThread]: 
[0m14:59:50.745980 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:59:50.745980 [info ] [MainThread]: 
[0m14:59:50.745980 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m14:59:50.745980 [debug] [MainThread]: Command `dbt run` succeeded at 14:59:50.745980 after 10.98 seconds
[0m14:59:50.745980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5D5D98710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5EDD67CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5EDCA8560>]}
[0m14:59:50.745980 [debug] [MainThread]: Flushing usage events
[0m14:59:51.802192 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:00:06.455422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C2671EB40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C277CFC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C27152ED0>]}


============================== 15:00:06.455422 | da30ca4a-6c21-49c8-9798-54a7cddf3a33 ==============================
[0m15:00:06.455422 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:00:06.455422 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt test --select marts', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\sanofi-accelerator-mfg-data-platform\\dbt_project\\logs'}
[0m15:00:07.202716 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:00:07.202716 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:00:07.202716 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:00:07.405507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da30ca4a-6c21-49c8-9798-54a7cddf3a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3A37ED80>]}
[0m15:00:07.470439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da30ca4a-6c21-49c8-9798-54a7cddf3a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C26B072C0>]}
[0m15:00:07.475473 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m15:00:07.925115 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:00:08.103386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:00:08.103386 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:00:08.161353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da30ca4a-6c21-49c8-9798-54a7cddf3a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C396FC050>]}
[0m15:00:08.265500 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m15:00:08.267559 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m15:00:08.352899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da30ca4a-6c21-49c8-9798-54a7cddf3a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3BEB5B80>]}
[0m15:00:08.352899 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m15:00:08.355405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da30ca4a-6c21-49c8-9798-54a7cddf3a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3BF7A7B0>]}
[0m15:00:08.355405 [info ] [MainThread]: 
[0m15:00:08.355405 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:00:08.355405 [info ] [MainThread]: 
[0m15:00:08.355405 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:00:08.365495 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m15:00:08.475269 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m15:00:08.475269 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m15:00:08.482998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:10.728301 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.246 seconds
[0m15:00:10.728301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da30ca4a-6c21-49c8-9798-54a7cddf3a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3BED8980>]}
[0m15:00:10.735806 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m15:00:10.735806 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m15:00:10.735806 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m15:00:10.735806 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m15:00:10.735806 [info ] [Thread-1 (]: 1 of 4 START test not_null_mfg_ml_features_orders_order_id ..................... [RUN]
[0m15:00:10.735806 [info ] [Thread-2 (]: 2 of 4 START test not_null_mfg_plant_daily_kpis_calendar_date .................. [RUN]
[0m15:00:10.735806 [info ] [Thread-3 (]: 3 of 4 START test not_null_mfg_plant_daily_kpis_manufacturing_site ............. [RUN]
[0m15:00:10.735806 [info ] [Thread-4 (]: 4 of 4 START test unique_mfg_ml_features_orders_order_id ....................... [RUN]
[0m15:00:10.735806 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213'
[0m15:00:10.735806 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8'
[0m15:00:10.744184 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68'
[0m15:00:10.744184 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd'
[0m15:00:10.745691 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m15:00:10.745691 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m15:00:10.745691 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m15:00:10.745691 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m15:00:10.768227 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m15:00:10.768227 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m15:00:10.776646 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m15:00:10.785592 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m15:00:10.785592 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m15:00:10.785592 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m15:00:10.794280 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m15:00:10.815469 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m15:00:10.815469 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m15:00:10.818541 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m15:00:10.823414 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m15:00:10.826189 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m15:00:10.827840 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m15:00:10.827840 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m15:00:10.827840 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m15:00:10.827840 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"} */
[0m15:00:10.833512 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m15:00:10.834550 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select calendar_date
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where calendar_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"} */
[0m15:00:10.835557 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturing_site
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where manufacturing_site is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"} */
[0m15:00:10.836101 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:00:10.836725 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"} */
[0m15:00:10.836725 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:00:10.836725 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:00:10.836725 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:00:12.578418 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.743 seconds
[0m15:00:12.585558 [info ] [Thread-1 (]: 1 of 4 PASS not_null_mfg_ml_features_orders_order_id ........................... [[32mPASS[0m in 1.85s]
[0m15:00:12.585558 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m15:00:12.945428 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.109 seconds
[0m15:00:12.947843 [info ] [Thread-2 (]: 2 of 4 PASS not_null_mfg_plant_daily_kpis_calendar_date ........................ [[32mPASS[0m in 2.21s]
[0m15:00:12.947843 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m15:00:13.304659 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.467 seconds
[0m15:00:13.305692 [info ] [Thread-3 (]: 3 of 4 PASS not_null_mfg_plant_daily_kpis_manufacturing_site ................... [[32mPASS[0m in 2.56s]
[0m15:00:13.305692 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m15:00:13.416303 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.579 seconds
[0m15:00:13.416303 [info ] [Thread-4 (]: 4 of 4 PASS unique_mfg_ml_features_orders_order_id ............................. [[32mPASS[0m in 2.67s]
[0m15:00:13.416303 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m15:00:13.416303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:00:13.416303 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics' was left open.
[0m15:00:13.416303 [debug] [MainThread]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: Close
[0m15:00:13.865548 [debug] [MainThread]: Connection 'test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213' was left open.
[0m15:00:13.865548 [debug] [MainThread]: On test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213: Close
[0m15:00:14.407871 [debug] [MainThread]: Connection 'test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8' was left open.
[0m15:00:14.407871 [debug] [MainThread]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8: Close
[0m15:00:14.956922 [debug] [MainThread]: Connection 'test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68' was left open.
[0m15:00:14.956922 [debug] [MainThread]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68: Close
[0m15:00:15.445649 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd' was left open.
[0m15:00:15.445649 [debug] [MainThread]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: Close
[0m15:00:15.966881 [info ] [MainThread]: 
[0m15:00:15.966881 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 7.61 seconds (7.61s).
[0m15:00:15.966881 [debug] [MainThread]: Command end result
[0m15:00:15.995733 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m15:00:16.005353 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m15:00:16.013309 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\run_results.json
[0m15:00:16.015361 [info ] [MainThread]: 
[0m15:00:16.015361 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:00:16.015361 [info ] [MainThread]: 
[0m15:00:16.015361 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m15:00:16.015361 [debug] [MainThread]: Command `dbt test` succeeded at 15:00:16.015361 after 9.70 seconds
[0m15:00:16.015361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C27152E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C27152ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C27151130>]}
[0m15:00:16.015361 [debug] [MainThread]: Flushing usage events
[0m15:00:16.875351 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:04:13.310485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77431d8e0b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77431f88b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77431d8e0e30>]}


============================== 11:04:13.319685 | 99c65b28-f95f-4881-9baf-558cc8ed1283 ==============================
[0m11:04:13.319685 [info ] [MainThread]: Running with dbt=1.10.15
[0m11:04:13.321614 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'debug': 'False', 'use_colors': 'True', 'write_json': 'True', 'printer_width': '80', 'fail_fast': 'False', 'partial_parse': 'True', 'log_format': 'default', 'quiet': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'no_print': 'None', 'target_path': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles'}
[0m11:04:14.116570 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:04:14.118094 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:04:14.119467 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:04:14.195131 [error] [MainThread]:  adapter: Invalid profile: 'user' is a required property.
[0m11:04:14.388966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99c65b28-f95f-4881-9baf-558cc8ed1283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7742fbaf6c90>]}
[0m11:04:14.468933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99c65b28-f95f-4881-9baf-558cc8ed1283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77431db02060>]}
[0m11:04:14.471103 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m11:04:14.649734 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m11:04:14.817353 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:04:14.818952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '99c65b28-f95f-4881-9baf-558cc8ed1283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77431c1e4b00>]}
[0m11:04:16.507220 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m11:04:16.509394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '99c65b28-f95f-4881-9baf-558cc8ed1283', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7742fb6b9040>]}
[0m11:04:16.849311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99c65b28-f95f-4881-9baf-558cc8ed1283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7742fa20ecc0>]}
[0m11:04:16.996731 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m11:04:17.003000 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m11:04:17.042844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99c65b28-f95f-4881-9baf-558cc8ed1283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7742fa2ee2a0>]}
[0m11:04:17.044609 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m11:04:17.046031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99c65b28-f95f-4881-9baf-558cc8ed1283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7742fa40a990>]}
[0m11:04:17.049341 [info ] [MainThread]: 
[0m11:04:17.050686 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:04:17.052152 [info ] [MainThread]: 
[0m11:04:17.053827 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:04:17.061747 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_'
[0m11:04:17.110106 [debug] [ThreadPool]: Using snowflake connection "list_"
[0m11:04:17.111642 [debug] [ThreadPool]: On list_: show terse schemas in database 
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_"} */
[0m11:04:17.112964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:17.117376 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: show terse schemas in database 
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_"} */
[0m11:04:17.118684 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:04:17.120091 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m11:04:17.121307 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:04:17.124006 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:04:17.126162 [debug] [MainThread]: Connection 'list_' was left open.
[0m11:04:17.127832 [debug] [MainThread]: On list_: No close available on handle
[0m11:04:17.129218 [info ] [MainThread]: 
[0m11:04:17.130588 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.08 seconds (0.08s).
[0m11:04:17.132073 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database ""
  Database Error
    251005: User is empty, but it must be provided unless authenticator is one of PAT_WITH_EXTERNAL_SESSION, NO_AUTH, OAUTH, PROGRAMMATIC_ACCESS_TOKEN, WORKLOAD_IDENTITY.
[0m11:04:17.133686 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:04:17.135844 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.921848, "process_in_blocks": "3344", "process_kernel_time": 1.352746, "process_mem_max_rss": "214452", "process_out_blocks": "1256", "process_user_time": 5.803201}
[0m11:04:17.137484 [debug] [MainThread]: Command `dbt run` failed at 11:04:17.137339 after 3.92 seconds
[0m11:04:17.139018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77431d8af9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7742fb6170b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7742fa356720>]}
[0m11:04:17.141868 [debug] [MainThread]: Flushing usage events
[0m11:04:17.878739 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:09:22.459142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7578c3fcde20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7578c3157a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7578c2e54230>]}


============================== 11:09:22.467051 | d12cadb8-944f-4f34-9ebf-59d29321527e ==============================
[0m11:09:22.467051 [info ] [MainThread]: Running with dbt=1.10.15
[0m11:09:22.468660 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'quiet': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'static_parser': 'True', 'introspect': 'True', 'version_check': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'printer_width': '80', 'invocation_command': 'dbt run', 'partial_parse': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'empty': 'False', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'log_cache_events': 'False', 'log_format': 'default', 'use_colors': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m11:09:23.291247 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:09:23.293339 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:09:23.295567 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:09:23.361829 [error] [MainThread]:  adapter: Invalid profile: 'user' is a required property.
[0m11:09:23.507641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd12cadb8-944f-4f34-9ebf-59d29321527e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7578c31a1ee0>]}
[0m11:09:23.580552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd12cadb8-944f-4f34-9ebf-59d29321527e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7578a7520800>]}
[0m11:09:23.583250 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m11:09:23.740070 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m11:09:24.016875 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:09:24.018902 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:09:24.089503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd12cadb8-944f-4f34-9ebf-59d29321527e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7578a51e0680>]}
[0m11:09:24.257125 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m11:09:24.266767 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m11:09:24.305535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd12cadb8-944f-4f34-9ebf-59d29321527e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7578a47ab080>]}
[0m11:09:24.306953 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m11:09:24.308451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd12cadb8-944f-4f34-9ebf-59d29321527e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7578a47503b0>]}
[0m11:09:24.314460 [info ] [MainThread]: 
[0m11:09:24.316586 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:09:24.318175 [info ] [MainThread]: 
[0m11:09:24.319721 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:09:24.325525 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_'
[0m11:09:24.375547 [debug] [ThreadPool]: Using snowflake connection "list_"
[0m11:09:24.377785 [debug] [ThreadPool]: On list_: show terse schemas in database 
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_"} */
[0m11:09:24.379503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:24.384136 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: show terse schemas in database 
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_"} */
[0m11:09:24.385517 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:09:24.386931 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m11:09:24.388342 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:09:24.390297 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:09:24.391572 [debug] [MainThread]: Connection 'list_' was left open.
[0m11:09:24.393022 [debug] [MainThread]: On list_: No close available on handle
[0m11:09:24.394347 [info ] [MainThread]: 
[0m11:09:24.395919 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m11:09:24.397516 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database ""
  Database Error
    251005: User is empty, but it must be provided unless authenticator is one of PROGRAMMATIC_ACCESS_TOKEN, NO_AUTH, WORKLOAD_IDENTITY, OAUTH, PAT_WITH_EXTERNAL_SESSION.
[0m11:09:24.399484 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.024958, "process_in_blocks": "0", "process_kernel_time": 1.280511, "process_mem_max_rss": "206984", "process_out_blocks": "0", "process_user_time": 3.961209}
[0m11:09:24.401066 [debug] [MainThread]: Command `dbt run` failed at 11:09:24.400930 after 2.03 seconds
[0m11:09:24.402402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7578c1df03b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7578a4bc14c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7578a478a300>]}
[0m11:09:24.403620 [debug] [MainThread]: Flushing usage events
[0m11:09:25.037072 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:46:15.920415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa6c289e150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa6c275cfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa6c403bad0>]}


============================== 11:46:15.928612 | d55e198a-50b3-4559-a813-acb712a48d20 ==============================
[0m11:46:15.928612 [info ] [MainThread]: Running with dbt=1.10.15
[0m11:46:15.930397 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'debug': 'False', 'use_colors': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'fail_fast': 'False', 'introspect': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt_profiles', 'quiet': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'no_print': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'write_json': 'True'}
[0m11:46:16.648224 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:46:16.649801 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:46:16.651208 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:46:16.714130 [error] [MainThread]:  adapter: Invalid profile: 'user' is a required property.
[0m11:46:16.865683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd55e198a-50b3-4559-a813-acb712a48d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa6a4400980>]}
[0m11:46:16.937234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd55e198a-50b3-4559-a813-acb712a48d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa6a41b3dd0>]}
[0m11:46:16.939345 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m11:46:17.095016 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m11:46:17.349547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:46:17.351003 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:46:17.400648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd55e198a-50b3-4559-a813-acb712a48d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa6a4164320>]}
[0m11:46:17.526322 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m11:46:17.534166 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m11:46:17.567667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd55e198a-50b3-4559-a813-acb712a48d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa69fc9b320>]}
[0m11:46:17.569145 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m11:46:17.570375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd55e198a-50b3-4559-a813-acb712a48d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa6a4145340>]}
[0m11:46:17.573674 [info ] [MainThread]: 
[0m11:46:17.575034 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:46:17.576623 [info ] [MainThread]: 
[0m11:46:17.578783 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:46:17.585346 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_'
[0m11:46:17.632030 [debug] [ThreadPool]: Using snowflake connection "list_"
[0m11:46:17.633463 [debug] [ThreadPool]: On list_: show terse schemas in database 
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_"} */
[0m11:46:17.634724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:17.639650 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: show terse schemas in database 
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_"} */
[0m11:46:17.641724 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:46:17.643677 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m11:46:17.645312 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:46:17.647692 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:17.649146 [debug] [MainThread]: Connection 'list_' was left open.
[0m11:46:17.650559 [debug] [MainThread]: On list_: No close available on handle
[0m11:46:17.651752 [info ] [MainThread]: 
[0m11:46:17.653093 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m11:46:17.654573 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database ""
  Database Error
    251005: User is empty, but it must be provided unless authenticator is one of PROGRAMMATIC_ACCESS_TOKEN, WORKLOAD_IDENTITY, PAT_WITH_EXTERNAL_SESSION, NO_AUTH, OAUTH.
[0m11:46:17.656561 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8203367, "process_in_blocks": "0", "process_kernel_time": 1.196564, "process_mem_max_rss": "207184", "process_out_blocks": "0", "process_user_time": 3.597669}
[0m11:46:17.658268 [debug] [MainThread]: Command `dbt run` failed at 11:46:17.658087 after 1.82 seconds
[0m11:46:17.659628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa6c1355c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa69f035490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa69ff0b830>]}
[0m11:46:17.661220 [debug] [MainThread]: Flushing usage events
[0m11:46:18.309745 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:51:22.361270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7931194b7920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7931181a8110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793118da7ec0>]}


============================== 11:51:22.370708 | 4fde6060-611f-4bd6-a135-3f40e775ac57 ==============================
[0m11:51:22.370708 [info ] [MainThread]: Running with dbt=1.10.15
[0m11:51:22.372337 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'no_print': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'debug': 'False', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'write_json': 'True', 'printer_width': '80', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt_profiles', 'target_path': 'None', 'quiet': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'empty': 'False'}
[0m11:51:23.109008 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:51:23.110727 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:51:23.112184 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:51:23.175118 [error] [MainThread]:  adapter: Invalid profile: 'user' is a required property.
[0m11:51:23.327304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fde6060-611f-4bd6-a135-3f40e775ac57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7930f6d024e0>]}
[0m11:51:23.402491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fde6060-611f-4bd6-a135-3f40e775ac57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793117dea780>]}
[0m11:51:23.404444 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m11:51:23.571150 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m11:51:23.854736 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:51:23.856274 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:51:23.915228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fde6060-611f-4bd6-a135-3f40e775ac57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793117f62b10>]}
[0m11:51:24.045843 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m11:51:24.054067 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m11:51:24.087850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fde6060-611f-4bd6-a135-3f40e775ac57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7930f6a23d70>]}
[0m11:51:24.089341 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m11:51:24.090739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fde6060-611f-4bd6-a135-3f40e775ac57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7930f6e89340>]}
[0m11:51:24.093965 [info ] [MainThread]: 
[0m11:51:24.095516 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:51:24.097062 [info ] [MainThread]: 
[0m11:51:24.099024 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:51:24.105115 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_'
[0m11:51:24.154141 [debug] [ThreadPool]: Using snowflake connection "list_"
[0m11:51:24.155667 [debug] [ThreadPool]: On list_: show terse schemas in database 
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_"} */
[0m11:51:24.157063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:24.161716 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: show terse schemas in database 
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_"} */
[0m11:51:24.163391 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:51:24.165431 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m11:51:24.166872 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:51:24.168842 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:24.170086 [debug] [MainThread]: Connection 'list_' was left open.
[0m11:51:24.171401 [debug] [MainThread]: On list_: No close available on handle
[0m11:51:24.172651 [info ] [MainThread]: 
[0m11:51:24.174087 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m11:51:24.175685 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database ""
  Database Error
    251005: User is empty, but it must be provided unless authenticator is one of OAUTH, PAT_WITH_EXTERNAL_SESSION, WORKLOAD_IDENTITY, PROGRAMMATIC_ACCESS_TOKEN, NO_AUTH.
[0m11:51:24.177717 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9125297, "process_in_blocks": "0", "process_kernel_time": 1.238331, "process_mem_max_rss": "206896", "process_out_blocks": "0", "process_user_time": 3.826843}
[0m11:51:24.179360 [debug] [MainThread]: Command `dbt run` failed at 11:51:24.179187 after 1.91 seconds
[0m11:51:24.180952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793117f5e4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7931194b7830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7930f5d595e0>]}
[0m11:51:24.182555 [debug] [MainThread]: Flushing usage events
[0m11:51:24.848234 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:16:20.392296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726153c53d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7261523a9ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726151f5e240>]}


============================== 12:16:20.400602 | 4d251e0e-6df9-4282-abcd-a41e0b434799 ==============================
[0m12:16:20.400602 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:16:20.402313 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt_profiles', 'version_check': 'True', 'target_path': 'None', 'profiles_dir': '/opt/airflow/dbt_profiles', 'use_colors': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'quiet': 'False', 'write_json': 'True', 'no_print': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'static_parser': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager'}
[0m12:16:21.113907 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:16:21.115579 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:16:21.116952 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:16:21.187269 [error] [MainThread]:  adapter: Invalid profile: 'user' is a required property.
[0m12:16:21.330009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d251e0e-6df9-4282-abcd-a41e0b434799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72613790a540>]}
[0m12:16:21.398618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d251e0e-6df9-4282-abcd-a41e0b434799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72612ffb6b10>]}
[0m12:16:21.400647 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m12:16:21.557529 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:16:21.841883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:16:21.843613 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:16:21.905184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d251e0e-6df9-4282-abcd-a41e0b434799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72612ff7f320>]}
[0m12:16:22.055384 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m12:16:22.063185 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m12:16:22.096509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d251e0e-6df9-4282-abcd-a41e0b434799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72612f803e30>]}
[0m12:16:22.097912 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m12:16:22.099121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d251e0e-6df9-4282-abcd-a41e0b434799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72612f9dae10>]}
[0m12:16:22.102374 [info ] [MainThread]: 
[0m12:16:22.103739 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:16:22.104935 [info ] [MainThread]: 
[0m12:16:22.106484 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:16:22.112719 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_'
[0m12:16:22.155282 [debug] [ThreadPool]: Using snowflake connection "list_"
[0m12:16:22.157243 [debug] [ThreadPool]: On list_: show terse schemas in database 
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_"} */
[0m12:16:22.159193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:22.164127 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: show terse schemas in database 
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_"} */
[0m12:16:22.165449 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m12:16:22.166867 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m12:16:22.168048 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m12:16:22.169925 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:22.171194 [debug] [MainThread]: Connection 'list_' was left open.
[0m12:16:22.172490 [debug] [MainThread]: On list_: No close available on handle
[0m12:16:22.174567 [info ] [MainThread]: 
[0m12:16:22.177426 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m12:16:22.180979 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database ""
  Database Error
    251005: User is empty, but it must be provided unless authenticator is one of NO_AUTH, OAUTH, PAT_WITH_EXTERNAL_SESSION, WORKLOAD_IDENTITY, PROGRAMMATIC_ACCESS_TOKEN.
[0m12:16:22.185499 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.877425, "process_in_blocks": "0", "process_kernel_time": 1.188332, "process_mem_max_rss": "207400", "process_out_blocks": "1256", "process_user_time": 3.600887}
[0m12:16:22.188261 [debug] [MainThread]: Command `dbt run` failed at 12:16:22.187983 after 1.88 seconds
[0m12:16:22.190375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7261511a9220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72612fa44290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72612f803c50>]}
[0m12:16:22.192547 [debug] [MainThread]: Flushing usage events
[0m12:16:22.996365 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:21:26.839495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dc8cdea20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dc7e65a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dc952c6b0>]}


============================== 12:21:26.847616 | 48c3318d-4df3-4b24-a95d-23e3d589c7ec ==============================
[0m12:21:26.847616 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:21:26.849365 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'profiles_dir': '/opt/airflow/dbt_profiles', 'log_format': 'default', 'indirect_selection': 'eager', 'write_json': 'True', 'printer_width': '80', 'empty': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'quiet': 'False', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt_profiles'}
[0m12:21:27.566590 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:21:27.568344 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:21:27.570123 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:21:27.632638 [error] [MainThread]:  adapter: Invalid profile: 'user' is a required property.
[0m12:21:27.787924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48c3318d-4df3-4b24-a95d-23e3d589c7ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dc77b2270>]}
[0m12:21:27.867355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48c3318d-4df3-4b24-a95d-23e3d589c7ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736da6a3d3d0>]}
[0m12:21:27.869230 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m12:21:28.028068 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:21:28.287506 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:21:28.289276 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:21:28.341358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48c3318d-4df3-4b24-a95d-23e3d589c7ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dc7996d20>]}
[0m12:21:28.472095 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m12:21:28.478497 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m12:21:28.511182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48c3318d-4df3-4b24-a95d-23e3d589c7ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736da6356450>]}
[0m12:21:28.513476 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m12:21:28.515164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48c3318d-4df3-4b24-a95d-23e3d589c7ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736da63288c0>]}
[0m12:21:28.518783 [info ] [MainThread]: 
[0m12:21:28.520189 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:21:28.521454 [info ] [MainThread]: 
[0m12:21:28.522979 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:21:28.528992 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_'
[0m12:21:28.574207 [debug] [ThreadPool]: Using snowflake connection "list_"
[0m12:21:28.575820 [debug] [ThreadPool]: On list_: show terse schemas in database 
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_"} */
[0m12:21:28.577178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:28.581489 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: show terse schemas in database 
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_"} */
[0m12:21:28.582981 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m12:21:28.584474 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m12:21:28.585749 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m12:21:28.587682 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:21:28.589157 [debug] [MainThread]: Connection 'list_' was left open.
[0m12:21:28.590641 [debug] [MainThread]: On list_: No close available on handle
[0m12:21:28.591881 [info ] [MainThread]: 
[0m12:21:28.593236 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m12:21:28.594701 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database ""
  Database Error
    251005: User is empty, but it must be provided unless authenticator is one of PROGRAMMATIC_ACCESS_TOKEN, PAT_WITH_EXTERNAL_SESSION, WORKLOAD_IDENTITY, NO_AUTH, OAUTH.
[0m12:21:28.596545 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8508052, "process_in_blocks": "0", "process_kernel_time": 1.203511, "process_mem_max_rss": "207220", "process_out_blocks": "0", "process_user_time": 3.802456}
[0m12:21:28.598027 [debug] [MainThread]: Command `dbt run` failed at 12:21:28.597890 after 1.85 seconds
[0m12:21:28.599386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dc7af45c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736da6357fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736da61f8710>]}
[0m12:21:28.600743 [debug] [MainThread]: Flushing usage events
[0m12:21:29.398707 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:57:04.714627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739a12873b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739a12e7bce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739a10f36660>]}


============================== 12:57:04.725125 | 18f15b79-eb7e-4a3d-953d-8c71f98a41bb ==============================
[0m12:57:04.725125 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:57:04.727136 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'static_parser': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'target_path': 'None', 'warn_error': 'None', 'write_json': 'True', 'log_format': 'default', 'empty': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt_profiles', 'quiet': 'False', 'use_colors': 'True', 'introspect': 'True', 'printer_width': '80', 'fail_fast': 'False', 'partial_parse': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'version_check': 'True', 'log_cache_events': 'False'}
[0m12:57:05.514687 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:57:05.516476 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:57:05.518145 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:57:05.742729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18f15b79-eb7e-4a3d-953d-8c71f98a41bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739a115fe2a0>]}
[0m12:57:05.819088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18f15b79-eb7e-4a3d-953d-8c71f98a41bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739a12b6e8d0>]}
[0m12:57:05.820951 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m12:57:06.006669 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:57:06.151481 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:57:06.154045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '18f15b79-eb7e-4a3d-953d-8c71f98a41bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739a10e91370>]}
[0m12:57:07.785478 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m12:57:07.787428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '18f15b79-eb7e-4a3d-953d-8c71f98a41bb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399edab53d0>]}
[0m12:57:08.106690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18f15b79-eb7e-4a3d-953d-8c71f98a41bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399ed89de50>]}
[0m12:57:08.241325 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m12:57:08.249188 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m12:57:08.283549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18f15b79-eb7e-4a3d-953d-8c71f98a41bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399ed8d0680>]}
[0m12:57:08.284899 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m12:57:08.286243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18f15b79-eb7e-4a3d-953d-8c71f98a41bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399eed8b950>]}
[0m12:57:08.289618 [info ] [MainThread]: 
[0m12:57:08.290851 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:57:08.292123 [info ] [MainThread]: 
[0m12:57:08.293807 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:57:08.300617 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m12:57:08.346282 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m12:57:08.348273 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m12:57:08.349634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:09.869747 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.520 seconds
[0m12:57:09.874383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR, now list_MFG_ACCELERATOR_ANALYTICS_analytics)
[0m12:57:09.890214 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m12:57:09.891972 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m12:57:10.295469 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.402 seconds
[0m12:57:10.301111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18f15b79-eb7e-4a3d-953d-8c71f98a41bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399eec7bb30>]}
[0m12:57:10.309336 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.stg_batches
[0m12:57:10.310010 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.stg_materials
[0m12:57:10.310592 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.stg_production_orders
[0m12:57:10.312584 [info ] [Thread-1 (]: 1 of 8 START sql view model ANALYTICS_analytics.stg_batches .................... [RUN]
[0m12:57:10.314609 [info ] [Thread-2 (]: 2 of 8 START sql view model ANALYTICS_analytics.stg_materials .................. [RUN]
[0m12:57:10.316500 [info ] [Thread-3 (]: 3 of 8 START sql view model ANALYTICS_analytics.stg_production_orders .......... [RUN]
[0m12:57:10.318021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now model.mfg_accelerator.stg_batches)
[0m12:57:10.319694 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_materials'
[0m12:57:10.321205 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_production_orders'
[0m12:57:10.322545 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.stg_batches
[0m12:57:10.323958 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.stg_materials
[0m12:57:10.325304 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.stg_production_orders
[0m12:57:10.335590 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.stg_batches"
[0m12:57:10.340579 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.stg_materials"
[0m12:57:10.344427 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.stg_production_orders"
[0m12:57:10.353303 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.stg_batches
[0m12:57:10.354190 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.stg_materials
[0m12:57:10.361167 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.stg_production_orders
[0m12:57:10.404849 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.stg_batches"
[0m12:57:10.415819 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.stg_materials"
[0m12:57:10.419071 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.stg_production_orders"
[0m12:57:10.428900 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.stg_batches"
[0m12:57:10.431262 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.stg_materials"
[0m12:57:10.432801 [debug] [Thread-1 (]: On model.mfg_accelerator.stg_batches: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
  
  
  
  
  as (
    -- stg_batches.sql
-- Purpose:
--  - Clean and standardize batch data
--  - Ensure dates and numeric types are correct

with source as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.RAW.batches

),

renamed as (

    select
        batch_id                         as batch_id,
        material_id                      as material_id,
        manufacturing_site               as manufacturing_site,
        cast(manufacture_date as date)   as manufacture_date,
        cast(expiry_date as date)        as expiry_date,
        cast(quantity as number)         as quantity,
        batch_status                     as batch_status
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_batches"} */;
[0m12:57:10.435305 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.stg_production_orders"
[0m12:57:10.435872 [debug] [Thread-2 (]: On model.mfg_accelerator.stg_materials: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
  
  
  
  
  as (
    -- stg_materials.sql
-- Purpose:
--  - Create a clean, standardized view of materials
--  - Apply basic typing and naming conventions
--  - This is the first "T" step after RAW

with source as (

    -- Pull data from the RAW.MATERIALS table registered as a source
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        status,
        created_at
    from MFG_ACCELERATOR.RAW.materials

),

renamed as (

    -- Apply any renaming / typing here
    select
        material_id                as material_id,        -- keep same, but explicitly select
        material_name              as material_name,
        material_type              as material_type,
        unit_of_measure            as unit_of_measure,
        status                     as material_status,    -- rename to avoid generic 'status'
        cast(created_at as date)   as created_at
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_materials"} */;
[0m12:57:10.439361 [debug] [Thread-3 (]: On model.mfg_accelerator.stg_production_orders: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
  
  
  
  
  as (
    -- stg_production_orders.sql
-- Purpose:
--  - Clean and standardize production order data
--  - Ensure date fields and statuses are typed and named consistently

with source as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.RAW.production_orders

),

renamed as (

    select
        order_id                               as order_id,
        batch_id                               as batch_id,
        order_type                             as order_type,
        cast(planned_start_date as date)       as planned_start_date,
        cast(planned_end_date as date)         as planned_end_date,
        cast(actual_start_date as date)        as actual_start_date,
        cast(actual_end_date as date)          as actual_end_date,
        order_status                           as order_status,
        line_id                                as line_id
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_production_orders"} */;
[0m12:57:10.441574 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:57:10.443258 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:57:10.904419 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.467 seconds
[0m12:57:10.935395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18f15b79-eb7e-4a3d-953d-8c71f98a41bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739a12b6a540>]}
[0m12:57:10.937309 [info ] [Thread-1 (]: 1 of 8 OK created sql view model ANALYTICS_analytics.stg_batches ............... [[32mSUCCESS 1[0m in 0.62s]
[0m12:57:10.938941 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.stg_batches
[0m12:57:11.913661 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.470 seconds
[0m12:57:11.919775 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18f15b79-eb7e-4a3d-953d-8c71f98a41bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399c5706f30>]}
[0m12:57:11.921989 [info ] [Thread-3 (]: 3 of 8 OK created sql view model ANALYTICS_analytics.stg_production_orders ..... [[32mSUCCESS 1[0m in 1.60s]
[0m12:57:11.923983 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.stg_production_orders
[0m12:57:11.943626 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.502 seconds
[0m12:57:11.949020 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18f15b79-eb7e-4a3d-953d-8c71f98a41bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399ec9d37a0>]}
[0m12:57:11.950924 [info ] [Thread-2 (]: 2 of 8 OK created sql view model ANALYTICS_analytics.stg_materials ............. [[32mSUCCESS 1[0m in 1.63s]
[0m12:57:11.952747 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.stg_materials
[0m12:57:11.955027 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.core_materials
[0m12:57:11.956743 [info ] [Thread-4 (]: 4 of 8 START sql table model ANALYTICS_analytics.core_materials ................ [RUN]
[0m12:57:11.958574 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.mfg_accelerator.core_materials'
[0m12:57:11.960079 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.core_materials
[0m12:57:11.965729 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.core_materials"
[0m12:57:11.976055 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.core_materials
[0m12:57:12.006509 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.core_materials"
[0m12:57:12.020432 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.core_materials"
[0m12:57:12.021939 [debug] [Thread-4 (]: On model.mfg_accelerator.core_materials: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
    
    
    
    as (-- core_materials.sql
-- Purpose:
--  - Create a cleaned, enriched material dimension
--  - Add simple derived attributes (e.g. is_active flag, age)

with base as (

    -- Use the staging view as the single source of truth for materials
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,
        created_at
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials

),

enriched as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,

        created_at,

        -- Age of the material definition in days
        datediff('day', created_at, current_date()) as material_age_days,

        -- Simple flag to say if the material is considered active
        case
            when upper(material_status) = 'ACTIVE' then 1
            else 0
        end as is_active_material
    from base

)

select * from enriched
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_materials"} */;
[0m12:57:12.023162 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:57:14.652140 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.629 seconds
[0m12:57:14.656024 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18f15b79-eb7e-4a3d-953d-8c71f98a41bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399c57b5460>]}
[0m12:57:14.657825 [info ] [Thread-4 (]: 4 of 8 OK created sql table model ANALYTICS_analytics.core_materials ........... [[32mSUCCESS 1[0m in 2.70s]
[0m12:57:14.659893 [debug] [Thread-4 (]: Finished running node model.mfg_accelerator.core_materials
[0m12:57:14.662203 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.core_batches
[0m12:57:14.663689 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.fct_production_orders
[0m12:57:14.665148 [info ] [Thread-3 (]: 5 of 8 START sql table model ANALYTICS_analytics.core_batches .................. [RUN]
[0m12:57:14.666905 [info ] [Thread-2 (]: 6 of 8 START sql table model ANALYTICS_analytics.fct_production_orders ......... [RUN]
[0m12:57:14.668565 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_production_orders, now model.mfg_accelerator.core_batches)
[0m12:57:14.670319 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_materials, now model.mfg_accelerator.fct_production_orders)
[0m12:57:14.671897 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.core_batches
[0m12:57:14.673213 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.fct_production_orders
[0m12:57:14.677512 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.core_batches"
[0m12:57:14.683334 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.fct_production_orders"
[0m12:57:14.694313 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.core_batches
[0m12:57:14.696249 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.fct_production_orders
[0m12:57:14.701997 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.core_batches"
[0m12:57:14.707296 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.fct_production_orders"
[0m12:57:14.720130 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.core_batches"
[0m12:57:14.722229 [debug] [Thread-3 (]: On model.mfg_accelerator.core_batches: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    
    
    
    as (-- core_batches.sql
-- Purpose:
--  - Combine batch info with material attributes
--  - Add shelf-life and expiry-related metrics

with batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        b.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        -- Shelf life in days = expiry - manufacture
        datediff('day', manufacture_date, expiry_date) as shelf_life_days,

        -- Batch age in days from manufacture date until today
        datediff('day', manufacture_date, current_date()) as batch_age_days,

        -- Days until expiry (can be negative if already expired)
        datediff('day', current_date(), expiry_date) as days_to_expiry,

        case
            when current_date() > expiry_date then 1
            else 0
        end as is_expired
    from batches b
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_batches"} */;
[0m12:57:14.726653 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.fct_production_orders"
[0m12:57:14.731037 [debug] [Thread-2 (]: On model.mfg_accelerator.fct_production_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    
    
    
    as (-- fct_production_orders.sql
-- Purpose:
--  - Fact-like table combining production orders with batch and material context
--  - Compute planned vs actual durations and simple on-time indicators

with orders as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders

),

batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        o.order_id,
        o.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        o.order_type,
        o.line_id,
        o.order_status,

        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        -- Planned duration in days
        datediff('day', planned_start_date, planned_end_date) as planned_duration_days,

        -- Actual duration in days (null if no end date)
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', actual_start_date, actual_end_date)
            else null
        end as actual_duration_days,

        -- Delay vs plan: how many days longer the actual duration was
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', planned_end_date, actual_end_date)
            else null
        end as delay_vs_plan_days,

        -- Simple late flag: 1 if order completed after planned_end_date
        case
            when actual_end_date is not null
             and actual_end_date > planned_end_date
            then 1
            else 0
        end as is_late,

        -- Is the order completed?
        case
            when upper(order_status) = 'COMPLETED' then 1
            else 0
        end as is_completed
    from orders o
    left join batches b
        on o.batch_id = b.batch_id
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.fct_production_orders"} */;
[0m12:57:18.542656 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.814 seconds
[0m12:57:18.547109 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18f15b79-eb7e-4a3d-953d-8c71f98a41bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399c57089b0>]}
[0m12:57:18.549301 [info ] [Thread-3 (]: 5 of 8 OK created sql table model ANALYTICS_analytics.core_batches ............. [[32mSUCCESS 1[0m in 3.88s]
[0m12:57:18.551041 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.core_batches
[0m12:57:31.117924 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 16.389 seconds
[0m12:57:31.121733 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18f15b79-eb7e-4a3d-953d-8c71f98a41bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399c5709a00>]}
[0m12:57:31.123539 [info ] [Thread-2 (]: 6 of 8 OK created sql table model ANALYTICS_analytics.fct_production_orders .... [[32mSUCCESS 1[0m in 16.45s]
[0m12:57:31.125453 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.fct_production_orders
[0m12:57:31.127994 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.mfg_ml_features_orders
[0m12:57:31.128794 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m12:57:31.130279 [info ] [Thread-4 (]: 7 of 8 START sql table model ANALYTICS_analytics.mfg_ml_features_orders ........ [RUN]
[0m12:57:31.132102 [info ] [Thread-1 (]: 8 of 8 START sql table model ANALYTICS_analytics.mfg_plant_daily_kpis .......... [RUN]
[0m12:57:31.133543 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.core_materials, now model.mfg_accelerator.mfg_ml_features_orders)
[0m12:57:31.135071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_batches, now model.mfg_accelerator.mfg_plant_daily_kpis)
[0m12:57:31.136245 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.mfg_ml_features_orders
[0m12:57:31.137680 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.mfg_plant_daily_kpis
[0m12:57:31.142412 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m12:57:31.148817 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m12:57:31.156452 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.mfg_ml_features_orders
[0m12:57:31.161708 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m12:57:31.162486 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.mfg_plant_daily_kpis
[0m12:57:31.169729 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m12:57:31.179004 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.mfg_ml_features_orders"
[0m12:57:31.181147 [debug] [Thread-4 (]: On model.mfg_accelerator.mfg_ml_features_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
    
    
    
    as (-- mfg_ml_features_orders.sql
-- Purpose:
--  - Provide ML-ready features at order grain
--  - Target use case: predict late orders or delay vs plan
-- Grain:
--  - One row per production order (order_id)

with orders as (

    select
        order_id,
        batch_id,
        material_id,

        manufacturing_site,
        line_id,

        order_type,
        order_status,

        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,

        planned_duration_days,
        actual_duration_days,
        delay_vs_plan_days,
        is_late,
        is_completed
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders

),

materials as (

    select
        material_id,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

batches as (

    select
        batch_id,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches

),

joined as (

    select
        o.order_id,

        -- Keys and IDs
        o.batch_id,
        o.material_id,

        -- Plant / line / type
        o.manufacturing_site,
        o.line_id,
        o.order_type,
        o.order_status,

        -- Material features
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        -- Batch features
        b.quantity,
        b.batch_status,
        b.shelf_life_days,
        b.batch_age_days,
        b.days_to_expiry,
        b.is_expired,

        -- Temporal features
        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        o.planned_duration_days,
        o.actual_duration_days,
        o.delay_vs_plan_days,

        -- Labels / targets
        o.is_late,
        o.is_completed
    from orders o
    left join materials m
        on o.material_id = m.material_id
    left join batches b
        on o.batch_id = b.batch_id

),

final as (

    select
        -- Primary key
        order_id,

        -- Categorical features
        manufacturing_site,
        line_id,
        order_type,
        order_status,
        material_type,
        unit_of_measure,
        batch_status,

        -- Material state
        is_active_material,

        -- Quantitative batch features
        quantity,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired,

        -- Temporal planning features
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        planned_duration_days,
        actual_duration_days,

        -- Label / target variables
        delay_vs_plan_days,
        is_late,
        is_completed
    from joined
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_ml_features_orders"} */;
[0m12:57:31.185810 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m12:57:31.188975 [debug] [Thread-1 (]: On model.mfg_accelerator.mfg_plant_daily_kpis: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
    
    
    
    as (-- mfg_plant_daily_kpis.sql
-- Purpose:
--  - Provide daily plant-level KPIs for manufacturing performance monitoring
--  - Aggregates metrics from core_batches and fct_production_orders
-- Grain:
--  - One row per (manufacturing_site, calendar_date)

with calendar_days as (

    -- Build a simple date spine based on manufacture_date and planned/actual dates
    -- This ensures we have a consistent daily grain for metrics.

    select
        -- Use the earliest relevant date from batches and orders
        least(
            min(b.manufacture_date),
            min(o.planned_start_date)
        ) as min_date,
        greatest(
            max(b.manufacture_date),
            max(o.planned_end_date)
        ) as max_date
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    cross join MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o

),

date_spine as (

    -- Generate a list of dates between min_date and max_date
    -- Snowflake-specific generator using TABLE(GENERATOR)
    select
        dateadd(
            day,
            seq4(),
            min_date
        ) as calendar_date
    from calendar_days,
         table(generator(rowcount => datediff('day', min_date, max_date) + 1))

),

batches_by_day as (

    -- Aggregate batch metrics at (manufacturing_site, calendar_date)
    select
        b.manufacturing_site,
        b.manufacture_date as calendar_date,

        count(*) as total_batches,
        sum(b.quantity) as total_quantity,

        sum(case when b.is_expired = 1 then 1 else 0 end) as expired_batches
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    group by
        b.manufacturing_site,
        b.manufacture_date

),

orders_by_day as (

    -- Aggregate order metrics at (manufacturing_site, calendar_date)
    -- We'll use planned_start_date as the main "date" for the order
    select
        b.manufacturing_site,
        o.planned_start_date as calendar_date,

        count(*) as total_orders,
        sum(case when o.is_completed = 1 then 1 else 0 end) as completed_orders,
        sum(case when o.is_late = 1 then 1 else 0 end) as late_orders,

        avg(o.delay_vs_plan_days) as avg_delay_vs_plan_days
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o
    left join MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
        on o.batch_id = b.batch_id
    group by
        b.manufacturing_site,
        o.planned_start_date

),

combined as (

    -- Combine batch and order metrics on (site, date)
    select
        coalesce(b.manufacturing_site, o.manufacturing_site) as manufacturing_site,
        coalesce(b.calendar_date, o.calendar_date) as calendar_date,

        -- Batch metrics
        coalesce(b.total_batches, 0) as total_batches,
        coalesce(b.total_quantity, 0) as total_quantity,
        coalesce(b.expired_batches, 0) as expired_batches,

        -- Order metrics
        coalesce(o.total_orders, 0) as total_orders,
        coalesce(o.completed_orders, 0) as completed_orders,
        coalesce(o.late_orders, 0) as late_orders,
        o.avg_delay_vs_plan_days as avg_delay_vs_plan_days
    from batches_by_day b
    full outer join orders_by_day o
        on  b.manufacturing_site = o.manufacturing_site
        and b.calendar_date = o.calendar_date

),

final as (

    select
        manufacturing_site,
        calendar_date,

        total_batches,
        total_quantity,
        expired_batches,

        total_orders,
        completed_orders,
        late_orders,
        avg_delay_vs_plan_days,

        -- On-time rate: percentage of completed orders that were not late
        case
            when completed_orders > 0 then
                1.0 - (late_orders::float / completed_orders::float)
            else null
        end as on_time_rate
    from combined
    where manufacturing_site is not null
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_plant_daily_kpis"} */;
[0m12:57:37.264491 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 6.074 seconds
[0m12:57:37.269153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18f15b79-eb7e-4a3d-953d-8c71f98a41bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399ec99bc80>]}
[0m12:57:37.271287 [info ] [Thread-1 (]: 8 of 8 OK created sql table model ANALYTICS_analytics.mfg_plant_daily_kpis ..... [[32mSUCCESS 1[0m in 6.13s]
[0m12:57:37.273319 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m13:07:34.904773 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 603.789 seconds
[0m13:07:34.909274 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18f15b79-eb7e-4a3d-953d-8c71f98a41bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399c57e79b0>]}
[0m13:07:34.911001 [info ] [Thread-4 (]: 7 of 8 OK created sql table model ANALYTICS_analytics.mfg_ml_features_orders ... [[32mSUCCESS 1[0m in 603.78s]
[0m13:07:34.912743 [debug] [Thread-4 (]: Finished running node model.mfg_accelerator.mfg_ml_features_orders
[0m13:07:34.916300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:07:34.917903 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_plant_daily_kpis' was left open.
[0m13:07:34.919640 [debug] [MainThread]: On model.mfg_accelerator.mfg_plant_daily_kpis: Close
[0m13:07:35.983212 [debug] [MainThread]: Connection 'model.mfg_accelerator.fct_production_orders' was left open.
[0m13:07:35.984651 [debug] [MainThread]: On model.mfg_accelerator.fct_production_orders: Close
[0m13:07:36.931741 [debug] [MainThread]: Connection 'model.mfg_accelerator.core_batches' was left open.
[0m13:07:36.933509 [debug] [MainThread]: On model.mfg_accelerator.core_batches: Close
[0m13:07:37.837702 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_ml_features_orders' was left open.
[0m13:07:37.839418 [debug] [MainThread]: On model.mfg_accelerator.mfg_ml_features_orders: Close
[0m13:07:38.267979 [info ] [MainThread]: 
[0m13:07:38.270283 [info ] [MainThread]: Finished running 5 table models, 3 view models in 0 hours 10 minutes and 29.97 seconds (629.97s).
[0m13:07:38.273959 [debug] [MainThread]: Command end result
[0m13:07:38.336456 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m13:07:38.345019 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m13:07:38.359878 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m13:07:38.361112 [info ] [MainThread]: 
[0m13:07:38.362341 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:07:38.363642 [info ] [MainThread]: 
[0m13:07:38.364956 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m13:07:38.366641 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:07:38.369445 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 633.82385, "process_in_blocks": "40", "process_kernel_time": 1.367591, "process_mem_max_rss": "229744", "process_out_blocks": "1272", "process_user_time": 6.610024}
[0m13:07:38.371618 [debug] [MainThread]: Command `dbt run` succeeded at 13:07:38.371353 after 633.83 seconds
[0m13:07:38.373315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739a115807a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739a10f36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739a1067e510>]}
[0m13:07:38.374739 [debug] [MainThread]: Flushing usage events
[0m13:07:39.185075 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:07:43.133624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c255a26e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c255b6c8740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c255a15aa50>]}


============================== 13:07:43.143030 | ac2db550-cf85-46bb-82df-eee00583579d ==============================
[0m13:07:43.143030 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:07:43.144484 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'static_parser': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'write_json': 'True', 'version_check': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt_profiles', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/opt/airflow/dbt_project/logs', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m13:07:43.909306 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m13:07:43.910927 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m13:07:43.912354 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m13:07:44.150736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac2db550-cf85-46bb-82df-eee00583579d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c253e562300>]}
[0m13:07:44.231759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac2db550-cf85-46bb-82df-eee00583579d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2559d0deb0>]}
[0m13:07:44.233993 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m13:07:44.408741 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m13:07:44.689276 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:07:44.690960 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:07:44.745403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac2db550-cf85-46bb-82df-eee00583579d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2537bce8d0>]}
[0m13:07:44.880760 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m13:07:44.888406 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m13:07:44.932153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac2db550-cf85-46bb-82df-eee00583579d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2537630140>]}
[0m13:07:44.933807 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m13:07:44.935159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac2db550-cf85-46bb-82df-eee00583579d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2537621f40>]}
[0m13:07:44.940942 [info ] [MainThread]: 
[0m13:07:44.942894 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:07:44.944304 [info ] [MainThread]: 
[0m13:07:44.945943 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:07:44.952446 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m13:07:45.007989 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m13:07:45.009634 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m13:07:45.011038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:07:46.623815 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.613 seconds
[0m13:07:46.629071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac2db550-cf85-46bb-82df-eee00583579d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c255b2a14c0>]}
[0m13:07:46.636295 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m13:07:46.637275 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m13:07:46.638304 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m13:07:46.639124 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m13:07:46.640271 [info ] [Thread-1 (]: 1 of 24 START test not_null_core_batches_batch_id .............................. [RUN]
[0m13:07:46.641893 [info ] [Thread-2 (]: 2 of 24 START test not_null_core_batches_material_id ........................... [RUN]
[0m13:07:46.643639 [info ] [Thread-3 (]: 3 of 24 START test not_null_core_materials_material_id ......................... [RUN]
[0m13:07:46.645198 [info ] [Thread-4 (]: 4 of 24 START test not_null_fct_production_orders_batch_id ..................... [RUN]
[0m13:07:46.647009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c)
[0m13:07:46.648569 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e'
[0m13:07:46.650096 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8'
[0m13:07:46.651707 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1'
[0m13:07:46.653279 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m13:07:46.655538 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m13:07:46.657175 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m13:07:46.658690 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m13:07:46.679458 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m13:07:46.684099 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m13:07:46.691258 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m13:07:46.696483 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m13:07:46.707664 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m13:07:46.708539 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m13:07:46.709546 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m13:07:46.721936 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m13:07:46.745112 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m13:07:46.747370 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m13:07:46.751678 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m13:07:46.756376 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m13:07:46.765536 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m13:07:46.767004 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m13:07:46.768392 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"} */
[0m13:07:46.769897 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m13:07:46.772000 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m13:07:46.773496 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"} */
[0m13:07:46.775050 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:07:46.776594 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"} */
[0m13:07:46.777849 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"} */
[0m13:07:46.779098 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:07:46.788294 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:07:47.105939 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.315 seconds
[0m13:07:47.116734 [info ] [Thread-1 (]: 1 of 24 PASS not_null_core_batches_batch_id .................................... [[32mPASS[0m in 0.47s]
[0m13:07:47.118513 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m13:07:47.120429 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m13:07:47.123068 [info ] [Thread-1 (]: 5 of 24 START test not_null_fct_production_orders_order_id ..................... [RUN]
[0m13:07:47.124851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c, now test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f)
[0m13:07:47.126387 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m13:07:47.131566 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m13:07:47.144955 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m13:07:47.149026 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m13:07:47.162237 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m13:07:47.163609 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"} */
[0m13:07:47.674356 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.510 seconds
[0m13:07:47.678422 [info ] [Thread-1 (]: 5 of 24 PASS not_null_fct_production_orders_order_id ........................... [[32mPASS[0m in 0.55s]
[0m13:07:47.680333 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m13:07:47.682083 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m13:07:47.683720 [info ] [Thread-1 (]: 6 of 24 START test not_null_mfg_ml_features_orders_order_id .................... [RUN]
[0m13:07:47.685394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f, now test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213)
[0m13:07:47.686905 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m13:07:47.692923 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m13:07:47.705543 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m13:07:47.709431 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m13:07:47.722743 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m13:07:47.724232 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"} */
[0m13:07:48.178770 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.391 seconds
[0m13:07:48.182159 [info ] [Thread-3 (]: 3 of 24 PASS not_null_core_materials_material_id ............................... [[32mPASS[0m in 1.53s]
[0m13:07:48.184170 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m13:07:48.185941 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.407 seconds
[0m13:07:48.187470 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m13:07:48.191917 [info ] [Thread-2 (]: 2 of 24 PASS not_null_core_batches_material_id ................................. [[32mPASS[0m in 1.54s]
[0m13:07:48.193138 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.468 seconds
[0m13:07:48.194816 [info ] [Thread-3 (]: 7 of 24 START test not_null_mfg_plant_daily_kpis_calendar_date ................. [RUN]
[0m13:07:48.196601 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m13:07:48.199747 [info ] [Thread-1 (]: 6 of 24 PASS not_null_mfg_ml_features_orders_order_id .......................... [[32mPASS[0m in 0.51s]
[0m13:07:48.201451 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8)
[0m13:07:48.203061 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m13:07:48.205378 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m13:07:48.207125 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m13:07:48.208582 [info ] [Thread-2 (]: 8 of 24 START test not_null_mfg_plant_daily_kpis_manufacturing_site ............ [RUN]
[0m13:07:48.210329 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m13:07:48.215799 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m13:07:48.217443 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68)
[0m13:07:48.218868 [info ] [Thread-1 (]: 9 of 24 START test not_null_stg_batches_batch_id ............................... [RUN]
[0m13:07:48.222263 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m13:07:48.224106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213, now test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0)
[0m13:07:48.229840 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m13:07:48.231470 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m13:07:48.242063 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m13:07:48.243984 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m13:07:48.249532 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m13:07:48.250280 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m13:07:48.257109 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m13:07:48.260570 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m13:07:48.265527 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m13:07:48.268396 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m13:07:48.269854 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m13:07:48.271787 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturing_site
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where manufacturing_site is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"} */
[0m13:07:48.273632 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select calendar_date
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where calendar_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"} */
[0m13:07:48.280573 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m13:07:48.282455 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"} */
[0m13:07:48.291157 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.516 seconds
[0m13:07:48.294789 [info ] [Thread-4 (]: 4 of 24 PASS not_null_fct_production_orders_batch_id ........................... [[32mPASS[0m in 1.64s]
[0m13:07:48.296500 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m13:07:48.297988 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m13:07:48.299400 [info ] [Thread-4 (]: 10 of 24 START test not_null_stg_batches_material_id ........................... [RUN]
[0m13:07:48.300953 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1, now test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c)
[0m13:07:48.302323 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m13:07:48.308783 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m13:07:48.320941 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m13:07:48.325486 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m13:07:48.338533 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m13:07:48.340172 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"} */
[0m13:07:48.677896 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.336 seconds
[0m13:07:48.681895 [info ] [Thread-4 (]: 10 of 24 PASS not_null_stg_batches_material_id ................................. [[32mPASS[0m in 0.38s]
[0m13:07:48.683933 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m13:07:48.685745 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m13:07:48.687928 [info ] [Thread-4 (]: 11 of 24 START test not_null_stg_materials_material_id ......................... [RUN]
[0m13:07:48.690251 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c, now test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89)
[0m13:07:48.691980 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m13:07:48.698548 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m13:07:48.714098 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m13:07:48.719274 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m13:07:48.733581 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m13:07:48.735212 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"} */
[0m13:07:48.922659 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.639 seconds
[0m13:07:48.927329 [info ] [Thread-1 (]: 9 of 24 PASS not_null_stg_batches_batch_id ..................................... [[32mPASS[0m in 0.70s]
[0m13:07:48.929776 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m13:07:48.931616 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m13:07:48.933370 [info ] [Thread-1 (]: 12 of 24 START test not_null_stg_production_orders_batch_id .................... [RUN]
[0m13:07:48.935317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0, now test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5)
[0m13:07:48.937220 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m13:07:48.944086 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m13:07:48.962557 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m13:07:48.974936 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m13:07:48.990936 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m13:07:48.992310 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"} */
[0m13:07:49.073131 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.336 seconds
[0m13:07:49.076709 [info ] [Thread-4 (]: 11 of 24 PASS not_null_stg_materials_material_id ............................... [[32mPASS[0m in 0.39s]
[0m13:07:49.078526 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m13:07:49.080028 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m13:07:49.081497 [info ] [Thread-4 (]: 13 of 24 START test not_null_stg_production_orders_order_id .................... [RUN]
[0m13:07:49.083185 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89, now test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284)
[0m13:07:49.084583 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m13:07:49.090846 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m13:07:49.103871 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m13:07:49.109973 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m13:07:49.125923 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m13:07:49.127322 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"} */
[0m13:07:49.325012 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.050 seconds
[0m13:07:49.330077 [info ] [Thread-2 (]: 8 of 24 PASS not_null_mfg_plant_daily_kpis_manufacturing_site .................. [[32mPASS[0m in 1.11s]
[0m13:07:49.332461 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m13:07:49.334469 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m13:07:49.336444 [info ] [Thread-2 (]: 14 of 24 START test relationships_core_batches_material_id__material_id__ref_core_materials_  [RUN]
[0m13:07:49.339205 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68, now test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6)
[0m13:07:49.340987 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m13:07:49.354435 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m13:07:49.369221 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m13:07:49.375165 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m13:07:49.387208 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.110 seconds
[0m13:07:49.393970 [info ] [Thread-3 (]: 7 of 24 PASS not_null_mfg_plant_daily_kpis_calendar_date ....................... [[32mPASS[0m in 1.19s]
[0m13:07:49.397088 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m13:07:49.399407 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m13:07:49.401052 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m13:07:49.402955 [debug] [Thread-2 (]: On test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"} */
[0m13:07:49.405483 [info ] [Thread-3 (]: 15 of 24 START test relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [RUN]
[0m13:07:49.410456 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8, now test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d)
[0m13:07:49.412806 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m13:07:49.425039 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m13:07:49.441129 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m13:07:49.446180 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m13:07:49.460711 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m13:07:49.462165 [debug] [Thread-3 (]: On test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"} */
[0m13:07:49.494512 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.501 seconds
[0m13:07:49.499284 [info ] [Thread-1 (]: 12 of 24 PASS not_null_stg_production_orders_batch_id .......................... [[32mPASS[0m in 0.56s]
[0m13:07:49.502013 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m13:07:49.504357 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m13:07:49.506705 [info ] [Thread-1 (]: 16 of 24 START test relationships_stg_batches_material_id__material_id__ref_stg_materials_  [RUN]
[0m13:07:49.508798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5, now test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2)
[0m13:07:49.510445 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m13:07:49.521416 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m13:07:49.535567 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.407 seconds
[0m13:07:49.542078 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m13:07:49.541183 [info ] [Thread-4 (]: 13 of 24 PASS not_null_stg_production_orders_order_id .......................... [[32mPASS[0m in 0.46s]
[0m13:07:49.548379 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m13:07:49.550744 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m13:07:49.554499 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m13:07:49.556888 [info ] [Thread-4 (]: 17 of 24 START test relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [RUN]
[0m13:07:49.559551 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284, now test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519)
[0m13:07:49.561765 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m13:07:49.574733 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m13:07:49.579489 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m13:07:49.581893 [debug] [Thread-1 (]: On test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"} */
[0m13:07:49.590930 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m13:07:49.596208 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m13:07:49.611427 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m13:07:49.613186 [debug] [Thread-4 (]: On test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"} */
[0m13:07:49.770091 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.363 seconds
[0m13:07:49.774399 [info ] [Thread-2 (]: 14 of 24 PASS relationships_core_batches_material_id__material_id__ref_core_materials_  [[32mPASS[0m in 0.44s]
[0m13:07:49.776380 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m13:07:49.777849 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m13:07:49.779274 [info ] [Thread-2 (]: 18 of 24 START test unique_core_batches_batch_id ............................... [RUN]
[0m13:07:49.780705 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6, now test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf)
[0m13:07:49.782038 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m13:07:49.790616 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m13:07:49.803186 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m13:07:49.808942 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m13:07:49.822239 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m13:07:49.823705 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"} */
[0m13:07:50.030003 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.446 seconds
[0m13:07:50.034069 [info ] [Thread-1 (]: 16 of 24 PASS relationships_stg_batches_material_id__material_id__ref_stg_materials_  [[32mPASS[0m in 0.53s]
[0m13:07:50.035916 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.421 seconds
[0m13:07:50.037702 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m13:07:50.039213 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.576 seconds
[0m13:07:50.042511 [info ] [Thread-4 (]: 17 of 24 PASS relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [[32mPASS[0m in 0.48s]
[0m13:07:50.044187 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m13:07:50.047334 [info ] [Thread-3 (]: 15 of 24 PASS relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [[32mPASS[0m in 0.64s]
[0m13:07:50.049276 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m13:07:50.050970 [info ] [Thread-1 (]: 19 of 24 START test unique_core_materials_material_id .......................... [RUN]
[0m13:07:50.052753 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m13:07:50.054483 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m13:07:50.056497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2, now test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2)
[0m13:07:50.058002 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m13:07:50.059359 [info ] [Thread-4 (]: 20 of 24 START test unique_fct_production_orders_order_id ...................... [RUN]
[0m13:07:50.060883 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m13:07:50.062259 [info ] [Thread-3 (]: 21 of 24 START test unique_mfg_ml_features_orders_order_id ..................... [RUN]
[0m13:07:50.063824 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519, now test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442)
[0m13:07:50.069844 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m13:07:50.071726 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d, now test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd)
[0m13:07:50.073609 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m13:07:50.076245 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m13:07:50.081966 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m13:07:50.089097 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m13:07:50.091301 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m13:07:50.097805 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m13:07:50.102214 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m13:07:50.109712 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m13:07:50.110549 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m13:07:50.117534 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m13:07:50.121005 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m13:07:50.123265 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"} */
[0m13:07:50.125274 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m13:07:50.130662 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"} */
[0m13:07:50.132805 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m13:07:50.136927 [debug] [Thread-3 (]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"} */
[0m13:07:50.192012 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.367 seconds
[0m13:07:50.195486 [error] [Thread-2 (]: 18 of 24 FAIL 10000 unique_core_batches_batch_id ............................... [[31mFAIL 10000[0m in 0.41s]
[0m13:07:50.197335 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m13:07:50.198969 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m13:07:50.200371 [info ] [Thread-2 (]: 22 of 24 START test unique_stg_batches_batch_id ................................ [RUN]
[0m13:07:50.201846 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf, now test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4)
[0m13:07:50.203271 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m13:07:50.210786 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m13:07:50.222347 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m13:07:50.226369 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m13:07:50.240323 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m13:07:50.241864 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"} */
[0m13:07:50.446584 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.320 seconds
[0m13:07:50.451097 [error] [Thread-1 (]: 19 of 24 FAIL 500 unique_core_materials_material_id ............................ [[31mFAIL 500[0m in 0.39s]
[0m13:07:50.452988 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m13:07:50.454991 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m13:07:50.456844 [info ] [Thread-1 (]: 23 of 24 START test unique_stg_materials_material_id ........................... [RUN]
[0m13:07:50.458496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2, now test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21)
[0m13:07:50.459887 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m13:07:50.465706 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m13:07:50.479532 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m13:07:50.483724 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m13:07:50.488952 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.354 seconds
[0m13:07:50.493662 [error] [Thread-4 (]: 20 of 24 FAIL 10000 unique_fct_production_orders_order_id ...................... [[31mFAIL 10000[0m in 0.43s]
[0m13:07:50.496061 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m13:07:50.497861 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m13:07:50.499493 [info ] [Thread-4 (]: 24 of 24 START test unique_stg_production_orders_order_id ...................... [RUN]
[0m13:07:50.501861 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442, now test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3)
[0m13:07:50.504013 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m13:07:50.505551 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m13:07:50.507453 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"} */
[0m13:07:50.513750 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m13:07:50.530342 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m13:07:50.534718 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m13:07:50.548240 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m13:07:50.549481 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"} */
[0m13:07:50.581371 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.338 seconds
[0m13:07:50.584559 [error] [Thread-2 (]: 22 of 24 FAIL 10000 unique_stg_batches_batch_id ................................ [[31mFAIL 10000[0m in 0.38s]
[0m13:07:50.586180 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m13:07:50.970605 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.455 seconds
[0m13:07:50.974984 [error] [Thread-1 (]: 23 of 24 FAIL 500 unique_stg_materials_material_id ............................. [[31mFAIL 500[0m in 0.52s]
[0m13:07:50.977301 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m13:07:51.091951 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.541 seconds
[0m13:07:51.096245 [error] [Thread-4 (]: 24 of 24 FAIL 10000 unique_stg_production_orders_order_id ...................... [[31mFAIL 10000[0m in 0.59s]
[0m13:07:51.098091 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m13:07:57.921521 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 7.782 seconds
[0m13:07:57.927004 [error] [Thread-3 (]: 21 of 24 FAIL 10000 unique_mfg_ml_features_orders_order_id ..................... [[31mFAIL 10000[0m in 7.86s]
[0m13:07:57.929050 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m13:07:57.932576 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:07:57.934160 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21' was left open.
[0m13:07:57.935852 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: Close
[0m13:07:58.461648 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4' was left open.
[0m13:07:58.463313 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: Close
[0m13:07:58.892263 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd' was left open.
[0m13:07:58.895090 [debug] [MainThread]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: Close
[0m13:07:59.347004 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3' was left open.
[0m13:07:59.348826 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: Close
[0m13:07:59.772129 [info ] [MainThread]: 
[0m13:07:59.773843 [info ] [MainThread]: Finished running 24 data tests in 0 hours 0 minutes and 14.83 seconds (14.83s).
[0m13:07:59.779436 [debug] [MainThread]: Command end result
[0m13:07:59.864525 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m13:07:59.874778 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m13:07:59.894498 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m13:07:59.895903 [info ] [MainThread]: 
[0m13:07:59.897336 [info ] [MainThread]: [31mCompleted with 7 errors, 0 partial successes, and 0 warnings:[0m
[0m13:07:59.898628 [info ] [MainThread]: 
[0m13:07:59.900064 [error] [MainThread]: [31mFailure in test unique_core_batches_batch_id (models/core/core_schema.yml)[0m
[0m13:07:59.901877 [error] [MainThread]:   Got 10000 results, configured to fail if != 0
[0m13:07:59.904364 [info ] [MainThread]: 
[0m13:07:59.906045 [info ] [MainThread]:   compiled code at target/compiled/mfg_accelerator/models/core/core_schema.yml/unique_core_batches_batch_id.sql
[0m13:07:59.907494 [info ] [MainThread]: 
[0m13:07:59.908849 [error] [MainThread]: [31mFailure in test unique_core_materials_material_id (models/core/core_schema.yml)[0m
[0m13:07:59.910233 [error] [MainThread]:   Got 500 results, configured to fail if != 0
[0m13:07:59.911567 [info ] [MainThread]: 
[0m13:07:59.912930 [info ] [MainThread]:   compiled code at target/compiled/mfg_accelerator/models/core/core_schema.yml/unique_core_materials_material_id.sql
[0m13:07:59.914299 [info ] [MainThread]: 
[0m13:07:59.915771 [error] [MainThread]: [31mFailure in test unique_fct_production_orders_order_id (models/core/core_schema.yml)[0m
[0m13:07:59.917134 [error] [MainThread]:   Got 10000 results, configured to fail if != 0
[0m13:07:59.918664 [info ] [MainThread]: 
[0m13:07:59.920986 [info ] [MainThread]:   compiled code at target/compiled/mfg_accelerator/models/core/core_schema.yml/unique_fct_production_orders_order_id.sql
[0m13:07:59.922740 [info ] [MainThread]: 
[0m13:07:59.924726 [error] [MainThread]: [31mFailure in test unique_stg_batches_batch_id (models/staging/staging_schema.yml)[0m
[0m13:07:59.926151 [error] [MainThread]:   Got 10000 results, configured to fail if != 0
[0m13:07:59.927486 [info ] [MainThread]: 
[0m13:07:59.928702 [info ] [MainThread]:   compiled code at target/compiled/mfg_accelerator/models/staging/staging_schema.yml/unique_stg_batches_batch_id.sql
[0m13:07:59.929903 [info ] [MainThread]: 
[0m13:07:59.931234 [error] [MainThread]: [31mFailure in test unique_stg_materials_material_id (models/staging/staging_schema.yml)[0m
[0m13:07:59.933369 [error] [MainThread]:   Got 500 results, configured to fail if != 0
[0m13:07:59.935425 [info ] [MainThread]: 
[0m13:07:59.938090 [info ] [MainThread]:   compiled code at target/compiled/mfg_accelerator/models/staging/staging_schema.yml/unique_stg_materials_material_id.sql
[0m13:07:59.940145 [info ] [MainThread]: 
[0m13:07:59.941883 [error] [MainThread]: [31mFailure in test unique_stg_production_orders_order_id (models/staging/staging_schema.yml)[0m
[0m13:07:59.943762 [error] [MainThread]:   Got 10000 results, configured to fail if != 0
[0m13:07:59.945430 [info ] [MainThread]: 
[0m13:07:59.947264 [info ] [MainThread]:   compiled code at target/compiled/mfg_accelerator/models/staging/staging_schema.yml/unique_stg_production_orders_order_id.sql
[0m13:07:59.949034 [info ] [MainThread]: 
[0m13:07:59.950783 [error] [MainThread]: [31mFailure in test unique_mfg_ml_features_orders_order_id (models/marts/marts_schema.yml)[0m
[0m13:07:59.953265 [error] [MainThread]:   Got 10000 results, configured to fail if != 0
[0m13:07:59.955318 [info ] [MainThread]: 
[0m13:07:59.957587 [info ] [MainThread]:   compiled code at target/compiled/mfg_accelerator/models/marts/marts_schema.yml/unique_mfg_ml_features_orders_order_id.sql
[0m13:07:59.959446 [info ] [MainThread]: 
[0m13:07:59.961189 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=7 SKIP=0 NO-OP=0 TOTAL=24
[0m13:07:59.963666 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 16.915257, "process_in_blocks": "0", "process_kernel_time": 1.400955, "process_mem_max_rss": "224200", "process_out_blocks": "16", "process_user_time": 5.164777}
[0m13:07:59.965756 [debug] [MainThread]: Command `dbt test` failed at 13:07:59.965588 after 16.92 seconds
[0m13:07:59.967282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c255ba2b5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c255bd93f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c25345efa40>]}
[0m13:07:59.968787 [debug] [MainThread]: Flushing usage events
[0m13:08:00.590240 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:13:04.297901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72faadd36cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72faadd37560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72faadd37ec0>]}


============================== 13:13:04.306153 | 39434e54-2432-4e86-bba2-6507dc7e18c9 ==============================
[0m13:13:04.306153 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:13:04.307855 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'printer_width': '80', 'partial_parse': 'True', 'introspect': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'static_parser': 'True', 'debug': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt_profiles', 'quiet': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'cache_selected_only': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False'}
[0m13:13:04.979785 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m13:13:04.981871 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m13:13:04.983598 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m13:13:05.179418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39434e54-2432-4e86-bba2-6507dc7e18c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fa9102e960>]}
[0m13:13:05.246231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39434e54-2432-4e86-bba2-6507dc7e18c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fa92659af0>]}
[0m13:13:05.248217 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m13:13:05.398590 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m13:13:05.736219 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:13:05.737826 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:13:05.787721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39434e54-2432-4e86-bba2-6507dc7e18c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fa8bed5580>]}
[0m13:13:05.913321 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m13:13:05.921171 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m13:13:05.964951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39434e54-2432-4e86-bba2-6507dc7e18c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fa8b987710>]}
[0m13:13:05.966463 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m13:13:05.967644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39434e54-2432-4e86-bba2-6507dc7e18c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fa90395c70>]}
[0m13:13:05.971539 [info ] [MainThread]: 
[0m13:13:05.972813 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:13:05.974232 [info ] [MainThread]: 
[0m13:13:05.975746 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:13:05.981741 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m13:13:06.031466 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m13:13:06.032700 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m13:13:06.033775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:07.727837 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.694 seconds
[0m13:13:07.733421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39434e54-2432-4e86-bba2-6507dc7e18c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fa9031d040>]}
[0m13:13:07.740707 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m13:13:07.741420 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m13:13:07.742119 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m13:13:07.742756 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m13:13:07.743786 [info ] [Thread-1 (]: 1 of 24 START test not_null_core_batches_batch_id .............................. [RUN]
[0m13:13:07.745467 [info ] [Thread-2 (]: 2 of 24 START test not_null_core_batches_material_id ........................... [RUN]
[0m13:13:07.746947 [info ] [Thread-3 (]: 3 of 24 START test not_null_core_materials_material_id ......................... [RUN]
[0m13:13:07.748719 [info ] [Thread-4 (]: 4 of 24 START test not_null_fct_production_orders_batch_id ..................... [RUN]
[0m13:13:07.750617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c)
[0m13:13:07.752489 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e'
[0m13:13:07.753843 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8'
[0m13:13:07.755382 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1'
[0m13:13:07.756776 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m13:13:07.758275 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m13:13:07.759601 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m13:13:07.760875 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m13:13:07.783083 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m13:13:07.788002 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m13:13:07.793467 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m13:13:07.799116 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m13:13:07.808423 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m13:13:07.809373 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m13:13:07.810671 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m13:13:07.822648 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m13:13:07.848900 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m13:13:07.850952 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m13:13:07.855501 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m13:13:07.860502 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m13:13:07.872148 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m13:13:07.875013 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m13:13:07.876125 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"} */
[0m13:13:07.877644 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m13:13:07.879096 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m13:13:07.880583 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"} */
[0m13:13:07.882600 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:13:07.884649 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"} */
[0m13:13:07.886520 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"} */
[0m13:13:07.897583 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:13:07.899220 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:13:08.391163 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.503 seconds
[0m13:13:08.402779 [info ] [Thread-1 (]: 1 of 24 PASS not_null_core_batches_batch_id .................................... [[32mPASS[0m in 0.65s]
[0m13:13:08.404605 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m13:13:08.406139 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m13:13:08.407659 [info ] [Thread-1 (]: 5 of 24 START test not_null_fct_production_orders_order_id ..................... [RUN]
[0m13:13:08.409315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c, now test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f)
[0m13:13:08.410764 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m13:13:08.418175 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m13:13:08.450874 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m13:13:08.456639 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m13:13:08.468925 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m13:13:08.470507 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"} */
[0m13:13:08.729428 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.257 seconds
[0m13:13:08.733181 [info ] [Thread-1 (]: 5 of 24 PASS not_null_fct_production_orders_order_id ........................... [[32mPASS[0m in 0.32s]
[0m13:13:08.735119 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m13:13:08.736801 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m13:13:08.738351 [info ] [Thread-1 (]: 6 of 24 START test not_null_mfg_ml_features_orders_order_id .................... [RUN]
[0m13:13:08.739956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f, now test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213)
[0m13:13:08.741528 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m13:13:08.746791 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m13:13:08.760028 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m13:13:08.764160 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m13:13:08.778485 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m13:13:08.780023 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"} */
[0m13:13:09.051662 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.270 seconds
[0m13:13:09.055565 [info ] [Thread-1 (]: 6 of 24 PASS not_null_mfg_ml_features_orders_order_id .......................... [[32mPASS[0m in 0.32s]
[0m13:13:09.057663 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m13:13:09.059268 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m13:13:09.060812 [info ] [Thread-1 (]: 7 of 24 START test not_null_mfg_plant_daily_kpis_calendar_date ................. [RUN]
[0m13:13:09.062781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8)
[0m13:13:09.064484 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m13:13:09.070563 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m13:13:09.083507 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m13:13:09.089990 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m13:13:09.107854 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m13:13:09.109330 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select calendar_date
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where calendar_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"} */
[0m13:13:09.250988 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.368 seconds
[0m13:13:09.254407 [info ] [Thread-2 (]: 2 of 24 PASS not_null_core_batches_material_id ................................. [[32mPASS[0m in 1.50s]
[0m13:13:09.256131 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m13:13:09.257669 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m13:13:09.259114 [info ] [Thread-2 (]: 8 of 24 START test not_null_mfg_plant_daily_kpis_manufacturing_site ............ [RUN]
[0m13:13:09.260553 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68)
[0m13:13:09.261970 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m13:13:09.267021 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m13:13:09.278220 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.379 seconds
[0m13:13:09.282633 [info ] [Thread-3 (]: 3 of 24 PASS not_null_core_materials_material_id ............................... [[32mPASS[0m in 1.53s]
[0m13:13:09.283562 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m13:13:09.285150 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m13:13:09.289361 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m13:13:09.290913 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m13:13:09.293513 [info ] [Thread-3 (]: 9 of 24 START test not_null_stg_batches_batch_id ............................... [RUN]
[0m13:13:09.294987 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8, now test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0)
[0m13:13:09.296447 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m13:13:09.303002 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m13:13:09.306810 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m13:13:09.308228 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturing_site
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where manufacturing_site is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"} */
[0m13:13:09.316199 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m13:13:09.320690 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m13:13:09.332442 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m13:13:09.333866 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"} */
[0m13:13:09.407142 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.510 seconds
[0m13:13:09.410280 [info ] [Thread-4 (]: 4 of 24 PASS not_null_fct_production_orders_batch_id ........................... [[32mPASS[0m in 1.65s]
[0m13:13:09.411980 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m13:13:09.413443 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m13:13:09.414700 [info ] [Thread-4 (]: 10 of 24 START test not_null_stg_batches_material_id ........................... [RUN]
[0m13:13:09.416227 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1, now test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c)
[0m13:13:09.417466 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m13:13:09.422524 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m13:13:09.432009 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m13:13:09.436143 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m13:13:09.438427 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.328 seconds
[0m13:13:09.443246 [info ] [Thread-1 (]: 7 of 24 PASS not_null_mfg_plant_daily_kpis_calendar_date ....................... [[32mPASS[0m in 0.38s]
[0m13:13:09.445450 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m13:13:09.447084 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m13:13:09.448529 [info ] [Thread-1 (]: 11 of 24 START test not_null_stg_materials_material_id ......................... [RUN]
[0m13:13:09.450273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8, now test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89)
[0m13:13:09.451931 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m13:13:09.452899 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m13:13:09.454186 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"} */
[0m13:13:09.459510 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m13:13:09.473456 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m13:13:09.477554 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m13:13:09.490577 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m13:13:09.492120 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"} */
[0m13:13:09.568653 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.259 seconds
[0m13:13:09.572372 [info ] [Thread-2 (]: 8 of 24 PASS not_null_mfg_plant_daily_kpis_manufacturing_site .................. [[32mPASS[0m in 0.31s]
[0m13:13:09.574193 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m13:13:09.575734 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m13:13:09.577315 [info ] [Thread-2 (]: 12 of 24 START test not_null_stg_production_orders_batch_id .................... [RUN]
[0m13:13:09.578925 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68, now test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5)
[0m13:13:09.580350 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m13:13:09.587463 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m13:13:09.600190 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m13:13:09.604014 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m13:13:09.615375 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m13:13:09.616664 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"} */
[0m13:13:09.647198 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.312 seconds
[0m13:13:09.650867 [info ] [Thread-3 (]: 9 of 24 PASS not_null_stg_batches_batch_id ..................................... [[32mPASS[0m in 0.36s]
[0m13:13:09.652730 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m13:13:09.654330 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m13:13:09.655742 [info ] [Thread-3 (]: 13 of 24 START test not_null_stg_production_orders_order_id .................... [RUN]
[0m13:13:09.657282 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0, now test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284)
[0m13:13:09.658804 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m13:13:09.663898 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m13:13:09.675262 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m13:13:09.679376 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m13:13:09.692500 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m13:13:09.694101 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"} */
[0m13:13:09.757277 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.296 seconds
[0m13:13:09.761945 [info ] [Thread-4 (]: 10 of 24 PASS not_null_stg_batches_material_id ................................. [[32mPASS[0m in 0.35s]
[0m13:13:09.764378 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m13:13:09.766371 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m13:13:09.768800 [info ] [Thread-4 (]: 14 of 24 START test relationships_core_batches_material_id__material_id__ref_core_materials_  [RUN]
[0m13:13:09.771738 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c, now test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6)
[0m13:13:09.773773 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m13:13:09.790181 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m13:13:09.792649 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.299 seconds
[0m13:13:09.800076 [info ] [Thread-1 (]: 11 of 24 PASS not_null_stg_materials_material_id ............................... [[32mPASS[0m in 0.35s]
[0m13:13:09.802696 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m13:13:09.804661 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m13:13:09.806136 [info ] [Thread-1 (]: 15 of 24 START test relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [RUN]
[0m13:13:09.808219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89, now test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d)
[0m13:13:09.810327 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m13:13:09.811443 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m13:13:09.819628 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m13:13:09.824361 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m13:13:09.839169 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m13:13:09.841086 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m13:13:09.845875 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m13:13:09.847847 [debug] [Thread-4 (]: On test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"} */
[0m13:13:09.863862 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m13:13:09.865509 [debug] [Thread-1 (]: On test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"} */
[0m13:13:09.889420 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.272 seconds
[0m13:13:09.892859 [info ] [Thread-2 (]: 12 of 24 PASS not_null_stg_production_orders_batch_id .......................... [[32mPASS[0m in 0.31s]
[0m13:13:09.894503 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m13:13:09.896076 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m13:13:09.897630 [info ] [Thread-2 (]: 16 of 24 START test relationships_stg_batches_material_id__material_id__ref_stg_materials_  [RUN]
[0m13:13:09.899160 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5, now test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2)
[0m13:13:09.900656 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m13:13:09.906697 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m13:13:09.918625 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m13:13:09.924474 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m13:13:09.943506 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m13:13:09.945865 [debug] [Thread-2 (]: On test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"} */
[0m13:13:09.968239 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.272 seconds
[0m13:13:09.972949 [info ] [Thread-3 (]: 13 of 24 PASS not_null_stg_production_orders_order_id .......................... [[32mPASS[0m in 0.32s]
[0m13:13:09.975908 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m13:13:09.978261 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m13:13:09.980353 [info ] [Thread-3 (]: 17 of 24 START test relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [RUN]
[0m13:13:09.982169 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284, now test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519)
[0m13:13:09.983914 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m13:13:09.994219 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m13:13:10.012712 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m13:13:10.021420 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m13:13:10.042119 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m13:13:10.043837 [debug] [Thread-3 (]: On test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"} */
[0m13:13:10.119998 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.269 seconds
[0m13:13:10.124385 [info ] [Thread-4 (]: 14 of 24 PASS relationships_core_batches_material_id__material_id__ref_core_materials_  [[32mPASS[0m in 0.35s]
[0m13:13:10.126338 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m13:13:10.127848 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m13:13:10.129435 [info ] [Thread-4 (]: 18 of 24 START test unique_core_batches_batch_id ............................... [RUN]
[0m13:13:10.131083 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6, now test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf)
[0m13:13:10.132569 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m13:13:10.140744 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m13:13:10.142899 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.276 seconds
[0m13:13:10.147498 [info ] [Thread-1 (]: 15 of 24 PASS relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [[32mPASS[0m in 0.34s]
[0m13:13:10.149475 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m13:13:10.151040 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m13:13:10.152389 [info ] [Thread-1 (]: 19 of 24 START test unique_core_materials_material_id .......................... [RUN]
[0m13:13:10.153913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d, now test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2)
[0m13:13:10.155474 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m13:13:10.161480 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m13:13:10.162018 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m13:13:10.167867 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m13:13:10.175782 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m13:13:10.180787 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m13:13:10.183479 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m13:13:10.185206 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"} */
[0m13:13:10.195178 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m13:13:10.197021 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"} */
[0m13:13:10.305639 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.358 seconds
[0m13:13:10.315012 [info ] [Thread-2 (]: 16 of 24 PASS relationships_stg_batches_material_id__material_id__ref_stg_materials_  [[32mPASS[0m in 0.42s]
[0m13:13:10.318579 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m13:13:10.321354 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m13:13:10.323817 [info ] [Thread-2 (]: 20 of 24 START test unique_fct_production_orders_order_id ...................... [RUN]
[0m13:13:10.326595 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2, now test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442)
[0m13:13:10.329050 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m13:13:10.341611 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m13:13:10.344144 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.298 seconds
[0m13:13:10.350950 [info ] [Thread-3 (]: 17 of 24 PASS relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [[32mPASS[0m in 0.37s]
[0m13:13:10.353787 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m13:13:10.356362 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m13:13:10.358453 [info ] [Thread-3 (]: 21 of 24 START test unique_mfg_ml_features_orders_order_id ..................... [RUN]
[0m13:13:10.361048 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519, now test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd)
[0m13:13:10.362955 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m13:13:10.363838 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m13:13:10.369433 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m13:13:10.376394 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m13:13:10.391131 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m13:13:10.392246 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m13:13:10.394368 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"} */
[0m13:13:10.402219 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m13:13:10.419077 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m13:13:10.420613 [debug] [Thread-3 (]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"} */
[0m13:13:10.426480 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.239 seconds
[0m13:13:10.432390 [error] [Thread-4 (]: 18 of 24 FAIL 10000 unique_core_batches_batch_id ............................... [[31mFAIL 10000[0m in 0.30s]
[0m13:13:10.434758 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m13:13:10.436334 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m13:13:10.437883 [info ] [Thread-4 (]: 22 of 24 START test unique_stg_batches_batch_id ................................ [RUN]
[0m13:13:10.439973 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf, now test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4)
[0m13:13:10.442307 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.244 seconds
[0m13:13:10.443980 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m13:13:10.449746 [error] [Thread-1 (]: 19 of 24 FAIL 500 unique_core_materials_material_id ............................ [[31mFAIL 500[0m in 0.30s]
[0m13:13:10.458185 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m13:13:10.460334 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m13:13:10.463294 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m13:13:10.465004 [info ] [Thread-1 (]: 23 of 24 START test unique_stg_materials_material_id ........................... [RUN]
[0m13:13:10.467156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2, now test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21)
[0m13:13:10.469511 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m13:13:10.478901 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m13:13:10.481446 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m13:13:10.487931 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m13:13:10.491653 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m13:13:10.500904 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m13:13:10.510871 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m13:13:10.512988 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m13:13:10.514658 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"} */
[0m13:13:10.516415 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"} */
[0m13:13:10.650653 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.247 seconds
[0m13:13:10.657637 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.235 seconds
[0m13:13:10.655925 [error] [Thread-2 (]: 20 of 24 FAIL 10000 unique_fct_production_orders_order_id ...................... [[31mFAIL 10000[0m in 0.33s]
[0m13:13:10.661837 [error] [Thread-3 (]: 21 of 24 FAIL 10000 unique_mfg_ml_features_orders_order_id ..................... [[31mFAIL 10000[0m in 0.30s]
[0m13:13:10.664448 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m13:13:10.666872 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m13:13:10.668803 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m13:13:10.671692 [info ] [Thread-2 (]: 24 of 24 START test unique_stg_production_orders_order_id ...................... [RUN]
[0m13:13:10.673442 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442, now test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3)
[0m13:13:10.675008 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m13:13:10.683711 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m13:13:10.696958 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m13:13:10.701626 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m13:13:10.714877 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m13:13:10.716368 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"} */
[0m13:13:10.763646 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.243 seconds
[0m13:13:10.767323 [error] [Thread-1 (]: 23 of 24 FAIL 500 unique_stg_materials_material_id ............................. [[31mFAIL 500[0m in 0.30s]
[0m13:13:10.769094 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m13:13:10.842927 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.325 seconds
[0m13:13:10.846322 [error] [Thread-4 (]: 22 of 24 FAIL 10000 unique_stg_batches_batch_id ................................ [[31mFAIL 10000[0m in 0.41s]
[0m13:13:10.848268 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m13:13:10.971937 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.254 seconds
[0m13:13:10.975498 [error] [Thread-2 (]: 24 of 24 FAIL 10000 unique_stg_production_orders_order_id ...................... [[31mFAIL 10000[0m in 0.30s]
[0m13:13:10.977293 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m13:13:10.980546 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:13:10.982166 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21' was left open.
[0m13:13:10.983559 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: Close
[0m13:13:11.385700 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3' was left open.
[0m13:13:11.387323 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: Close
[0m13:13:11.841708 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd' was left open.
[0m13:13:11.843968 [debug] [MainThread]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: Close
[0m13:13:12.312094 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4' was left open.
[0m13:13:12.314016 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: Close
[0m13:13:12.726441 [info ] [MainThread]: 
[0m13:13:12.728372 [info ] [MainThread]: Finished running 24 data tests in 0 hours 0 minutes and 6.75 seconds (6.75s).
[0m13:13:12.735137 [debug] [MainThread]: Command end result
[0m13:13:12.823863 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m13:13:12.832369 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m13:13:12.849409 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m13:13:12.850893 [info ] [MainThread]: 
[0m13:13:12.852521 [info ] [MainThread]: [31mCompleted with 7 errors, 0 partial successes, and 0 warnings:[0m
[0m13:13:12.854141 [info ] [MainThread]: 
[0m13:13:12.855786 [error] [MainThread]: [31mFailure in test unique_core_batches_batch_id (models/core/core_schema.yml)[0m
[0m13:13:12.857454 [error] [MainThread]:   Got 10000 results, configured to fail if != 0
[0m13:13:12.858917 [info ] [MainThread]: 
[0m13:13:12.860553 [info ] [MainThread]:   compiled code at target/compiled/mfg_accelerator/models/core/core_schema.yml/unique_core_batches_batch_id.sql
[0m13:13:12.861941 [info ] [MainThread]: 
[0m13:13:12.863630 [error] [MainThread]: [31mFailure in test unique_core_materials_material_id (models/core/core_schema.yml)[0m
[0m13:13:12.865388 [error] [MainThread]:   Got 500 results, configured to fail if != 0
[0m13:13:12.866832 [info ] [MainThread]: 
[0m13:13:12.868416 [info ] [MainThread]:   compiled code at target/compiled/mfg_accelerator/models/core/core_schema.yml/unique_core_materials_material_id.sql
[0m13:13:12.869884 [info ] [MainThread]: 
[0m13:13:12.871353 [error] [MainThread]: [31mFailure in test unique_fct_production_orders_order_id (models/core/core_schema.yml)[0m
[0m13:13:12.872919 [error] [MainThread]:   Got 10000 results, configured to fail if != 0
[0m13:13:12.874395 [info ] [MainThread]: 
[0m13:13:12.876134 [info ] [MainThread]:   compiled code at target/compiled/mfg_accelerator/models/core/core_schema.yml/unique_fct_production_orders_order_id.sql
[0m13:13:12.877997 [info ] [MainThread]: 
[0m13:13:12.879791 [error] [MainThread]: [31mFailure in test unique_mfg_ml_features_orders_order_id (models/marts/marts_schema.yml)[0m
[0m13:13:12.881561 [error] [MainThread]:   Got 10000 results, configured to fail if != 0
[0m13:13:12.883065 [info ] [MainThread]: 
[0m13:13:12.884711 [info ] [MainThread]:   compiled code at target/compiled/mfg_accelerator/models/marts/marts_schema.yml/unique_mfg_ml_features_orders_order_id.sql
[0m13:13:12.886251 [info ] [MainThread]: 
[0m13:13:12.887978 [error] [MainThread]: [31mFailure in test unique_stg_materials_material_id (models/staging/staging_schema.yml)[0m
[0m13:13:12.889723 [error] [MainThread]:   Got 500 results, configured to fail if != 0
[0m13:13:12.891288 [info ] [MainThread]: 
[0m13:13:12.892954 [info ] [MainThread]:   compiled code at target/compiled/mfg_accelerator/models/staging/staging_schema.yml/unique_stg_materials_material_id.sql
[0m13:13:12.894433 [info ] [MainThread]: 
[0m13:13:12.896013 [error] [MainThread]: [31mFailure in test unique_stg_batches_batch_id (models/staging/staging_schema.yml)[0m
[0m13:13:12.897749 [error] [MainThread]:   Got 10000 results, configured to fail if != 0
[0m13:13:12.899185 [info ] [MainThread]: 
[0m13:13:12.900711 [info ] [MainThread]:   compiled code at target/compiled/mfg_accelerator/models/staging/staging_schema.yml/unique_stg_batches_batch_id.sql
[0m13:13:12.902311 [info ] [MainThread]: 
[0m13:13:12.904588 [error] [MainThread]: [31mFailure in test unique_stg_production_orders_order_id (models/staging/staging_schema.yml)[0m
[0m13:13:12.906978 [error] [MainThread]:   Got 10000 results, configured to fail if != 0
[0m13:13:12.908513 [info ] [MainThread]: 
[0m13:13:12.910264 [info ] [MainThread]:   compiled code at target/compiled/mfg_accelerator/models/staging/staging_schema.yml/unique_stg_production_orders_order_id.sql
[0m13:13:12.912120 [info ] [MainThread]: 
[0m13:13:12.913819 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=7 SKIP=0 NO-OP=0 TOTAL=24
[0m13:13:12.916360 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 8.706298, "process_in_blocks": "0", "process_kernel_time": 1.261551, "process_mem_max_rss": "224188", "process_out_blocks": "16", "process_user_time": 4.806672}
[0m13:13:12.918187 [debug] [MainThread]: Command `dbt test` failed at 13:13:12.918019 after 8.71 seconds
[0m13:13:12.919834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72faadf4deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72faadd36cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fa8bef03e0>]}
[0m13:13:12.921496 [debug] [MainThread]: Flushing usage events
[0m13:13:13.616053 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:59:34.129669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe801bb6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe7fae57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe7fae7fe0>]}


============================== 13:59:34.137593 | 84ced0b6-c756-4fcb-8a10-2dd0c68d6acb ==============================
[0m13:59:34.137593 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:59:34.139372 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'write_json': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'debug': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'fail_fast': 'False', 'partial_parse': 'True', 'empty': 'False', 'no_print': 'None', 'profiles_dir': '/opt/airflow/dbt_profiles', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt_profiles', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'version_check': 'True'}
[0m13:59:34.886478 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m13:59:34.888152 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m13:59:34.889683 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m13:59:35.100241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84ced0b6-c756-4fcb-8a10-2dd0c68d6acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe5dcf9af0>]}
[0m13:59:35.171679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84ced0b6-c756-4fcb-8a10-2dd0c68d6acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe64793590>]}
[0m13:59:35.173798 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m13:59:35.336559 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m13:59:35.644179 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:59:35.645735 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:59:35.699675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84ced0b6-c756-4fcb-8a10-2dd0c68d6acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe5dbf25d0>]}
[0m13:59:35.824679 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m13:59:35.831715 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m13:59:35.864109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84ced0b6-c756-4fcb-8a10-2dd0c68d6acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe5d907dd0>]}
[0m13:59:35.865479 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m13:59:35.866948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84ced0b6-c756-4fcb-8a10-2dd0c68d6acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe5d87ee70>]}
[0m13:59:35.870472 [info ] [MainThread]: 
[0m13:59:35.872343 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:59:35.873801 [info ] [MainThread]: 
[0m13:59:35.875309 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:59:35.881418 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m13:59:35.926204 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m13:59:35.928007 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m13:59:35.929395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:37.438195 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.509 seconds
[0m13:59:37.442832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR, now list_MFG_ACCELERATOR_ANALYTICS_analytics)
[0m13:59:37.458778 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m13:59:37.460671 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m13:59:37.744978 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.283 seconds
[0m13:59:37.758260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84ced0b6-c756-4fcb-8a10-2dd0c68d6acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe5d824980>]}
[0m13:59:37.774574 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.stg_batches
[0m13:59:37.776221 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.stg_materials
[0m13:59:37.777503 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.stg_production_orders
[0m13:59:37.780432 [info ] [Thread-1 (]: 1 of 8 START sql view model ANALYTICS_analytics.stg_batches .................... [RUN]
[0m13:59:37.785886 [info ] [Thread-2 (]: 2 of 8 START sql view model ANALYTICS_analytics.stg_materials .................. [RUN]
[0m13:59:37.788444 [info ] [Thread-3 (]: 3 of 8 START sql view model ANALYTICS_analytics.stg_production_orders .......... [RUN]
[0m13:59:37.791010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now model.mfg_accelerator.stg_batches)
[0m13:59:37.793987 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_materials'
[0m13:59:37.796593 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_production_orders'
[0m13:59:37.798410 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.stg_batches
[0m13:59:37.801171 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.stg_materials
[0m13:59:37.803016 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.stg_production_orders
[0m13:59:37.822340 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.stg_batches"
[0m13:59:37.888917 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.stg_materials"
[0m13:59:37.892640 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.stg_production_orders"
[0m13:59:37.900899 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.stg_materials
[0m13:59:37.902050 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.stg_batches
[0m13:59:37.908742 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.stg_production_orders
[0m13:59:37.957495 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.stg_materials"
[0m13:59:37.959460 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.stg_batches"
[0m13:59:37.962945 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.stg_production_orders"
[0m13:59:37.973868 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.stg_materials"
[0m13:59:37.976671 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.stg_production_orders"
[0m13:59:37.978888 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.stg_batches"
[0m13:59:37.980202 [debug] [Thread-2 (]: On model.mfg_accelerator.stg_materials: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
  
  
  
  
  as (
    -- stg_materials.sql
-- Purpose:
--  - Create a clean, standardized view of materials
--  - Apply basic typing and naming conventions
--  - This is the first "T" step after RAW

with source as (

    -- Pull data from the RAW.MATERIALS table registered as a source
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        status,
        created_at
    from MFG_ACCELERATOR.RAW.materials

),

renamed as (

    -- Apply any renaming / typing here
    select
        material_id                as material_id,        -- keep same, but explicitly select
        material_name              as material_name,
        material_type              as material_type,
        unit_of_measure            as unit_of_measure,
        status                     as material_status,    -- rename to avoid generic 'status'
        cast(created_at as date)   as created_at
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_materials"} */;
[0m13:59:37.982183 [debug] [Thread-3 (]: On model.mfg_accelerator.stg_production_orders: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
  
  
  
  
  as (
    -- stg_production_orders.sql
-- Purpose:
--  - Clean and standardize production order data
--  - Ensure date fields and statuses are typed and named consistently

with source as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.RAW.production_orders

),

renamed as (

    select
        order_id                               as order_id,
        batch_id                               as batch_id,
        order_type                             as order_type,
        cast(planned_start_date as date)       as planned_start_date,
        cast(planned_end_date as date)         as planned_end_date,
        cast(actual_start_date as date)        as actual_start_date,
        cast(actual_end_date as date)          as actual_end_date,
        order_status                           as order_status,
        line_id                                as line_id
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_production_orders"} */;
[0m13:59:37.984084 [debug] [Thread-1 (]: On model.mfg_accelerator.stg_batches: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
  
  
  
  
  as (
    -- stg_batches.sql
-- Purpose:
--  - Clean and standardize batch data
--  - Ensure dates and numeric types are correct

with source as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.RAW.batches

),

renamed as (

    select
        batch_id                         as batch_id,
        material_id                      as material_id,
        manufacturing_site               as manufacturing_site,
        cast(manufacture_date as date)   as manufacture_date,
        cast(expiry_date as date)        as expiry_date,
        cast(quantity as number)         as quantity,
        batch_status                     as batch_status
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_batches"} */;
[0m13:59:37.985811 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:59:37.987740 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:59:38.396816 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.407 seconds
[0m13:59:38.424046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84ced0b6-c756-4fcb-8a10-2dd0c68d6acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe81842240>]}
[0m13:59:38.425818 [info ] [Thread-1 (]: 1 of 8 OK created sql view model ANALYTICS_analytics.stg_batches ............... [[32mSUCCESS 1[0m in 0.63s]
[0m13:59:38.427665 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.stg_batches
[0m13:59:39.616130 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.628 seconds
[0m13:59:39.617987 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.632 seconds
[0m13:59:39.621978 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84ced0b6-c756-4fcb-8a10-2dd0c68d6acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe5dad78c0>]}
[0m13:59:39.625704 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84ced0b6-c756-4fcb-8a10-2dd0c68d6acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe5d6a75f0>]}
[0m13:59:39.627397 [info ] [Thread-3 (]: 3 of 8 OK created sql view model ANALYTICS_analytics.stg_production_orders ..... [[32mSUCCESS 1[0m in 1.83s]
[0m13:59:39.629369 [info ] [Thread-2 (]: 2 of 8 OK created sql view model ANALYTICS_analytics.stg_materials ............. [[32mSUCCESS 1[0m in 1.83s]
[0m13:59:39.631024 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.stg_production_orders
[0m13:59:39.632813 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.stg_materials
[0m13:59:39.635936 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.core_materials
[0m13:59:39.637715 [info ] [Thread-4 (]: 4 of 8 START sql table model ANALYTICS_analytics.core_materials ................ [RUN]
[0m13:59:39.639297 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.mfg_accelerator.core_materials'
[0m13:59:39.640852 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.core_materials
[0m13:59:39.646313 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.core_materials"
[0m13:59:39.658326 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.core_materials
[0m13:59:39.689509 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.core_materials"
[0m13:59:39.702975 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.core_materials"
[0m13:59:39.704469 [debug] [Thread-4 (]: On model.mfg_accelerator.core_materials: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
    
    
    
    as (-- core_materials.sql
-- Purpose:
--  - Create a cleaned, enriched material dimension
--  - Add simple derived attributes (e.g. is_active flag, age)

with base as (

    -- Use the staging view as the single source of truth for materials
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,
        created_at
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials

),

enriched as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,

        created_at,

        -- Age of the material definition in days
        datediff('day', created_at, current_date()) as material_age_days,

        -- Simple flag to say if the material is considered active
        case
            when upper(material_status) = 'ACTIVE' then 1
            else 0
        end as is_active_material
    from base

)

select * from enriched
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_materials"} */;
[0m13:59:39.705764 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:59:41.589126 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.883 seconds
[0m13:59:41.592911 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84ced0b6-c756-4fcb-8a10-2dd0c68d6acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe5c937ce0>]}
[0m13:59:41.594582 [info ] [Thread-4 (]: 4 of 8 OK created sql table model ANALYTICS_analytics.core_materials ........... [[32mSUCCESS 1[0m in 1.95s]
[0m13:59:41.596218 [debug] [Thread-4 (]: Finished running node model.mfg_accelerator.core_materials
[0m13:59:41.598396 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.core_batches
[0m13:59:41.599121 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.fct_production_orders
[0m13:59:41.600665 [info ] [Thread-3 (]: 5 of 8 START sql table model ANALYTICS_analytics.core_batches .................. [RUN]
[0m13:59:41.603635 [info ] [Thread-2 (]: 6 of 8 START sql table model ANALYTICS_analytics.fct_production_orders ......... [RUN]
[0m13:59:41.605786 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_production_orders, now model.mfg_accelerator.core_batches)
[0m13:59:41.607640 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_materials, now model.mfg_accelerator.fct_production_orders)
[0m13:59:41.609008 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.core_batches
[0m13:59:41.610437 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.fct_production_orders
[0m13:59:41.614767 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.core_batches"
[0m13:59:41.620642 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.fct_production_orders"
[0m13:59:41.627967 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.core_batches
[0m13:59:41.629738 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.fct_production_orders
[0m13:59:41.633746 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.core_batches"
[0m13:59:41.639089 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.fct_production_orders"
[0m13:59:41.649388 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.core_batches"
[0m13:59:41.652471 [debug] [Thread-3 (]: On model.mfg_accelerator.core_batches: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    
    
    
    as (-- core_batches.sql
-- Purpose:
--  - Combine batch info with material attributes
--  - Add shelf-life and expiry-related metrics

with batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        b.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        -- Shelf life in days = expiry - manufacture
        datediff('day', manufacture_date, expiry_date) as shelf_life_days,

        -- Batch age in days from manufacture date until today
        datediff('day', manufacture_date, current_date()) as batch_age_days,

        -- Days until expiry (can be negative if already expired)
        datediff('day', current_date(), expiry_date) as days_to_expiry,

        case
            when current_date() > expiry_date then 1
            else 0
        end as is_expired
    from batches b
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_batches"} */;
[0m13:59:41.656836 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.fct_production_orders"
[0m13:59:41.661821 [debug] [Thread-2 (]: On model.mfg_accelerator.fct_production_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    
    
    
    as (-- fct_production_orders.sql
-- Purpose:
--  - Fact-like table combining production orders with batch and material context
--  - Compute planned vs actual durations and simple on-time indicators

with orders as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders

),

batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        o.order_id,
        o.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        o.order_type,
        o.line_id,
        o.order_status,

        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        -- Planned duration in days
        datediff('day', planned_start_date, planned_end_date) as planned_duration_days,

        -- Actual duration in days (null if no end date)
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', actual_start_date, actual_end_date)
            else null
        end as actual_duration_days,

        -- Delay vs plan: how many days longer the actual duration was
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', planned_end_date, actual_end_date)
            else null
        end as delay_vs_plan_days,

        -- Simple late flag: 1 if order completed after planned_end_date
        case
            when actual_end_date is not null
             and actual_end_date > planned_end_date
            then 1
            else 0
        end as is_late,

        -- Is the order completed?
        case
            when upper(order_status) = 'COMPLETED' then 1
            else 0
        end as is_completed
    from orders o
    left join batches b
        on o.batch_id = b.batch_id
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.fct_production_orders"} */;
[0m13:59:45.622460 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.963 seconds
[0m13:59:45.626196 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84ced0b6-c756-4fcb-8a10-2dd0c68d6acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe7ee375c0>]}
[0m13:59:45.627700 [info ] [Thread-3 (]: 5 of 8 OK created sql table model ANALYTICS_analytics.core_batches ............. [[32mSUCCESS 1[0m in 4.02s]
[0m13:59:45.629181 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.core_batches
[0m14:00:04.065131 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 22.403 seconds
[0m14:00:04.073976 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84ced0b6-c756-4fcb-8a10-2dd0c68d6acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe5c93f0e0>]}
[0m14:00:04.077152 [info ] [Thread-2 (]: 6 of 8 OK created sql table model ANALYTICS_analytics.fct_production_orders .... [[32mSUCCESS 1[0m in 22.47s]
[0m14:00:04.079798 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.fct_production_orders
[0m14:00:04.083333 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.mfg_ml_features_orders
[0m14:00:04.084765 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:00:04.087090 [info ] [Thread-4 (]: 7 of 8 START sql table model ANALYTICS_analytics.mfg_ml_features_orders ........ [RUN]
[0m14:00:04.089542 [info ] [Thread-1 (]: 8 of 8 START sql table model ANALYTICS_analytics.mfg_plant_daily_kpis .......... [RUN]
[0m14:00:04.091946 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.core_materials, now model.mfg_accelerator.mfg_ml_features_orders)
[0m14:00:04.094232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_batches, now model.mfg_accelerator.mfg_plant_daily_kpis)
[0m14:00:04.096347 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.mfg_ml_features_orders
[0m14:00:04.098193 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:00:04.108339 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:00:04.115262 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:00:04.122763 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:00:04.129525 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.mfg_ml_features_orders
[0m14:00:04.129110 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:00:04.134107 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:00:04.144913 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:00:04.148549 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:00:04.149869 [debug] [Thread-4 (]: On model.mfg_accelerator.mfg_ml_features_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
    
    
    
    as (-- mfg_ml_features_orders.sql
-- Purpose:
--  - Provide ML-ready features at order grain
--  - Target use case: predict late orders or delay vs plan
-- Grain:
--  - One row per production order (order_id)

with orders as (

    select
        order_id,
        batch_id,
        material_id,

        manufacturing_site,
        line_id,

        order_type,
        order_status,

        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,

        planned_duration_days,
        actual_duration_days,
        delay_vs_plan_days,
        is_late,
        is_completed
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders

),

materials as (

    select
        material_id,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

batches as (

    select
        batch_id,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches

),

joined as (

    select
        o.order_id,

        -- Keys and IDs
        o.batch_id,
        o.material_id,

        -- Plant / line / type
        o.manufacturing_site,
        o.line_id,
        o.order_type,
        o.order_status,

        -- Material features
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        -- Batch features
        b.quantity,
        b.batch_status,
        b.shelf_life_days,
        b.batch_age_days,
        b.days_to_expiry,
        b.is_expired,

        -- Temporal features
        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        o.planned_duration_days,
        o.actual_duration_days,
        o.delay_vs_plan_days,

        -- Labels / targets
        o.is_late,
        o.is_completed
    from orders o
    left join materials m
        on o.material_id = m.material_id
    left join batches b
        on o.batch_id = b.batch_id

),

final as (

    select
        -- Primary key
        order_id,

        -- Categorical features
        manufacturing_site,
        line_id,
        order_type,
        order_status,
        material_type,
        unit_of_measure,
        batch_status,

        -- Material state
        is_active_material,

        -- Quantitative batch features
        quantity,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired,

        -- Temporal planning features
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        planned_duration_days,
        actual_duration_days,

        -- Label / target variables
        delay_vs_plan_days,
        is_late,
        is_completed
    from joined
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_ml_features_orders"} */;
[0m14:00:04.151798 [debug] [Thread-1 (]: On model.mfg_accelerator.mfg_plant_daily_kpis: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
    
    
    
    as (-- mfg_plant_daily_kpis.sql
-- Purpose:
--  - Provide daily plant-level KPIs for manufacturing performance monitoring
--  - Aggregates metrics from core_batches and fct_production_orders
-- Grain:
--  - One row per (manufacturing_site, calendar_date)

with calendar_days as (

    -- Build a simple date spine based on manufacture_date and planned/actual dates
    -- This ensures we have a consistent daily grain for metrics.

    select
        -- Use the earliest relevant date from batches and orders
        least(
            min(b.manufacture_date),
            min(o.planned_start_date)
        ) as min_date,
        greatest(
            max(b.manufacture_date),
            max(o.planned_end_date)
        ) as max_date
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    cross join MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o

),

date_spine as (

    -- Generate a list of dates between min_date and max_date
    -- Snowflake-specific generator using TABLE(GENERATOR)
    select
        dateadd(
            day,
            seq4(),
            min_date
        ) as calendar_date
    from calendar_days,
         table(generator(rowcount => datediff('day', min_date, max_date) + 1))

),

batches_by_day as (

    -- Aggregate batch metrics at (manufacturing_site, calendar_date)
    select
        b.manufacturing_site,
        b.manufacture_date as calendar_date,

        count(*) as total_batches,
        sum(b.quantity) as total_quantity,

        sum(case when b.is_expired = 1 then 1 else 0 end) as expired_batches
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    group by
        b.manufacturing_site,
        b.manufacture_date

),

orders_by_day as (

    -- Aggregate order metrics at (manufacturing_site, calendar_date)
    -- We'll use planned_start_date as the main "date" for the order
    select
        b.manufacturing_site,
        o.planned_start_date as calendar_date,

        count(*) as total_orders,
        sum(case when o.is_completed = 1 then 1 else 0 end) as completed_orders,
        sum(case when o.is_late = 1 then 1 else 0 end) as late_orders,

        avg(o.delay_vs_plan_days) as avg_delay_vs_plan_days
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o
    left join MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
        on o.batch_id = b.batch_id
    group by
        b.manufacturing_site,
        o.planned_start_date

),

combined as (

    -- Combine batch and order metrics on (site, date)
    select
        coalesce(b.manufacturing_site, o.manufacturing_site) as manufacturing_site,
        coalesce(b.calendar_date, o.calendar_date) as calendar_date,

        -- Batch metrics
        coalesce(b.total_batches, 0) as total_batches,
        coalesce(b.total_quantity, 0) as total_quantity,
        coalesce(b.expired_batches, 0) as expired_batches,

        -- Order metrics
        coalesce(o.total_orders, 0) as total_orders,
        coalesce(o.completed_orders, 0) as completed_orders,
        coalesce(o.late_orders, 0) as late_orders,
        o.avg_delay_vs_plan_days as avg_delay_vs_plan_days
    from batches_by_day b
    full outer join orders_by_day o
        on  b.manufacturing_site = o.manufacturing_site
        and b.calendar_date = o.calendar_date

),

final as (

    select
        manufacturing_site,
        calendar_date,

        total_batches,
        total_quantity,
        expired_batches,

        total_orders,
        completed_orders,
        late_orders,
        avg_delay_vs_plan_days,

        -- On-time rate: percentage of completed orders that were not late
        case
            when completed_orders > 0 then
                1.0 - (late_orders::float / completed_orders::float)
            else null
        end as on_time_rate
    from combined
    where manufacturing_site is not null
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_plant_daily_kpis"} */;
[0m14:00:13.141609 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 8.986 seconds
[0m14:00:13.146022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84ced0b6-c756-4fcb-8a10-2dd0c68d6acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe5c9705f0>]}
[0m14:00:13.147724 [info ] [Thread-1 (]: 8 of 8 OK created sql table model ANALYTICS_analytics.mfg_plant_daily_kpis ..... [[32mSUCCESS 1[0m in 9.05s]
[0m14:00:13.149977 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:05:05.820529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa86650e6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa868766960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8664dba70>]}


============================== 14:05:05.829862 | 0fc58a16-4ce2-45bf-83fc-95e0a69791d5 ==============================
[0m14:05:05.829862 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:05:05.831579 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/opt/airflow/dbt_profiles', 'indirect_selection': 'eager', 'version_check': 'True', 'printer_width': '80', 'empty': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt_profiles', 'warn_error': 'None', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'no_print': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'quiet': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'write_json': 'True', 'log_path': '/opt/airflow/dbt_project/logs'}
[0m14:05:06.572890 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:05:06.574941 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:05:06.576553 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:05:06.809431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fc58a16-4ce2-45bf-83fc-95e0a69791d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa84ac26450>]}
[0m14:05:06.888077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fc58a16-4ce2-45bf-83fc-95e0a69791d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa866297530>]}
[0m14:05:06.890641 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m14:05:07.064916 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:05:07.351855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:05:07.353605 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:05:07.415096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fc58a16-4ce2-45bf-83fc-95e0a69791d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa849280200>]}
[0m14:05:07.552207 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:05:07.561208 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:05:07.597039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fc58a16-4ce2-45bf-83fc-95e0a69791d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa843fb2ae0>]}
[0m14:05:07.598489 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m14:05:07.599903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fc58a16-4ce2-45bf-83fc-95e0a69791d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa843f87080>]}
[0m14:05:07.604172 [info ] [MainThread]: 
[0m14:05:07.606328 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:05:07.607735 [info ] [MainThread]: 
[0m14:05:07.609319 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:05:07.615207 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m14:05:07.663237 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m14:05:07.664830 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m14:05:07.666258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:09.157759 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.491 seconds
[0m14:05:09.162561 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR, now list_MFG_ACCELERATOR_ANALYTICS_analytics)
[0m14:05:09.179544 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m14:05:09.181632 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m14:05:09.560911 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.377 seconds
[0m14:05:09.566283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fc58a16-4ce2-45bf-83fc-95e0a69791d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8482999d0>]}
[0m14:05:09.574322 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.stg_batches
[0m14:05:09.574996 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.stg_materials
[0m14:05:09.575611 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.stg_production_orders
[0m14:05:09.577096 [info ] [Thread-1 (]: 1 of 8 START sql view model ANALYTICS_analytics.stg_batches .................... [RUN]
[0m14:05:09.579019 [info ] [Thread-2 (]: 2 of 8 START sql view model ANALYTICS_analytics.stg_materials .................. [RUN]
[0m14:05:09.580842 [info ] [Thread-3 (]: 3 of 8 START sql view model ANALYTICS_analytics.stg_production_orders .......... [RUN]
[0m14:05:09.582590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now model.mfg_accelerator.stg_batches)
[0m14:05:09.584133 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_materials'
[0m14:05:09.585487 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_production_orders'
[0m14:05:09.587301 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.stg_batches
[0m14:05:09.589676 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.stg_materials
[0m14:05:09.591354 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.stg_production_orders
[0m14:05:09.601282 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.stg_batches"
[0m14:05:09.671207 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.stg_materials"
[0m14:05:09.676123 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.stg_production_orders"
[0m14:05:09.684415 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.stg_production_orders
[0m14:05:09.685306 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.stg_batches
[0m14:05:09.697814 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.stg_materials
[0m14:05:09.744440 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.stg_materials"
[0m14:05:09.750135 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.stg_batches"
[0m14:05:09.750934 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.stg_production_orders"
[0m14:05:09.761325 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.stg_materials"
[0m14:05:09.764473 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.stg_batches"
[0m14:05:09.765197 [debug] [Thread-2 (]: On model.mfg_accelerator.stg_materials: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
  
  
  
  
  as (
    -- stg_materials.sql
-- Purpose:
--  - Create a clean, standardized view of materials
--  - Apply basic typing and naming conventions
--  - This is the first "T" step after RAW

with source as (

    -- Pull data from the RAW.MATERIALS table registered as a source
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        status,
        created_at
    from MFG_ACCELERATOR.RAW.materials

),

renamed as (

    -- Apply any renaming / typing here
    select
        material_id                as material_id,        -- keep same, but explicitly select
        material_name              as material_name,
        material_type              as material_type,
        unit_of_measure            as unit_of_measure,
        status                     as material_status,    -- rename to avoid generic 'status'
        cast(created_at as date)   as created_at
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_materials"} */;
[0m14:05:09.766994 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.stg_production_orders"
[0m14:05:09.768697 [debug] [Thread-1 (]: On model.mfg_accelerator.stg_batches: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
  
  
  
  
  as (
    -- stg_batches.sql
-- Purpose:
--  - Clean and standardize batch data
--  - Ensure dates and numeric types are correct

with source as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.RAW.batches

),

renamed as (

    select
        batch_id                         as batch_id,
        material_id                      as material_id,
        manufacturing_site               as manufacturing_site,
        cast(manufacture_date as date)   as manufacture_date,
        cast(expiry_date as date)        as expiry_date,
        cast(quantity as number)         as quantity,
        batch_status                     as batch_status
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_batches"} */;
[0m14:05:09.771043 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:05:09.773568 [debug] [Thread-3 (]: On model.mfg_accelerator.stg_production_orders: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
  
  
  
  
  as (
    -- stg_production_orders.sql
-- Purpose:
--  - Clean and standardize production order data
--  - Ensure date fields and statuses are typed and named consistently

with source as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.RAW.production_orders

),

renamed as (

    select
        order_id                               as order_id,
        batch_id                               as batch_id,
        order_type                             as order_type,
        cast(planned_start_date as date)       as planned_start_date,
        cast(planned_end_date as date)         as planned_end_date,
        cast(actual_start_date as date)        as actual_start_date,
        cast(actual_end_date as date)          as actual_end_date,
        order_status                           as order_status,
        line_id                                as line_id
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_production_orders"} */;
[0m14:05:09.783670 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:05:10.331958 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.557 seconds
[0m14:05:10.396676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fc58a16-4ce2-45bf-83fc-95e0a69791d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8680cf020>]}
[0m14:05:10.398576 [info ] [Thread-1 (]: 1 of 8 OK created sql view model ANALYTICS_analytics.stg_batches ............... [[32mSUCCESS 1[0m in 0.81s]
[0m14:05:10.400416 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.stg_batches
[0m14:05:11.612672 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.842 seconds
[0m14:05:11.618745 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fc58a16-4ce2-45bf-83fc-95e0a69791d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8680cf020>]}
[0m14:05:11.621456 [info ] [Thread-2 (]: 2 of 8 OK created sql view model ANALYTICS_analytics.stg_materials ............. [[32mSUCCESS 1[0m in 2.03s]
[0m14:05:11.624011 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.stg_materials
[0m14:05:11.626410 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.core_materials
[0m14:05:11.628585 [info ] [Thread-4 (]: 4 of 8 START sql table model ANALYTICS_analytics.core_materials ................ [RUN]
[0m14:05:11.631139 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.mfg_accelerator.core_materials'
[0m14:05:11.633254 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.core_materials
[0m14:05:11.641311 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.core_materials"
[0m14:05:11.648498 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.865 seconds
[0m14:05:11.657433 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fc58a16-4ce2-45bf-83fc-95e0a69791d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa848706810>]}
[0m14:05:11.661315 [info ] [Thread-3 (]: 3 of 8 OK created sql view model ANALYTICS_analytics.stg_production_orders ..... [[32mSUCCESS 1[0m in 2.07s]
[0m14:05:11.662857 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.core_materials
[0m14:05:11.664947 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.stg_production_orders
[0m14:05:11.700425 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.core_materials"
[0m14:05:11.712846 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.core_materials"
[0m14:05:11.714045 [debug] [Thread-4 (]: On model.mfg_accelerator.core_materials: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
    
    
    
    as (-- core_materials.sql
-- Purpose:
--  - Create a cleaned, enriched material dimension
--  - Add simple derived attributes (e.g. is_active flag, age)

with base as (

    -- Use the staging view as the single source of truth for materials
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,
        created_at
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials

),

enriched as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,

        created_at,

        -- Age of the material definition in days
        datediff('day', created_at, current_date()) as material_age_days,

        -- Simple flag to say if the material is considered active
        case
            when upper(material_status) = 'ACTIVE' then 1
            else 0
        end as is_active_material
    from base

)

select * from enriched
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_materials"} */;
[0m14:05:11.715050 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:05:13.815694 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.101 seconds
[0m14:05:13.819538 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fc58a16-4ce2-45bf-83fc-95e0a69791d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8654687d0>]}
[0m14:05:13.821783 [info ] [Thread-4 (]: 4 of 8 OK created sql table model ANALYTICS_analytics.core_materials ........... [[32mSUCCESS 1[0m in 2.19s]
[0m14:05:13.824192 [debug] [Thread-4 (]: Finished running node model.mfg_accelerator.core_materials
[0m14:05:13.826412 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.core_batches
[0m14:05:13.827405 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.fct_production_orders
[0m14:05:13.828483 [info ] [Thread-2 (]: 5 of 8 START sql table model ANALYTICS_analytics.core_batches .................. [RUN]
[0m14:05:13.830224 [info ] [Thread-1 (]: 6 of 8 START sql table model ANALYTICS_analytics.fct_production_orders ......... [RUN]
[0m14:05:13.831644 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_materials, now model.mfg_accelerator.core_batches)
[0m14:05:13.833075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_batches, now model.mfg_accelerator.fct_production_orders)
[0m14:05:13.834633 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.core_batches
[0m14:05:13.836115 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.fct_production_orders
[0m14:05:13.842128 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.core_batches"
[0m14:05:13.846778 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.fct_production_orders"
[0m14:05:13.856526 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.core_batches
[0m14:05:13.861735 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.core_batches"
[0m14:05:13.862343 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.fct_production_orders
[0m14:05:13.867447 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.fct_production_orders"
[0m14:05:13.877123 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.core_batches"
[0m14:05:13.880487 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.fct_production_orders"
[0m14:05:13.881766 [debug] [Thread-2 (]: On model.mfg_accelerator.core_batches: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    
    
    
    as (-- core_batches.sql
-- Purpose:
--  - Combine batch info with material attributes
--  - Add shelf-life and expiry-related metrics

with batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        b.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        -- Shelf life in days = expiry - manufacture
        datediff('day', manufacture_date, expiry_date) as shelf_life_days,

        -- Batch age in days from manufacture date until today
        datediff('day', manufacture_date, current_date()) as batch_age_days,

        -- Days until expiry (can be negative if already expired)
        datediff('day', current_date(), expiry_date) as days_to_expiry,

        case
            when current_date() > expiry_date then 1
            else 0
        end as is_expired
    from batches b
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_batches"} */;
[0m14:05:13.883429 [debug] [Thread-1 (]: On model.mfg_accelerator.fct_production_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    
    
    
    as (-- fct_production_orders.sql
-- Purpose:
--  - Fact-like table combining production orders with batch and material context
--  - Compute planned vs actual durations and simple on-time indicators

with orders as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders

),

batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        o.order_id,
        o.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        o.order_type,
        o.line_id,
        o.order_status,

        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        -- Planned duration in days
        datediff('day', planned_start_date, planned_end_date) as planned_duration_days,

        -- Actual duration in days (null if no end date)
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', actual_start_date, actual_end_date)
            else null
        end as actual_duration_days,

        -- Delay vs plan: how many days longer the actual duration was
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', planned_end_date, actual_end_date)
            else null
        end as delay_vs_plan_days,

        -- Simple late flag: 1 if order completed after planned_end_date
        case
            when actual_end_date is not null
             and actual_end_date > planned_end_date
            then 1
            else 0
        end as is_late,

        -- Is the order completed?
        case
            when upper(order_status) = 'COMPLETED' then 1
            else 0
        end as is_completed
    from orders o
    left join batches b
        on o.batch_id = b.batch_id
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.fct_production_orders"} */;
[0m14:05:15.262591 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.378 seconds
[0m14:05:15.266806 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fc58a16-4ce2-45bf-83fc-95e0a69791d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa843e0ef00>]}
[0m14:05:15.268565 [info ] [Thread-2 (]: 5 of 8 OK created sql table model ANALYTICS_analytics.core_batches ............. [[32mSUCCESS 1[0m in 1.44s]
[0m14:05:15.270467 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.core_batches
[0m14:05:16.073685 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.186 seconds
[0m14:05:16.079304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fc58a16-4ce2-45bf-83fc-95e0a69791d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa84308ab10>]}
[0m14:05:16.081227 [info ] [Thread-1 (]: 6 of 8 OK created sql table model ANALYTICS_analytics.fct_production_orders .... [[32mSUCCESS 1[0m in 2.25s]
[0m14:05:16.083047 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.fct_production_orders
[0m14:05:16.085007 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.mfg_ml_features_orders
[0m14:05:16.085795 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:05:16.087254 [info ] [Thread-4 (]: 7 of 8 START sql table model ANALYTICS_analytics.mfg_ml_features_orders ........ [RUN]
[0m14:05:16.091316 [info ] [Thread-3 (]: 8 of 8 START sql table model ANALYTICS_analytics.mfg_plant_daily_kpis .......... [RUN]
[0m14:05:16.093592 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.core_materials, now model.mfg_accelerator.mfg_ml_features_orders)
[0m14:05:16.095487 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_production_orders, now model.mfg_accelerator.mfg_plant_daily_kpis)
[0m14:05:16.097070 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.mfg_ml_features_orders
[0m14:05:16.098435 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:05:16.103640 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:05:16.112113 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:05:16.120004 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:05:16.122950 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.mfg_ml_features_orders
[0m14:05:16.130401 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:05:16.134202 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:05:16.148938 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:05:16.152049 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:05:16.153569 [debug] [Thread-3 (]: On model.mfg_accelerator.mfg_plant_daily_kpis: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
    
    
    
    as (-- mfg_plant_daily_kpis.sql
-- Purpose:
--  - Provide daily plant-level KPIs for manufacturing performance monitoring
--  - Aggregates metrics from core_batches and fct_production_orders
-- Grain:
--  - One row per (manufacturing_site, calendar_date)

with calendar_days as (

    -- Build a simple date spine based on manufacture_date and planned/actual dates
    -- This ensures we have a consistent daily grain for metrics.

    select
        -- Use the earliest relevant date from batches and orders
        least(
            min(b.manufacture_date),
            min(o.planned_start_date)
        ) as min_date,
        greatest(
            max(b.manufacture_date),
            max(o.planned_end_date)
        ) as max_date
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    cross join MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o

),

date_spine as (

    -- Generate a list of dates between min_date and max_date
    -- Snowflake-specific generator using TABLE(GENERATOR)
    select
        dateadd(
            day,
            seq4(),
            min_date
        ) as calendar_date
    from calendar_days,
         table(generator(rowcount => datediff('day', min_date, max_date) + 1))

),

batches_by_day as (

    -- Aggregate batch metrics at (manufacturing_site, calendar_date)
    select
        b.manufacturing_site,
        b.manufacture_date as calendar_date,

        count(*) as total_batches,
        sum(b.quantity) as total_quantity,

        sum(case when b.is_expired = 1 then 1 else 0 end) as expired_batches
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    group by
        b.manufacturing_site,
        b.manufacture_date

),

orders_by_day as (

    -- Aggregate order metrics at (manufacturing_site, calendar_date)
    -- We'll use planned_start_date as the main "date" for the order
    select
        b.manufacturing_site,
        o.planned_start_date as calendar_date,

        count(*) as total_orders,
        sum(case when o.is_completed = 1 then 1 else 0 end) as completed_orders,
        sum(case when o.is_late = 1 then 1 else 0 end) as late_orders,

        avg(o.delay_vs_plan_days) as avg_delay_vs_plan_days
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o
    left join MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
        on o.batch_id = b.batch_id
    group by
        b.manufacturing_site,
        o.planned_start_date

),

combined as (

    -- Combine batch and order metrics on (site, date)
    select
        coalesce(b.manufacturing_site, o.manufacturing_site) as manufacturing_site,
        coalesce(b.calendar_date, o.calendar_date) as calendar_date,

        -- Batch metrics
        coalesce(b.total_batches, 0) as total_batches,
        coalesce(b.total_quantity, 0) as total_quantity,
        coalesce(b.expired_batches, 0) as expired_batches,

        -- Order metrics
        coalesce(o.total_orders, 0) as total_orders,
        coalesce(o.completed_orders, 0) as completed_orders,
        coalesce(o.late_orders, 0) as late_orders,
        o.avg_delay_vs_plan_days as avg_delay_vs_plan_days
    from batches_by_day b
    full outer join orders_by_day o
        on  b.manufacturing_site = o.manufacturing_site
        and b.calendar_date = o.calendar_date

),

final as (

    select
        manufacturing_site,
        calendar_date,

        total_batches,
        total_quantity,
        expired_batches,

        total_orders,
        completed_orders,
        late_orders,
        avg_delay_vs_plan_days,

        -- On-time rate: percentage of completed orders that were not late
        case
            when completed_orders > 0 then
                1.0 - (late_orders::float / completed_orders::float)
            else null
        end as on_time_rate
    from combined
    where manufacturing_site is not null
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_plant_daily_kpis"} */;
[0m14:05:16.157885 [debug] [Thread-4 (]: On model.mfg_accelerator.mfg_ml_features_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
    
    
    
    as (-- mfg_ml_features_orders.sql
-- Purpose:
--  - Provide ML-ready features at order grain
--  - Target use case: predict late orders or delay vs plan
-- Grain:
--  - One row per production order (order_id)

with orders as (

    select
        order_id,
        batch_id,
        material_id,

        manufacturing_site,
        line_id,

        order_type,
        order_status,

        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,

        planned_duration_days,
        actual_duration_days,
        delay_vs_plan_days,
        is_late,
        is_completed
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders

),

materials as (

    select
        material_id,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

batches as (

    select
        batch_id,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches

),

joined as (

    select
        o.order_id,

        -- Keys and IDs
        o.batch_id,
        o.material_id,

        -- Plant / line / type
        o.manufacturing_site,
        o.line_id,
        o.order_type,
        o.order_status,

        -- Material features
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        -- Batch features
        b.quantity,
        b.batch_status,
        b.shelf_life_days,
        b.batch_age_days,
        b.days_to_expiry,
        b.is_expired,

        -- Temporal features
        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        o.planned_duration_days,
        o.actual_duration_days,
        o.delay_vs_plan_days,

        -- Labels / targets
        o.is_late,
        o.is_completed
    from orders o
    left join materials m
        on o.material_id = m.material_id
    left join batches b
        on o.batch_id = b.batch_id

),

final as (

    select
        -- Primary key
        order_id,

        -- Categorical features
        manufacturing_site,
        line_id,
        order_type,
        order_status,
        material_type,
        unit_of_measure,
        batch_status,

        -- Material state
        is_active_material,

        -- Quantitative batch features
        quantity,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired,

        -- Temporal planning features
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        planned_duration_days,
        actual_duration_days,

        -- Label / target variables
        delay_vs_plan_days,
        is_late,
        is_completed
    from joined
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_ml_features_orders"} */;
[0m14:05:17.466011 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.306 seconds
[0m14:05:17.469720 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fc58a16-4ce2-45bf-83fc-95e0a69791d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa843092f30>]}
[0m14:05:17.472132 [info ] [Thread-3 (]: 8 of 8 OK created sql table model ANALYTICS_analytics.mfg_plant_daily_kpis ..... [[32mSUCCESS 1[0m in 1.37s]
[0m14:05:17.474556 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:05:17.562120 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.400 seconds
[0m14:05:17.565962 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fc58a16-4ce2-45bf-83fc-95e0a69791d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8430a7380>]}
[0m14:05:17.567754 [info ] [Thread-4 (]: 7 of 8 OK created sql table model ANALYTICS_analytics.mfg_ml_features_orders ... [[32mSUCCESS 1[0m in 1.47s]
[0m14:05:17.569922 [debug] [Thread-4 (]: Finished running node model.mfg_accelerator.mfg_ml_features_orders
[0m14:05:17.574150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:17.575923 [debug] [MainThread]: Connection 'model.mfg_accelerator.fct_production_orders' was left open.
[0m14:05:17.577376 [debug] [MainThread]: On model.mfg_accelerator.fct_production_orders: Close
[0m14:05:17.998402 [debug] [MainThread]: Connection 'model.mfg_accelerator.core_batches' was left open.
[0m14:05:18.010379 [debug] [MainThread]: On model.mfg_accelerator.core_batches: Close
[0m14:05:18.457240 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_plant_daily_kpis' was left open.
[0m14:05:18.459412 [debug] [MainThread]: On model.mfg_accelerator.mfg_plant_daily_kpis: Close
[0m14:05:18.920092 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_ml_features_orders' was left open.
[0m14:05:18.922858 [debug] [MainThread]: On model.mfg_accelerator.mfg_ml_features_orders: Close
[0m14:05:19.341195 [info ] [MainThread]: 
[0m14:05:19.343390 [info ] [MainThread]: Finished running 5 table models, 3 view models in 0 hours 0 minutes and 11.73 seconds (11.73s).
[0m14:05:19.346965 [debug] [MainThread]: Command end result
[0m14:05:19.415218 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:05:19.422949 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:05:19.437012 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m14:05:19.438861 [info ] [MainThread]: 
[0m14:05:19.440984 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:19.442299 [info ] [MainThread]: 
[0m14:05:19.443650 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m14:05:19.445864 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.71813, "process_in_blocks": "0", "process_kernel_time": 1.311729, "process_mem_max_rss": "221724", "process_out_blocks": "16", "process_user_time": 4.985376}
[0m14:05:19.447407 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:19.447286 after 13.72 seconds
[0m14:05:19.448826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa865833fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa866983ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa866dd3320>]}
[0m14:05:19.450235 [debug] [MainThread]: Flushing usage events
[0m14:05:20.204087 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:05:24.291428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e92118c3cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e92118c2870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e92117e1850>]}


============================== 14:05:24.301360 | d01ed73f-cd11-4c8f-a2c8-2700bbe719de ==============================
[0m14:05:24.301360 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:05:24.303413 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt_profiles', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'log_format': 'default', 'target_path': 'None', 'quiet': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'no_print': 'None', 'empty': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'static_parser': 'True', 'use_colors': 'True', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m14:05:25.428658 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:05:25.430711 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:05:25.432538 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:05:25.706697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd01ed73f-cd11-4c8f-a2c8-2700bbe719de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e91f505dc70>]}
[0m14:05:25.797692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd01ed73f-cd11-4c8f-a2c8-2700bbe719de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e91f44f5c70>]}
[0m14:05:25.799985 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m14:05:26.008995 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:05:26.540039 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:05:26.542256 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:05:26.621002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd01ed73f-cd11-4c8f-a2c8-2700bbe719de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e91f43051c0>]}
[0m14:05:26.833313 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:05:26.843905 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:05:26.893152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd01ed73f-cd11-4c8f-a2c8-2700bbe719de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e91efe9f110>]}
[0m14:05:26.894738 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m14:05:26.895915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd01ed73f-cd11-4c8f-a2c8-2700bbe719de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e91f43f9880>]}
[0m14:05:26.899783 [info ] [MainThread]: 
[0m14:05:26.900713 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:05:26.901888 [info ] [MainThread]: 
[0m14:05:26.903678 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:05:26.911720 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m14:05:26.977377 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m14:05:26.978997 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m14:05:26.980359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:28.472636 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.495 seconds
[0m14:05:28.478472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd01ed73f-cd11-4c8f-a2c8-2700bbe719de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e91f44cdca0>]}
[0m14:05:28.486038 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m14:05:28.486748 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m14:05:28.487361 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m14:05:28.488086 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m14:05:28.489159 [info ] [Thread-1 (]: 1 of 24 START test not_null_core_batches_batch_id .............................. [RUN]
[0m14:05:28.491016 [info ] [Thread-2 (]: 2 of 24 START test not_null_core_batches_material_id ........................... [RUN]
[0m14:05:28.492774 [info ] [Thread-3 (]: 3 of 24 START test not_null_core_materials_material_id ......................... [RUN]
[0m14:05:28.494426 [info ] [Thread-4 (]: 4 of 24 START test not_null_fct_production_orders_batch_id ..................... [RUN]
[0m14:05:28.495967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c)
[0m14:05:28.497602 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e'
[0m14:05:28.499131 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8'
[0m14:05:28.500560 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1'
[0m14:05:28.502037 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m14:05:28.503368 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m14:05:28.505120 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m14:05:28.506820 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m14:05:28.525788 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m14:05:28.530483 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m14:05:28.535815 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m14:05:28.541519 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m14:05:28.551193 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m14:05:28.552285 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m14:05:28.553768 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m14:05:28.559712 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m14:05:28.583875 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m14:05:28.584382 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m14:05:28.589892 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m14:05:28.594107 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m14:05:28.604010 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m14:05:28.605277 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m14:05:28.607021 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m14:05:28.607726 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"} */
[0m14:05:28.609199 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m14:05:28.610897 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"} */
[0m14:05:28.612516 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"} */
[0m14:05:28.614233 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:05:28.615707 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"} */
[0m14:05:28.617157 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:05:28.624456 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:05:28.991936 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.373 seconds
[0m14:05:29.003231 [info ] [Thread-1 (]: 1 of 24 PASS not_null_core_batches_batch_id .................................... [[32mPASS[0m in 0.51s]
[0m14:05:29.005418 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m14:05:29.007078 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m14:05:29.008698 [info ] [Thread-1 (]: 5 of 24 START test not_null_fct_production_orders_order_id ..................... [RUN]
[0m14:05:29.010333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c, now test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f)
[0m14:05:29.011775 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m14:05:29.017358 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m14:05:29.031374 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m14:05:29.035562 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m14:05:29.047739 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m14:05:29.049166 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"} */
[0m14:05:29.438815 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.388 seconds
[0m14:05:29.442124 [info ] [Thread-1 (]: 5 of 24 PASS not_null_fct_production_orders_order_id ........................... [[32mPASS[0m in 0.43s]
[0m14:05:29.443740 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m14:05:29.445225 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:05:29.446700 [info ] [Thread-1 (]: 6 of 24 START test not_null_mfg_ml_features_orders_order_id .................... [RUN]
[0m14:05:29.448151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f, now test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213)
[0m14:05:29.449536 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:05:29.455491 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m14:05:29.469558 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:05:29.473807 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m14:05:29.485869 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m14:05:29.487783 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"} */
[0m14:05:29.899631 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.285 seconds
[0m14:05:29.904168 [info ] [Thread-3 (]: 3 of 24 PASS not_null_core_materials_material_id ............................... [[32mPASS[0m in 1.40s]
[0m14:05:29.906168 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m14:05:29.907705 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:05:29.909201 [info ] [Thread-3 (]: 7 of 24 START test not_null_mfg_plant_daily_kpis_calendar_date ................. [RUN]
[0m14:05:29.910940 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8)
[0m14:05:29.912401 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:05:29.917823 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m14:05:29.919148 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.430 seconds
[0m14:05:29.924644 [info ] [Thread-1 (]: 6 of 24 PASS not_null_mfg_ml_features_orders_order_id .......................... [[32mPASS[0m in 0.48s]
[0m14:05:29.926676 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:05:29.928221 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:05:29.929654 [info ] [Thread-1 (]: 8 of 24 START test not_null_mfg_plant_daily_kpis_manufacturing_site ............ [RUN]
[0m14:05:29.931141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68)
[0m14:05:29.932680 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:05:29.933773 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:05:29.940623 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m14:05:29.946052 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m14:05:29.958898 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:05:29.960181 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m14:05:29.964093 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m14:05:29.965591 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select calendar_date
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where calendar_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"} */
[0m14:05:29.979167 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m14:05:29.980597 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturing_site
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where manufacturing_site is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"} */
[0m14:05:30.107072 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.483 seconds
[0m14:05:30.110248 [info ] [Thread-4 (]: 4 of 24 PASS not_null_fct_production_orders_batch_id ........................... [[32mPASS[0m in 1.61s]
[0m14:05:30.111883 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m14:05:30.113375 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m14:05:30.114763 [info ] [Thread-4 (]: 9 of 24 START test not_null_stg_batches_batch_id ............................... [RUN]
[0m14:05:30.116450 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1, now test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0)
[0m14:05:30.118077 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m14:05:30.123459 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m14:05:30.136417 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m14:05:30.141948 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m14:05:30.155241 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m14:05:30.156574 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"} */
[0m14:05:30.190937 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.574 seconds
[0m14:05:30.194428 [info ] [Thread-2 (]: 2 of 24 PASS not_null_core_batches_material_id ................................. [[32mPASS[0m in 1.70s]
[0m14:05:30.196263 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m14:05:30.197796 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m14:05:30.199290 [info ] [Thread-2 (]: 10 of 24 START test not_null_stg_batches_material_id ........................... [RUN]
[0m14:05:30.201000 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e, now test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c)
[0m14:05:30.202506 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m14:05:30.207851 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m14:05:30.221743 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m14:05:30.225592 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m14:05:30.238442 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m14:05:30.239717 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"} */
[0m14:05:30.459990 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.478 seconds
[0m14:05:30.463245 [info ] [Thread-1 (]: 8 of 24 PASS not_null_mfg_plant_daily_kpis_manufacturing_site .................. [[32mPASS[0m in 0.53s]
[0m14:05:30.465051 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:05:30.466596 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m14:05:30.468395 [info ] [Thread-1 (]: 11 of 24 START test not_null_stg_materials_material_id ......................... [RUN]
[0m14:05:30.470757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68, now test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89)
[0m14:05:30.472225 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m14:05:30.477889 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m14:05:30.490408 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m14:05:30.496539 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m14:05:30.515007 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m14:05:30.517455 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"} */
[0m14:05:30.534281 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.376 seconds
[0m14:05:30.538562 [info ] [Thread-4 (]: 9 of 24 PASS not_null_stg_batches_batch_id ..................................... [[32mPASS[0m in 0.42s]
[0m14:05:30.540814 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m14:05:30.542602 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m14:05:30.544233 [info ] [Thread-4 (]: 12 of 24 START test not_null_stg_production_orders_batch_id .................... [RUN]
[0m14:05:30.546071 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0, now test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5)
[0m14:05:30.547645 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m14:05:30.554115 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m14:05:30.575661 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m14:05:30.582162 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m14:05:30.595989 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m14:05:30.597574 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"} */
[0m14:05:30.876474 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.908 seconds
[0m14:05:30.879659 [info ] [Thread-3 (]: 7 of 24 PASS not_null_mfg_plant_daily_kpis_calendar_date ....................... [[32mPASS[0m in 0.97s]
[0m14:05:30.881348 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:05:30.882773 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m14:05:30.884134 [info ] [Thread-3 (]: 13 of 24 START test not_null_stg_production_orders_order_id .................... [RUN]
[0m14:05:30.885520 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8, now test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284)
[0m14:05:30.887008 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m14:05:30.892908 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m14:05:30.895799 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.376 seconds
[0m14:05:30.900410 [info ] [Thread-1 (]: 11 of 24 PASS not_null_stg_materials_material_id ............................... [[32mPASS[0m in 0.43s]
[0m14:05:30.902749 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m14:05:30.904880 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m14:05:30.906688 [info ] [Thread-1 (]: 14 of 24 START test relationships_core_batches_material_id__material_id__ref_core_materials_  [RUN]
[0m14:05:30.908536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89, now test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6)
[0m14:05:30.910277 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m14:05:30.911751 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.671 seconds
[0m14:05:30.912554 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m14:05:30.922422 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m14:05:30.925415 [info ] [Thread-2 (]: 10 of 24 PASS not_null_stg_batches_material_id ................................. [[32mPASS[0m in 0.72s]
[0m14:05:30.929632 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m14:05:30.932516 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m14:05:30.935594 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m14:05:30.937863 [info ] [Thread-2 (]: 15 of 24 START test relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [RUN]
[0m14:05:30.940623 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c, now test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d)
[0m14:05:30.942591 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m14:05:30.950787 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m14:05:30.952758 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m14:05:30.957275 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m14:05:30.958346 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m14:05:30.961858 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"} */
[0m14:05:30.972994 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m14:05:30.973744 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m14:05:30.975044 [debug] [Thread-1 (]: On test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"} */
[0m14:05:30.978941 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m14:05:30.993935 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m14:05:30.995384 [debug] [Thread-2 (]: On test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"} */
[0m14:05:31.014288 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.415 seconds
[0m14:05:31.017822 [info ] [Thread-4 (]: 12 of 24 PASS not_null_stg_production_orders_batch_id .......................... [[32mPASS[0m in 0.47s]
[0m14:05:31.019800 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m14:05:31.021255 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m14:05:31.022725 [info ] [Thread-4 (]: 16 of 24 START test relationships_stg_batches_material_id__material_id__ref_stg_materials_  [RUN]
[0m14:05:31.024304 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5, now test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2)
[0m14:05:31.025611 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m14:05:31.031789 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m14:05:31.045417 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m14:05:31.049425 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m14:05:31.064553 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m14:05:31.065876 [debug] [Thread-4 (]: On test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"} */
[0m14:05:31.406752 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.443 seconds
[0m14:05:31.411794 [info ] [Thread-3 (]: 13 of 24 PASS not_null_stg_production_orders_order_id .......................... [[32mPASS[0m in 0.53s]
[0m14:05:31.414196 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m14:05:31.416019 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m14:05:31.418161 [info ] [Thread-3 (]: 17 of 24 START test relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [RUN]
[0m14:05:31.420243 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284, now test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519)
[0m14:05:31.422011 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m14:05:31.430005 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m14:05:31.444297 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m14:05:31.450116 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m14:05:31.464033 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m14:05:31.465370 [debug] [Thread-3 (]: On test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"} */
[0m14:05:31.538177 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.542 seconds
[0m14:05:31.541496 [info ] [Thread-2 (]: 15 of 24 PASS relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [[32mPASS[0m in 0.60s]
[0m14:05:31.543270 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m14:05:31.544795 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m14:05:31.546146 [info ] [Thread-2 (]: 18 of 24 START test unique_core_batches_batch_id ............................... [RUN]
[0m14:05:31.547651 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d, now test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf)
[0m14:05:31.549282 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m14:05:31.557063 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m14:05:31.571868 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m14:05:31.575599 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m14:05:31.588510 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m14:05:31.589894 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"} */
[0m14:05:31.670048 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.689 seconds
[0m14:05:31.673936 [info ] [Thread-1 (]: 14 of 24 PASS relationships_core_batches_material_id__material_id__ref_core_materials_  [[32mPASS[0m in 0.77s]
[0m14:05:31.675974 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m14:05:31.677682 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m14:05:31.679120 [info ] [Thread-1 (]: 19 of 24 START test unique_core_materials_material_id .......................... [RUN]
[0m14:05:31.680647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6, now test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2)
[0m14:05:31.682050 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m14:05:31.687258 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m14:05:31.697162 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m14:05:31.701051 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m14:05:31.713570 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m14:05:31.714716 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"} */
[0m14:05:31.934586 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.468 seconds
[0m14:05:31.938657 [info ] [Thread-3 (]: 17 of 24 PASS relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [[32mPASS[0m in 0.52s]
[0m14:05:31.940806 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m14:05:31.942335 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m14:05:31.943653 [info ] [Thread-3 (]: 20 of 24 START test unique_fct_production_orders_order_id ...................... [RUN]
[0m14:05:31.945096 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519, now test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442)
[0m14:05:31.946410 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m14:05:31.951436 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m14:05:31.961978 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m14:05:31.965870 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m14:05:31.978965 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m14:05:31.980225 [debug] [Thread-3 (]: On test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"} */
[0m14:05:32.004045 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.937 seconds
[0m14:05:32.007919 [info ] [Thread-4 (]: 16 of 24 PASS relationships_stg_batches_material_id__material_id__ref_stg_materials_  [[32mPASS[0m in 0.98s]
[0m14:05:32.009813 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m14:05:32.011295 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:05:32.012817 [info ] [Thread-4 (]: 21 of 24 START test unique_mfg_ml_features_orders_order_id ..................... [RUN]
[0m14:05:32.014422 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2, now test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd)
[0m14:05:32.016007 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:05:32.022085 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m14:05:32.034315 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:05:32.038743 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m14:05:32.040062 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.449 seconds
[0m14:05:32.044231 [info ] [Thread-2 (]: 18 of 24 PASS unique_core_batches_batch_id ..................................... [[32mPASS[0m in 0.50s]
[0m14:05:32.046159 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m14:05:32.047620 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m14:05:32.049159 [info ] [Thread-2 (]: 22 of 24 START test unique_stg_batches_batch_id ................................ [RUN]
[0m14:05:32.050829 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf, now test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4)
[0m14:05:32.052483 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m14:05:32.054219 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m14:05:32.060902 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m14:05:32.062253 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"} */
[0m14:05:32.078606 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m14:05:32.084803 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m14:05:32.086262 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.370 seconds
[0m14:05:32.091715 [info ] [Thread-1 (]: 19 of 24 PASS unique_core_materials_material_id ................................ [[32mPASS[0m in 0.41s]
[0m14:05:32.093864 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m14:05:32.095602 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m14:05:32.097418 [info ] [Thread-1 (]: 23 of 24 START test unique_stg_materials_material_id ........................... [RUN]
[0m14:05:32.099308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2, now test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21)
[0m14:05:32.101406 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m14:05:32.103485 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m14:05:32.109554 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m14:05:32.111212 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"} */
[0m14:05:32.129395 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m14:05:32.134735 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m14:05:32.149467 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m14:05:32.151082 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"} */
[0m14:05:32.511843 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.446 seconds
[0m14:05:32.515894 [info ] [Thread-4 (]: 21 of 24 PASS unique_mfg_ml_features_orders_order_id ........................... [[32mPASS[0m in 0.50s]
[0m14:05:32.518152 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:05:32.520024 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m14:05:32.521821 [info ] [Thread-4 (]: 24 of 24 START test unique_stg_production_orders_order_id ...................... [RUN]
[0m14:05:32.523817 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd, now test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3)
[0m14:05:32.527332 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.374 seconds
[0m14:05:32.528242 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m14:05:32.532832 [info ] [Thread-1 (]: 23 of 24 PASS unique_stg_materials_material_id ................................. [[32mPASS[0m in 0.43s]
[0m14:05:32.538576 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m14:05:32.540469 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m14:05:32.548462 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.566 seconds
[0m14:05:32.553515 [info ] [Thread-3 (]: 20 of 24 PASS unique_fct_production_orders_order_id ............................ [[32mPASS[0m in 0.61s]
[0m14:05:32.555903 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m14:05:32.556965 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m14:05:32.559487 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.445 seconds
[0m14:05:32.564073 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m14:05:32.567642 [info ] [Thread-2 (]: 22 of 24 PASS unique_stg_batches_batch_id ...................................... [[32mPASS[0m in 0.52s]
[0m14:05:32.570580 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m14:05:32.579780 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m14:05:32.581062 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"} */
[0m14:05:33.005133 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.423 seconds
[0m14:05:33.008490 [info ] [Thread-4 (]: 24 of 24 PASS unique_stg_production_orders_order_id ............................ [[32mPASS[0m in 0.48s]
[0m14:05:33.010212 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m14:05:33.013532 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:33.015136 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21' was left open.
[0m14:05:33.016679 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: Close
[0m14:05:33.434568 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4' was left open.
[0m14:05:33.436424 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: Close
[0m14:05:33.854347 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442' was left open.
[0m14:05:33.856077 [debug] [MainThread]: On test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442: Close
[0m14:05:34.291257 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3' was left open.
[0m14:05:34.292866 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: Close
[0m14:05:34.717581 [info ] [MainThread]: 
[0m14:05:34.719635 [info ] [MainThread]: Finished running 24 data tests in 0 hours 0 minutes and 7.81 seconds (7.81s).
[0m14:05:34.727138 [debug] [MainThread]: Command end result
[0m14:05:34.794613 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:05:34.801926 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:05:34.817763 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m14:05:34.819172 [info ] [MainThread]: 
[0m14:05:34.820873 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:34.822277 [info ] [MainThread]: 
[0m14:05:34.823649 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=24
[0m14:05:34.825733 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 10.705065, "process_in_blocks": "0", "process_kernel_time": 1.447355, "process_mem_max_rss": "224444", "process_out_blocks": "16", "process_user_time": 5.797507}
[0m14:05:34.827192 [debug] [MainThread]: Command `dbt test` succeeded at 14:05:34.827038 after 10.71 seconds
[0m14:05:34.828795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e92114e42f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9214022630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e92117e1850>]}
[0m14:05:34.830365 [debug] [MainThread]: Flushing usage events
[0m14:05:35.479803 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:25:36.883296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4043d013a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4045a81310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4044edecf0>]}


============================== 14:25:36.892889 | 4928dff0-731e-4f89-9a94-bec6af123903 ==============================
[0m14:25:36.892889 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:25:36.894774 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'quiet': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'profiles_dir': '/opt/airflow/dbt_profiles', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'version_check': 'True', 'use_colors': 'True', 'debug': 'False', 'target_path': 'None', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'warn_error': 'None', 'write_json': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt_profiles'}
[0m14:25:37.652878 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:25:37.654373 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:25:37.655625 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:25:37.875647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4928dff0-731e-4f89-9a94-bec6af123903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4022263aa0>]}
[0m14:25:37.950972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4928dff0-731e-4f89-9a94-bec6af123903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a404314a810>]}
[0m14:25:37.952797 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m14:25:38.126262 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:25:38.525066 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:25:38.526427 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:25:38.583235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4928dff0-731e-4f89-9a94-bec6af123903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4021dfb230>]}
[0m14:25:38.717499 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:25:38.726536 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:25:38.769144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4928dff0-731e-4f89-9a94-bec6af123903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4021b8af90>]}
[0m14:25:38.770579 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m14:25:38.771863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4928dff0-731e-4f89-9a94-bec6af123903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4021dac380>]}
[0m14:25:38.776451 [info ] [MainThread]: 
[0m14:25:38.778112 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:25:38.779535 [info ] [MainThread]: 
[0m14:25:38.781112 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:25:38.786984 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m14:25:38.846099 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m14:25:38.847632 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m14:25:38.849044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:40.594338 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.745 seconds
[0m14:25:40.598964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR, now list_MFG_ACCELERATOR_ANALYTICS_analytics)
[0m14:25:40.615407 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m14:25:40.616901 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m14:25:40.885059 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.267 seconds
[0m14:25:40.890681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4928dff0-731e-4f89-9a94-bec6af123903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4042fbcfb0>]}
[0m14:25:40.899242 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.stg_batches
[0m14:25:40.899918 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.stg_materials
[0m14:25:40.900525 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.stg_production_orders
[0m14:25:40.901972 [info ] [Thread-1 (]: 1 of 8 START sql view model ANALYTICS_analytics.stg_batches .................... [RUN]
[0m14:25:40.903678 [info ] [Thread-2 (]: 2 of 8 START sql view model ANALYTICS_analytics.stg_materials .................. [RUN]
[0m14:25:40.905540 [info ] [Thread-3 (]: 3 of 8 START sql view model ANALYTICS_analytics.stg_production_orders .......... [RUN]
[0m14:25:40.908171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now model.mfg_accelerator.stg_batches)
[0m14:25:40.910798 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_materials'
[0m14:25:40.912413 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_production_orders'
[0m14:25:40.913812 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.stg_batches
[0m14:25:40.915242 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.stg_materials
[0m14:25:40.916703 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.stg_production_orders
[0m14:25:40.993814 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.stg_batches"
[0m14:25:40.998140 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.stg_materials"
[0m14:25:41.002178 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.stg_production_orders"
[0m14:25:41.012928 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.stg_batches
[0m14:25:41.013861 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.stg_materials
[0m14:25:41.022215 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.stg_production_orders
[0m14:25:41.110885 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.stg_materials"
[0m14:25:41.129201 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.stg_batches"
[0m14:25:41.131779 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.stg_production_orders"
[0m14:25:41.143112 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.stg_materials"
[0m14:25:41.145414 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.stg_production_orders"
[0m14:25:41.146993 [debug] [Thread-2 (]: On model.mfg_accelerator.stg_materials: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
  
  
  
  
  as (
    -- stg_materials.sql
-- Purpose:
--  - Create a clean, standardized view of materials
--  - Apply basic typing and naming conventions
--  - This is the first "T" step after RAW

with source as (

    -- Pull data from the RAW.MATERIALS table registered as a source
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        status,
        created_at
    from MFG_ACCELERATOR.RAW.materials

),

renamed as (

    -- Apply any renaming / typing here
    select
        material_id                as material_id,        -- keep same, but explicitly select
        material_name              as material_name,
        material_type              as material_type,
        unit_of_measure            as unit_of_measure,
        status                     as material_status,    -- rename to avoid generic 'status'
        cast(created_at as date)   as created_at
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_materials"} */;
[0m14:25:41.148734 [debug] [Thread-3 (]: On model.mfg_accelerator.stg_production_orders: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
  
  
  
  
  as (
    -- stg_production_orders.sql
-- Purpose:
--  - Clean and standardize production order data
--  - Ensure date fields and statuses are typed and named consistently

with source as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.RAW.production_orders

),

renamed as (

    select
        order_id                               as order_id,
        batch_id                               as batch_id,
        order_type                             as order_type,
        cast(planned_start_date as date)       as planned_start_date,
        cast(planned_end_date as date)         as planned_end_date,
        cast(actual_start_date as date)        as actual_start_date,
        cast(actual_end_date as date)          as actual_end_date,
        order_status                           as order_status,
        line_id                                as line_id
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_production_orders"} */;
[0m14:25:41.150337 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.stg_batches"
[0m14:25:41.151560 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:25:41.153000 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:25:41.154469 [debug] [Thread-1 (]: On model.mfg_accelerator.stg_batches: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
  
  
  
  
  as (
    -- stg_batches.sql
-- Purpose:
--  - Clean and standardize batch data
--  - Ensure dates and numeric types are correct

with source as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.RAW.batches

),

renamed as (

    select
        batch_id                         as batch_id,
        material_id                      as material_id,
        manufacturing_site               as manufacturing_site,
        cast(manufacture_date as date)   as manufacture_date,
        cast(expiry_date as date)        as expiry_date,
        cast(quantity as number)         as quantity,
        batch_status                     as batch_status
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_batches"} */;
[0m14:25:41.637662 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.472 seconds
[0m14:25:41.671031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4928dff0-731e-4f89-9a94-bec6af123903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4045b51880>]}
[0m14:25:41.675208 [info ] [Thread-1 (]: 1 of 8 OK created sql view model ANALYTICS_analytics.stg_batches ............... [[32mSUCCESS 1[0m in 0.76s]
[0m14:25:41.696773 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.stg_batches
[0m14:25:42.465283 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.314 seconds
[0m14:25:42.469458 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4928dff0-731e-4f89-9a94-bec6af123903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4020c3df40>]}
[0m14:25:42.471136 [info ] [Thread-2 (]: 2 of 8 OK created sql view model ANALYTICS_analytics.stg_materials ............. [[32mSUCCESS 1[0m in 1.56s]
[0m14:25:42.472790 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.stg_materials
[0m14:25:42.475184 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.core_materials
[0m14:25:42.477336 [info ] [Thread-4 (]: 4 of 8 START sql table model ANALYTICS_analytics.core_materials ................ [RUN]
[0m14:25:42.479027 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.mfg_accelerator.core_materials'
[0m14:25:42.480394 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.core_materials
[0m14:25:42.484423 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.core_materials"
[0m14:25:42.497440 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.core_materials
[0m14:25:42.528782 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.core_materials"
[0m14:25:42.541847 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.core_materials"
[0m14:25:42.543755 [debug] [Thread-4 (]: On model.mfg_accelerator.core_materials: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
    
    
    
    as (-- core_materials.sql
-- Purpose:
--  - Create a cleaned, enriched material dimension
--  - Add simple derived attributes (e.g. is_active flag, age)

with base as (

    -- Use the staging view as the single source of truth for materials
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,
        created_at
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials

),

enriched as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,

        created_at,

        -- Age of the material definition in days
        datediff('day', created_at, current_date()) as material_age_days,

        -- Simple flag to say if the material is considered active
        case
            when upper(material_status) = 'ACTIVE' then 1
            else 0
        end as is_active_material
    from base

)

select * from enriched
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_materials"} */;
[0m14:25:42.545456 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:25:42.676405 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.523 seconds
[0m14:25:42.680883 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4928dff0-731e-4f89-9a94-bec6af123903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4021f15ca0>]}
[0m14:25:42.682596 [info ] [Thread-3 (]: 3 of 8 OK created sql view model ANALYTICS_analytics.stg_production_orders ..... [[32mSUCCESS 1[0m in 1.77s]
[0m14:25:42.684411 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.stg_production_orders
[0m14:25:44.632797 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.087 seconds
[0m14:25:44.637609 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4928dff0-731e-4f89-9a94-bec6af123903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4020c3f0e0>]}
[0m14:25:44.639819 [info ] [Thread-4 (]: 4 of 8 OK created sql table model ANALYTICS_analytics.core_materials ........... [[32mSUCCESS 1[0m in 2.16s]
[0m14:25:44.642656 [debug] [Thread-4 (]: Finished running node model.mfg_accelerator.core_materials
[0m14:25:44.645591 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.core_batches
[0m14:25:44.646592 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.fct_production_orders
[0m14:25:44.648197 [info ] [Thread-2 (]: 5 of 8 START sql table model ANALYTICS_analytics.core_batches .................. [RUN]
[0m14:25:44.650199 [info ] [Thread-1 (]: 6 of 8 START sql table model ANALYTICS_analytics.fct_production_orders ......... [RUN]
[0m14:25:44.652183 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_materials, now model.mfg_accelerator.core_batches)
[0m14:25:44.653869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_batches, now model.mfg_accelerator.fct_production_orders)
[0m14:25:44.655595 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.core_batches
[0m14:25:44.657485 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.fct_production_orders
[0m14:25:44.663832 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.core_batches"
[0m14:25:44.669558 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.fct_production_orders"
[0m14:25:44.680107 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.core_batches
[0m14:25:44.681609 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.fct_production_orders
[0m14:25:44.686245 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.core_batches"
[0m14:25:44.692794 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.fct_production_orders"
[0m14:25:44.704892 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.fct_production_orders"
[0m14:25:44.708196 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.core_batches"
[0m14:25:44.710369 [debug] [Thread-1 (]: On model.mfg_accelerator.fct_production_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    
    
    
    as (-- fct_production_orders.sql
-- Purpose:
--  - Fact-like table combining production orders with batch and material context
--  - Compute planned vs actual durations and simple on-time indicators

with orders as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders

),

batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        o.order_id,
        o.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        o.order_type,
        o.line_id,
        o.order_status,

        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        -- Planned duration in days
        datediff('day', planned_start_date, planned_end_date) as planned_duration_days,

        -- Actual duration in days (null if no end date)
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', actual_start_date, actual_end_date)
            else null
        end as actual_duration_days,

        -- Delay vs plan: how many days longer the actual duration was
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', planned_end_date, actual_end_date)
            else null
        end as delay_vs_plan_days,

        -- Simple late flag: 1 if order completed after planned_end_date
        case
            when actual_end_date is not null
             and actual_end_date > planned_end_date
            then 1
            else 0
        end as is_late,

        -- Is the order completed?
        case
            when upper(order_status) = 'COMPLETED' then 1
            else 0
        end as is_completed
    from orders o
    left join batches b
        on o.batch_id = b.batch_id
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.fct_production_orders"} */;
[0m14:25:44.712532 [debug] [Thread-2 (]: On model.mfg_accelerator.core_batches: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    
    
    
    as (-- core_batches.sql
-- Purpose:
--  - Combine batch info with material attributes
--  - Add shelf-life and expiry-related metrics

with batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        b.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        -- Shelf life in days = expiry - manufacture
        datediff('day', manufacture_date, expiry_date) as shelf_life_days,

        -- Batch age in days from manufacture date until today
        datediff('day', manufacture_date, current_date()) as batch_age_days,

        -- Days until expiry (can be negative if already expired)
        datediff('day', current_date(), expiry_date) as days_to_expiry,

        case
            when current_date() > expiry_date then 1
            else 0
        end as is_expired
    from batches b
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_batches"} */;
[0m14:25:45.996544 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.282 seconds
[0m14:25:46.001156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4928dff0-731e-4f89-9a94-bec6af123903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a40219a3950>]}
[0m14:25:46.003091 [info ] [Thread-1 (]: 6 of 8 OK created sql table model ANALYTICS_analytics.fct_production_orders .... [[32mSUCCESS 1[0m in 1.35s]
[0m14:25:46.005602 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.fct_production_orders
[0m14:25:46.382217 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.666 seconds
[0m14:25:46.385977 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4928dff0-731e-4f89-9a94-bec6af123903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4020c3fb60>]}
[0m14:25:46.387703 [info ] [Thread-2 (]: 5 of 8 OK created sql table model ANALYTICS_analytics.core_batches ............. [[32mSUCCESS 1[0m in 1.73s]
[0m14:25:46.389448 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.core_batches
[0m14:25:46.392148 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.mfg_ml_features_orders
[0m14:25:46.393074 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:25:46.394677 [info ] [Thread-4 (]: 7 of 8 START sql table model ANALYTICS_analytics.mfg_ml_features_orders ........ [RUN]
[0m14:25:46.396267 [info ] [Thread-3 (]: 8 of 8 START sql table model ANALYTICS_analytics.mfg_plant_daily_kpis .......... [RUN]
[0m14:25:46.397868 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.core_materials, now model.mfg_accelerator.mfg_ml_features_orders)
[0m14:25:46.399221 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_production_orders, now model.mfg_accelerator.mfg_plant_daily_kpis)
[0m14:25:46.400437 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.mfg_ml_features_orders
[0m14:25:46.401612 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:25:46.406295 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:25:46.414486 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:25:46.422339 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.mfg_ml_features_orders
[0m14:25:46.424852 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:25:46.429396 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:25:46.433607 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:25:46.446149 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:25:46.447812 [debug] [Thread-4 (]: On model.mfg_accelerator.mfg_ml_features_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
    
    
    
    as (-- mfg_ml_features_orders.sql
-- Purpose:
--  - Provide ML-ready features at order grain
--  - Target use case: predict late orders or delay vs plan
-- Grain:
--  - One row per production order (order_id)

with orders as (

    select
        order_id,
        batch_id,
        material_id,

        manufacturing_site,
        line_id,

        order_type,
        order_status,

        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,

        planned_duration_days,
        actual_duration_days,
        delay_vs_plan_days,
        is_late,
        is_completed
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders

),

materials as (

    select
        material_id,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

batches as (

    select
        batch_id,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches

),

joined as (

    select
        o.order_id,

        -- Keys and IDs
        o.batch_id,
        o.material_id,

        -- Plant / line / type
        o.manufacturing_site,
        o.line_id,
        o.order_type,
        o.order_status,

        -- Material features
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        -- Batch features
        b.quantity,
        b.batch_status,
        b.shelf_life_days,
        b.batch_age_days,
        b.days_to_expiry,
        b.is_expired,

        -- Temporal features
        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        o.planned_duration_days,
        o.actual_duration_days,
        o.delay_vs_plan_days,

        -- Labels / targets
        o.is_late,
        o.is_completed
    from orders o
    left join materials m
        on o.material_id = m.material_id
    left join batches b
        on o.batch_id = b.batch_id

),

final as (

    select
        -- Primary key
        order_id,

        -- Categorical features
        manufacturing_site,
        line_id,
        order_type,
        order_status,
        material_type,
        unit_of_measure,
        batch_status,

        -- Material state
        is_active_material,

        -- Quantitative batch features
        quantity,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired,

        -- Temporal planning features
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        planned_duration_days,
        actual_duration_days,

        -- Label / target variables
        delay_vs_plan_days,
        is_late,
        is_completed
    from joined
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_ml_features_orders"} */;
[0m14:25:46.452196 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:25:46.455843 [debug] [Thread-3 (]: On model.mfg_accelerator.mfg_plant_daily_kpis: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
    
    
    
    as (-- mfg_plant_daily_kpis.sql
-- Purpose:
--  - Provide daily plant-level KPIs for manufacturing performance monitoring
--  - Aggregates metrics from core_batches and fct_production_orders
-- Grain:
--  - One row per (manufacturing_site, calendar_date)

with calendar_days as (

    -- Build a simple date spine based on manufacture_date and planned/actual dates
    -- This ensures we have a consistent daily grain for metrics.

    select
        -- Use the earliest relevant date from batches and orders
        least(
            min(b.manufacture_date),
            min(o.planned_start_date)
        ) as min_date,
        greatest(
            max(b.manufacture_date),
            max(o.planned_end_date)
        ) as max_date
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    cross join MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o

),

date_spine as (

    -- Generate a list of dates between min_date and max_date
    -- Snowflake-specific generator using TABLE(GENERATOR)
    select
        dateadd(
            day,
            seq4(),
            min_date
        ) as calendar_date
    from calendar_days,
         table(generator(rowcount => datediff('day', min_date, max_date) + 1))

),

batches_by_day as (

    -- Aggregate batch metrics at (manufacturing_site, calendar_date)
    select
        b.manufacturing_site,
        b.manufacture_date as calendar_date,

        count(*) as total_batches,
        sum(b.quantity) as total_quantity,

        sum(case when b.is_expired = 1 then 1 else 0 end) as expired_batches
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    group by
        b.manufacturing_site,
        b.manufacture_date

),

orders_by_day as (

    -- Aggregate order metrics at (manufacturing_site, calendar_date)
    -- We'll use planned_start_date as the main "date" for the order
    select
        b.manufacturing_site,
        o.planned_start_date as calendar_date,

        count(*) as total_orders,
        sum(case when o.is_completed = 1 then 1 else 0 end) as completed_orders,
        sum(case when o.is_late = 1 then 1 else 0 end) as late_orders,

        avg(o.delay_vs_plan_days) as avg_delay_vs_plan_days
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o
    left join MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
        on o.batch_id = b.batch_id
    group by
        b.manufacturing_site,
        o.planned_start_date

),

combined as (

    -- Combine batch and order metrics on (site, date)
    select
        coalesce(b.manufacturing_site, o.manufacturing_site) as manufacturing_site,
        coalesce(b.calendar_date, o.calendar_date) as calendar_date,

        -- Batch metrics
        coalesce(b.total_batches, 0) as total_batches,
        coalesce(b.total_quantity, 0) as total_quantity,
        coalesce(b.expired_batches, 0) as expired_batches,

        -- Order metrics
        coalesce(o.total_orders, 0) as total_orders,
        coalesce(o.completed_orders, 0) as completed_orders,
        coalesce(o.late_orders, 0) as late_orders,
        o.avg_delay_vs_plan_days as avg_delay_vs_plan_days
    from batches_by_day b
    full outer join orders_by_day o
        on  b.manufacturing_site = o.manufacturing_site
        and b.calendar_date = o.calendar_date

),

final as (

    select
        manufacturing_site,
        calendar_date,

        total_batches,
        total_quantity,
        expired_batches,

        total_orders,
        completed_orders,
        late_orders,
        avg_delay_vs_plan_days,

        -- On-time rate: percentage of completed orders that were not late
        case
            when completed_orders > 0 then
                1.0 - (late_orders::float / completed_orders::float)
            else null
        end as on_time_rate
    from combined
    where manufacturing_site is not null
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_plant_daily_kpis"} */;
[0m14:25:47.653754 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.200 seconds
[0m14:25:47.658835 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4928dff0-731e-4f89-9a94-bec6af123903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a40219a3f20>]}
[0m14:25:47.661121 [info ] [Thread-4 (]: 7 of 8 OK created sql table model ANALYTICS_analytics.mfg_ml_features_orders ... [[32mSUCCESS 1[0m in 1.26s]
[0m14:25:47.662915 [debug] [Thread-4 (]: Finished running node model.mfg_accelerator.mfg_ml_features_orders
[0m14:25:47.715578 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.257 seconds
[0m14:25:47.719481 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4928dff0-731e-4f89-9a94-bec6af123903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a40220ae930>]}
[0m14:25:47.721318 [info ] [Thread-3 (]: 8 of 8 OK created sql table model ANALYTICS_analytics.mfg_plant_daily_kpis ..... [[32mSUCCESS 1[0m in 1.32s]
[0m14:25:47.723207 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:25:47.727665 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:47.729362 [debug] [MainThread]: Connection 'model.mfg_accelerator.fct_production_orders' was left open.
[0m14:25:47.730732 [debug] [MainThread]: On model.mfg_accelerator.fct_production_orders: Close
[0m14:25:48.153986 [debug] [MainThread]: Connection 'model.mfg_accelerator.core_batches' was left open.
[0m14:25:48.155798 [debug] [MainThread]: On model.mfg_accelerator.core_batches: Close
[0m14:25:48.565778 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_plant_daily_kpis' was left open.
[0m14:25:48.567660 [debug] [MainThread]: On model.mfg_accelerator.mfg_plant_daily_kpis: Close
[0m14:25:49.011371 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_ml_features_orders' was left open.
[0m14:25:49.012842 [debug] [MainThread]: On model.mfg_accelerator.mfg_ml_features_orders: Close
[0m14:25:49.460587 [info ] [MainThread]: 
[0m14:25:49.462408 [info ] [MainThread]: Finished running 5 table models, 3 view models in 0 hours 0 minutes and 10.68 seconds (10.68s).
[0m14:25:49.465597 [debug] [MainThread]: Command end result
[0m14:25:49.531197 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:25:49.538241 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:25:49.553776 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m14:25:49.555055 [info ] [MainThread]: 
[0m14:25:49.556443 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:25:49.558705 [info ] [MainThread]: 
[0m14:25:49.560765 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m14:25:49.563106 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.771294, "process_in_blocks": "0", "process_kernel_time": 1.375372, "process_mem_max_rss": "222432", "process_out_blocks": "2288", "process_user_time": 4.815796}
[0m14:25:49.564493 [debug] [MainThread]: Command `dbt run` succeeded at 14:25:49.564361 after 12.77 seconds
[0m14:25:49.565754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4043198920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4028acf620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4021b5dee0>]}
[0m14:25:49.566961 [debug] [MainThread]: Flushing usage events
[0m14:25:50.356594 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:25:54.331382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515d785c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515d952b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515d6a3cbf0>]}


============================== 14:25:54.339937 | 4509f6c0-1cb7-4908-8813-ca9a5a150518 ==============================
[0m14:25:54.339937 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:25:54.341980 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'introspect': 'True', 'static_parser': 'True', 'version_check': 'True', 'write_json': 'True', 'no_print': 'None', 'target_path': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt_profiles', 'log_format': 'default', 'empty': 'None', 'use_colors': 'True', 'quiet': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'cache_selected_only': 'False'}
[0m14:25:55.119554 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:25:55.121285 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:25:55.122729 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:25:55.352005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4509f6c0-1cb7-4908-8813-ca9a5a150518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515d778a000>]}
[0m14:25:55.430461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4509f6c0-1cb7-4908-8813-ca9a5a150518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515d6d41d00>]}
[0m14:25:55.432392 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m14:25:55.607070 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:25:55.905378 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:25:55.907018 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:25:55.971816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4509f6c0-1cb7-4908-8813-ca9a5a150518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515b54fd4c0>]}
[0m14:25:56.107228 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:25:56.115952 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:25:56.161879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4509f6c0-1cb7-4908-8813-ca9a5a150518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515b5168620>]}
[0m14:25:56.163445 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m14:25:56.164697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4509f6c0-1cb7-4908-8813-ca9a5a150518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515b56c1880>]}
[0m14:25:56.168708 [info ] [MainThread]: 
[0m14:25:56.170034 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:25:56.171432 [info ] [MainThread]: 
[0m14:25:56.173085 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:25:56.181121 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m14:25:56.245758 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m14:25:56.247286 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m14:25:56.248626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:57.799909 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.551 seconds
[0m14:25:57.805165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4509f6c0-1cb7-4908-8813-ca9a5a150518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515b54ff020>]}
[0m14:25:57.814098 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m14:25:57.814748 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m14:25:57.815306 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m14:25:57.815934 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m14:25:57.816997 [info ] [Thread-1 (]: 1 of 24 START test not_null_core_batches_batch_id .............................. [RUN]
[0m14:25:57.818711 [info ] [Thread-2 (]: 2 of 24 START test not_null_core_batches_material_id ........................... [RUN]
[0m14:25:57.820357 [info ] [Thread-3 (]: 3 of 24 START test not_null_core_materials_material_id ......................... [RUN]
[0m14:25:57.821991 [info ] [Thread-4 (]: 4 of 24 START test not_null_fct_production_orders_batch_id ..................... [RUN]
[0m14:25:57.823707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c)
[0m14:25:57.826045 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e'
[0m14:25:57.828640 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8'
[0m14:25:57.830228 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1'
[0m14:25:57.831640 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m14:25:57.833130 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m14:25:57.834413 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m14:25:57.835834 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m14:25:57.856156 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m14:25:57.862971 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m14:25:57.868067 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m14:25:57.873068 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m14:25:57.883833 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m14:25:57.885538 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m14:25:57.892202 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m14:25:57.901396 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m14:25:57.922598 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m14:25:57.924827 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m14:25:57.929899 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m14:25:57.933902 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m14:25:57.946927 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m14:25:57.948377 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m14:25:57.949467 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m14:25:57.950960 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"} */
[0m14:25:57.952814 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"} */
[0m14:25:57.953865 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m14:25:57.955441 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"} */
[0m14:25:57.957275 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:25:57.959224 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:25:57.961302 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"} */
[0m14:25:57.979904 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:25:58.256645 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.296 seconds
[0m14:25:58.268356 [info ] [Thread-1 (]: 1 of 24 PASS not_null_core_batches_batch_id .................................... [[32mPASS[0m in 0.44s]
[0m14:25:58.270365 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m14:25:58.271944 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m14:25:58.273918 [info ] [Thread-1 (]: 5 of 24 START test not_null_fct_production_orders_order_id ..................... [RUN]
[0m14:25:58.276557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c, now test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f)
[0m14:25:58.278354 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m14:25:58.283492 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m14:25:58.298439 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m14:25:58.302505 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m14:25:58.315709 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m14:25:58.317102 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"} */
[0m14:25:58.605248 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.287 seconds
[0m14:25:58.610143 [info ] [Thread-1 (]: 5 of 24 PASS not_null_fct_production_orders_order_id ........................... [[32mPASS[0m in 0.33s]
[0m14:25:58.612146 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m14:25:58.613750 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:25:58.615082 [info ] [Thread-1 (]: 6 of 24 START test not_null_mfg_ml_features_orders_order_id .................... [RUN]
[0m14:25:58.616454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f, now test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213)
[0m14:25:58.617732 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:25:58.624148 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m14:25:58.637894 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:25:58.643391 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m14:25:58.655677 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m14:25:58.657531 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"} */
[0m14:25:59.046002 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.387 seconds
[0m14:25:59.050126 [info ] [Thread-1 (]: 6 of 24 PASS not_null_mfg_ml_features_orders_order_id .......................... [[32mPASS[0m in 0.43s]
[0m14:25:59.051952 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:25:59.053399 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:25:59.054716 [info ] [Thread-1 (]: 7 of 24 START test not_null_mfg_plant_daily_kpis_calendar_date ................. [RUN]
[0m14:25:59.056741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8)
[0m14:25:59.058984 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:25:59.068137 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m14:25:59.083487 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:25:59.091525 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m14:25:59.103973 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m14:25:59.105358 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select calendar_date
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where calendar_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"} */
[0m14:25:59.359865 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.382 seconds
[0m14:25:59.364149 [info ] [Thread-2 (]: 2 of 24 PASS not_null_core_batches_material_id ................................. [[32mPASS[0m in 1.54s]
[0m14:25:59.365896 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m14:25:59.367346 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:25:59.368739 [info ] [Thread-2 (]: 8 of 24 START test not_null_mfg_plant_daily_kpis_manufacturing_site ............ [RUN]
[0m14:25:59.370261 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68)
[0m14:25:59.371595 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:25:59.378298 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m14:25:59.392290 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:25:59.396535 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m14:25:59.411542 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m14:25:59.413034 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturing_site
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where manufacturing_site is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"} */
[0m14:25:59.460454 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.353 seconds
[0m14:25:59.464156 [info ] [Thread-1 (]: 7 of 24 PASS not_null_mfg_plant_daily_kpis_calendar_date ....................... [[32mPASS[0m in 0.41s]
[0m14:25:59.465986 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:25:59.467867 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m14:25:59.469615 [info ] [Thread-1 (]: 9 of 24 START test not_null_stg_batches_batch_id ............................... [RUN]
[0m14:25:59.471271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8, now test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0)
[0m14:25:59.472831 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m14:25:59.474871 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.519 seconds
[0m14:25:59.481240 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m14:25:59.484484 [info ] [Thread-3 (]: 3 of 24 PASS not_null_core_materials_material_id ............................... [[32mPASS[0m in 1.66s]
[0m14:25:59.487560 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m14:25:59.489297 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m14:25:59.491721 [info ] [Thread-3 (]: 10 of 24 START test not_null_stg_batches_material_id ........................... [RUN]
[0m14:25:59.494410 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8, now test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c)
[0m14:25:59.495914 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m14:25:59.501885 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m14:25:59.503810 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m14:25:59.509580 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m14:25:59.512645 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.555 seconds
[0m14:25:59.513904 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m14:25:59.518568 [info ] [Thread-4 (]: 4 of 24 PASS not_null_fct_production_orders_batch_id ........................... [[32mPASS[0m in 1.69s]
[0m14:25:59.524562 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m14:25:59.527587 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m14:25:59.529853 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m14:25:59.531397 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m14:25:59.532872 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"} */
[0m14:25:59.534198 [info ] [Thread-4 (]: 11 of 24 START test not_null_stg_materials_material_id ......................... [RUN]
[0m14:25:59.538316 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1, now test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89)
[0m14:25:59.541065 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m14:25:59.543449 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m14:25:59.549148 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m14:25:59.550788 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"} */
[0m14:25:59.567230 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m14:25:59.571274 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m14:25:59.583105 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m14:25:59.584293 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"} */
[0m14:25:59.793323 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.379 seconds
[0m14:25:59.797000 [info ] [Thread-2 (]: 8 of 24 PASS not_null_mfg_plant_daily_kpis_manufacturing_site .................. [[32mPASS[0m in 0.43s]
[0m14:25:59.799068 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:25:59.800620 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m14:25:59.802194 [info ] [Thread-2 (]: 12 of 24 START test not_null_stg_production_orders_batch_id .................... [RUN]
[0m14:25:59.803869 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68, now test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5)
[0m14:25:59.805406 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m14:25:59.812345 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m14:25:59.827575 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m14:25:59.832977 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m14:25:59.848481 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m14:25:59.850207 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"} */
[0m14:25:59.866747 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.331 seconds
[0m14:25:59.871476 [info ] [Thread-1 (]: 9 of 24 PASS not_null_stg_batches_batch_id ..................................... [[32mPASS[0m in 0.40s]
[0m14:25:59.874800 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.321 seconds
[0m14:25:59.876650 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m14:25:59.880819 [info ] [Thread-3 (]: 10 of 24 PASS not_null_stg_batches_material_id ................................. [[32mPASS[0m in 0.39s]
[0m14:25:59.883009 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m14:25:59.885208 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m14:25:59.887029 [info ] [Thread-1 (]: 13 of 24 START test not_null_stg_production_orders_order_id .................... [RUN]
[0m14:25:59.889091 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m14:25:59.891565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0, now test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284)
[0m14:25:59.893959 [info ] [Thread-3 (]: 14 of 24 START test relationships_core_batches_material_id__material_id__ref_core_materials_  [RUN]
[0m14:25:59.896005 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m14:25:59.897880 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c, now test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6)
[0m14:25:59.905028 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m14:25:59.906964 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m14:25:59.923645 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m14:25:59.930365 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m14:25:59.935602 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m14:25:59.940416 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m14:25:59.948198 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m14:25:59.959014 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m14:25:59.961467 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"} */
[0m14:25:59.965035 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m14:25:59.967667 [debug] [Thread-3 (]: On test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"} */
[0m14:26:00.029106 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.443 seconds
[0m14:26:00.032589 [info ] [Thread-4 (]: 11 of 24 PASS not_null_stg_materials_material_id ............................... [[32mPASS[0m in 0.49s]
[0m14:26:00.034485 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m14:26:00.035999 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m14:26:00.037386 [info ] [Thread-4 (]: 15 of 24 START test relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [RUN]
[0m14:26:00.038812 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89, now test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d)
[0m14:26:00.040429 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m14:26:00.048416 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m14:26:00.063184 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m14:26:00.067011 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m14:26:00.080717 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m14:26:00.082110 [debug] [Thread-4 (]: On test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"} */
[0m14:26:00.204360 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.353 seconds
[0m14:26:00.210135 [info ] [Thread-2 (]: 12 of 24 PASS not_null_stg_production_orders_batch_id .......................... [[32mPASS[0m in 0.41s]
[0m14:26:00.212715 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m14:26:00.214878 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m14:26:00.216786 [info ] [Thread-2 (]: 16 of 24 START test relationships_stg_batches_material_id__material_id__ref_stg_materials_  [RUN]
[0m14:26:00.218853 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5, now test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2)
[0m14:26:00.220752 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m14:26:00.232760 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m14:26:00.236473 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.273 seconds
[0m14:26:00.242312 [info ] [Thread-1 (]: 13 of 24 PASS not_null_stg_production_orders_order_id .......................... [[32mPASS[0m in 0.35s]
[0m14:26:00.245469 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m14:26:00.247987 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m14:26:00.249933 [info ] [Thread-1 (]: 17 of 24 START test relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [RUN]
[0m14:26:00.252493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284, now test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519)
[0m14:26:00.254476 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m14:26:00.255307 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m14:26:00.261759 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m14:26:00.271678 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m14:26:00.288647 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m14:26:00.290138 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m14:26:00.292761 [debug] [Thread-2 (]: On test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"} */
[0m14:26:00.297876 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m14:26:00.316416 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m14:26:00.317877 [debug] [Thread-1 (]: On test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"} */
[0m14:26:00.394391 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.311 seconds
[0m14:26:00.398048 [info ] [Thread-4 (]: 15 of 24 PASS relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [[32mPASS[0m in 0.36s]
[0m14:26:00.399960 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m14:26:00.401428 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m14:26:00.402831 [info ] [Thread-4 (]: 18 of 24 START test unique_core_batches_batch_id ............................... [RUN]
[0m14:26:00.404340 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d, now test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf)
[0m14:26:00.405837 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m14:26:00.415286 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m14:26:00.429823 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m14:26:00.433807 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m14:26:00.447622 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m14:26:00.448835 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"} */
[0m14:26:00.578010 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.608 seconds
[0m14:26:00.581529 [info ] [Thread-3 (]: 14 of 24 PASS relationships_core_batches_material_id__material_id__ref_core_materials_  [[32mPASS[0m in 0.68s]
[0m14:26:00.583264 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m14:26:00.584769 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m14:26:00.586163 [info ] [Thread-3 (]: 19 of 24 START test unique_core_materials_material_id .......................... [RUN]
[0m14:26:00.587619 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6, now test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2)
[0m14:26:00.589138 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m14:26:00.596638 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m14:26:00.612308 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m14:26:00.616435 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m14:26:00.628308 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m14:26:00.629597 [debug] [Thread-3 (]: On test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"} */
[0m14:26:00.677738 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.359 seconds
[0m14:26:00.681395 [info ] [Thread-1 (]: 17 of 24 PASS relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [[32mPASS[0m in 0.43s]
[0m14:26:00.683225 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m14:26:00.684744 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m14:26:00.686321 [info ] [Thread-1 (]: 20 of 24 START test unique_fct_production_orders_order_id ...................... [RUN]
[0m14:26:00.687942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519, now test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442)
[0m14:26:00.689477 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m14:26:00.698711 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m14:26:00.715166 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m14:26:00.720204 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m14:26:00.736257 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m14:26:00.737890 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"} */
[0m14:26:00.749756 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.450 seconds
[0m14:26:00.753973 [info ] [Thread-2 (]: 16 of 24 PASS relationships_stg_batches_material_id__material_id__ref_stg_materials_  [[32mPASS[0m in 0.54s]
[0m14:26:00.756279 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m14:26:00.758568 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:26:00.760839 [info ] [Thread-2 (]: 21 of 24 START test unique_mfg_ml_features_orders_order_id ..................... [RUN]
[0m14:26:00.762751 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2, now test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd)
[0m14:26:00.764582 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:26:00.772058 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m14:26:00.789069 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:26:00.796165 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m14:26:00.814923 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m14:26:00.816680 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"} */
[0m14:26:00.822564 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.372 seconds
[0m14:26:00.830916 [info ] [Thread-4 (]: 18 of 24 PASS unique_core_batches_batch_id ..................................... [[32mPASS[0m in 0.43s]
[0m14:26:00.833593 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m14:26:00.835692 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m14:26:00.837566 [info ] [Thread-4 (]: 22 of 24 START test unique_stg_batches_batch_id ................................ [RUN]
[0m14:26:00.840595 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf, now test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4)
[0m14:26:00.843638 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m14:26:00.851840 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m14:26:00.869965 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m14:26:00.876833 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m14:26:00.891493 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m14:26:00.893438 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"} */
[0m14:26:00.956323 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.325 seconds
[0m14:26:00.960919 [info ] [Thread-3 (]: 19 of 24 PASS unique_core_materials_material_id ................................ [[32mPASS[0m in 0.37s]
[0m14:26:00.962926 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m14:26:00.964548 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m14:26:00.966113 [info ] [Thread-3 (]: 23 of 24 START test unique_stg_materials_material_id ........................... [RUN]
[0m14:26:00.967785 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2, now test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21)
[0m14:26:00.969235 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m14:26:00.975285 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m14:26:00.985966 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m14:26:00.990515 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m14:26:01.003836 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m14:26:01.005270 [debug] [Thread-3 (]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"} */
[0m14:26:01.081907 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.343 seconds
[0m14:26:01.085339 [info ] [Thread-1 (]: 20 of 24 PASS unique_fct_production_orders_order_id ............................ [[32mPASS[0m in 0.40s]
[0m14:26:01.087220 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m14:26:01.088808 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m14:26:01.090503 [info ] [Thread-1 (]: 24 of 24 START test unique_stg_production_orders_order_id ...................... [RUN]
[0m14:26:01.092659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442, now test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3)
[0m14:26:01.094276 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m14:26:01.099625 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m14:26:01.113002 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m14:26:01.116925 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m14:26:01.130438 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m14:26:01.131715 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"} */
[0m14:26:01.188673 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.294 seconds
[0m14:26:01.193160 [info ] [Thread-4 (]: 22 of 24 PASS unique_stg_batches_batch_id ...................................... [[32mPASS[0m in 0.35s]
[0m14:26:01.195413 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m14:26:01.216906 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.398 seconds
[0m14:26:01.220316 [info ] [Thread-2 (]: 21 of 24 PASS unique_mfg_ml_features_orders_order_id ........................... [[32mPASS[0m in 0.46s]
[0m14:26:01.222008 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:26:01.327012 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.320 seconds
[0m14:26:01.330423 [info ] [Thread-3 (]: 23 of 24 PASS unique_stg_materials_material_id ................................. [[32mPASS[0m in 0.36s]
[0m14:26:01.332259 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m14:26:01.560696 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.428 seconds
[0m14:26:01.566518 [info ] [Thread-1 (]: 24 of 24 PASS unique_stg_production_orders_order_id ............................ [[32mPASS[0m in 0.47s]
[0m14:26:01.569476 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m14:26:01.575402 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:26:01.577767 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3' was left open.
[0m14:26:01.580198 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: Close
[0m14:26:02.011950 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd' was left open.
[0m14:26:02.013532 [debug] [MainThread]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: Close
[0m14:26:02.425735 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21' was left open.
[0m14:26:02.427829 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: Close
[0m14:26:02.860821 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4' was left open.
[0m14:26:02.862605 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: Close
[0m14:26:03.262698 [info ] [MainThread]: 
[0m14:26:03.264527 [info ] [MainThread]: Finished running 24 data tests in 0 hours 0 minutes and 7.09 seconds (7.09s).
[0m14:26:03.270231 [debug] [MainThread]: Command end result
[0m14:26:03.338685 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:26:03.347216 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:26:03.363859 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m14:26:03.365627 [info ] [MainThread]: 
[0m14:26:03.367314 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:26:03.369052 [info ] [MainThread]: 
[0m14:26:03.370665 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=24
[0m14:26:03.373565 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 9.133798, "process_in_blocks": "0", "process_kernel_time": 1.357753, "process_mem_max_rss": "224404", "process_out_blocks": "16", "process_user_time": 5.13151}
[0m14:26:03.379150 [debug] [MainThread]: Command `dbt test` succeeded at 14:26:03.378876 after 9.14 seconds
[0m14:26:03.381018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515d7c6c080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515d7c6c9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515d6872ae0>]}
[0m14:26:03.382682 [debug] [MainThread]: Flushing usage events
[0m14:26:04.138871 [debug] [MainThread]: An error was encountered while trying to flush usage events
